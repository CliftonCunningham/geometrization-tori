% !TEX encoding = UTF-8 Unicode
\documentclass{amsart}
\pdfoutput=1

%%%%%%%%%%%%%%%%%% HEADING %%%%%%%%%%%%%%%%%%

\title[The function--sheaf dictionary]{The function--sheaf dictionary for smooth commutative group schemes over finite fields}

\date{\today}
\author{Clifton Cunningham}
\email{cunning@math.ucalgary.ca}
\address{University of Calgary}
\author{David Roe}
\email{roed.math@gmail.com}
\address{Pacific Institute for the Mathematical Sciences, University of Calgary}
\subjclass[2010]{14F05 (primary), 14L15 (secondary)}
\keywords{function--sheaf dictionary, geometrization, quasicharacters, quasicharacter sheaves, smooth commutative group schemes}

%%%%%%%%%%%%%%%%% PACKAGES %%%%%%%%%%%%%%%%%
% Encodings
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
% AMS packages
\usepackage{amsmath, amsthm, amssymb, todonotes}%, showkeys}
\usepackage[alphabetic]{amsrefs}
% Fonts
\usepackage{mathrsfs, yfonts}
%Geometry
\usepackage{geometry}
% Enumitem
%\usepackage{enumitem}
% TikZ
\usepackage{tikz}
\usetikzlibrary{shapes,arrows,calc,matrix}
\usepackage{tikz-cd}
% Hyperrefs
\usepackage{hyperref}

%%%%%%%%%%%%%%% THEOREM STYLES %%%%%%%%%%%%%%%
\theoremstyle{plain}
      \newtheorem{theorem}{Theorem}[section]
      \newtheorem{proposition}[theorem]{Proposition}
      \newtheorem{lemma}[theorem]{Lemma}
      \newtheorem{corollary}[theorem]{Corollary}

      \theoremstyle{definition}
      \newtheorem{definition}[theorem]{Definition}

      \theoremstyle{remark}
      \newtheorem{remark}[theorem]{Remark}

%%%%%%%%%%%%%%%% TIKZ SETTINGS %%%%%%%%%%%%%%%%
\tikzset{every picture/.style={>=stealth},label/.style={font=\footnotesize}}

%%%%%%%%%%%%%%% RINGS AND GROUPS %%%%%%%%%%%%%%%
\newcommand{\FF}{{\mathbb{F}}}
\newcommand{\ZZ}{{\mathbb{Z}}}
\newcommand{\NN}{{\mathbb{N}}}
\newcommand{\CC}{{\mathbb{C}}}
\newcommand{\QQ}{{\mathbb{Q}}}
\newcommand{\RR}{{\mathbb{R}}}
\newcommand{\EE}{\mathbb{\bar Q}_\ell}
\newcommand{\Zl}{\mathbb{\bar Z}_\ell}
\newcommand{\OK}{\mathcal{O}_K}
\newcommand{\pK}{\mathfrak{p}_K}
\newcommand{\OKp}{\mathcal{O}_{K'}}
\newcommand{\pKp}{\mathfrak{p}_{K'}}
\newcommand{\OL}{\mathcal{O}_L}
\newcommand{\OO}[1]{\mathcal{O}_{#1}}
\newcommand{\Zp}{\mathbb{Z}_p}
\newcommand{\Qp}{\mathbb{Q}_p}
\newcommand{\bFq}{\bar{k}}
\newcommand{\Fq}{k}
\newcommand{\Fqm}{k_m}
\newcommand{\WW}{\mathbb{W}}
\newcommand{\EEx}{\EE^\times}
\newcommand{\Zlx}{\mathbb{\bar Z}_\ell^\times}
\newcommand{\Weil}[1]{\mathcal{W}_{#1}}

%%%%%%%%%%%%%%% ALGEBRAIC GROUPS %%%%%%%%%%%%%%%
\newcommand{\mathswab}[1]{\operatorname{\textswab{#1}}}
\newcommand{\Gm}[1]{\mathbb{G}_{\hskip-1pt\textbf{m},#1}}
\newcommand{\GN}[1]{\mathswab{#1}}
\newcommand{\bGN}[1]{{\bar{\mathswab{#1}}}}
\newcommand{\TT}{\underline{T}}
\newcommand{\TL}{\underline{T_L}}
\newcommand{\TTp}{\underline{T}'}

%%%%%%%%%%%%%%% NAMED OPERATORS %%%%%%%%%%%%%%%
\DeclareMathOperator{\Gal}{Gal}
\DeclareMathOperator{\W}{W}
\newcommand{\Frob}[1]{\operatorname{F}_{#1}}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\ord}{ord}
\DeclareMathOperator{\coker}{coker}
\DeclareMathOperator{\Gr}{Gr}
\DeclareMathOperator{\Irrep}{Irrep}
\DeclareMathOperator{\Pic}{Pic}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\Ext}{Ext}
\DeclareMathOperator{\Hh}{H}
\DeclareMathOperator{\Res}{Res}
\DeclareMathOperator{\Nm}{Nm}
\DeclareMathOperator{\trace}{Tr}
\DeclareMathOperator{\obj}{obj}
\DeclareMathOperator{\mor}{mor}
\DeclareMathOperator{\Lang}{Lang}
\DeclareMathOperator{\image}{im}
\DeclareMathOperator{\Loc}{Loc}
\DeclareMathOperator{\Tot}{Tot}
\newcommand{\gal}[1]{{\operatorname{Gal}\hskip-1pt\left( {\bar #1}/#1 \right)}}
\newcommand{\Spec}[1]{{\operatorname{Spec}\hskip-1pt( #1 )}}

%%%%%%%%%%%% MISCELLANEOUS OPERATORS %%%%%%%%%%%%
\newcommand{\sheafHom}{{\mathscr{H}\hskip-4pt{\it o}\hskip-2pt{\it m}}}
\newcommand{\abs}[1]{{\vert #1 \vert}}
\newcommand{\ceq}{{\, :=\, }}
\newcommand{\tq}{{\ \vert\ }}
\newcommand{\iso}{{\ \cong\ }}
%% Limits
\newcommand{\invlim}[1]{\lim\limits_{\overleftarrow{#1}}}
\newcommand{\dirlim}[1]{\lim\limits_{\overrightarrow{#1}}}
\newcommand{\limit}[1]{\mathop{\textsc{lim}}\limits_{#1}}
\newcommand{\colimit}[1]{\mathop{\textsc{colim}}\limits_{#1}}
%% Fonts for quasicharacter sheaves
\newcommand{\qcs}[1]{{\mathcal{#1}}}
\newcommand{\gqcs}[1]{{\mathcal{\bar #1}}}
\newcommand{\dualgcs}[1]{\gqcs{#1}^\dagger}
\newcommand{\dualcs}[1]{\qcs{#1}^\dagger}
%% Categories
\newcommand{\QC}{{\mathcal{Q\hskip-0.8pt C}}}
\newcommand{\lQC}{{\QC_\text{flb}}}
\newcommand{\lQCiso}[1]{\lQC(#1)_{/\text{iso}}}
\newcommand{\bQC}{{\QC_0}}
\newcommand{\fQC}{{\QC_\text{fin}}}
\newcommand{\QCiso}[1]{\QC(#1)_{/\text{iso}}}
\newcommand{\bQCiso}[1]{\bQC(#1)_{/\text{iso}}}
\newcommand{\fQCiso}[1]{\fQC(#1)_{/\text{iso}}}
\newcommand{\trFrob}[1]{t_{#1}}
\newcommand{\TrFrob}[1]{T_{#1}}
%% amsmath replacements for \atop
\newcommand{\latop}[2]{\genfrac{}{}{0pt}{0}{#1}{#2}}
\newcommand{\partop}[2]{\genfrac{(}{)}{0pt}{0}{#1}{#2}}
%% Labeled items
\makeatletter
\newcommand{\labitem}[2]{
\def\@itemlabel{\textbf{#1}}
\item
\def\@currentlabel{#1}\label{#2}}
\makeatother
%% Shorthand for bars
\renewcommand{\bf}{\bar{f}}
\newcommand{\bg}{\bar{g}}
\newcommand{\bm}{\bar{m}}
\newcommand{\bG}{\bar{G}}
\newcommand{\bH}{\bar{H}}
%% Spacing control
\newcommand{\tight}[3]{\hspace{-#1pt}{#2}\hspace{-#3pt}}
\newcommand{\GxG}{\text{$G \tight{1}{\times}{1} G$}}
\newcommand{\bGxG}{\text{$\bar{G} \tight{1}{\times}{1} \bar{G}$}}
\newcommand{\bfxf}{\text{$\bar{f} \tight{1}{\times}{1} \bar{f}$}}
\newcommand{\GxxG}{\text{$G \tight{1}{\times}{1} G$}}
\newcommand{\LxL}{\text{$\gqcs{L} \tight{0}{\boxtimes}{0} \gqcs{L}$}}
\newcommand{\ExE}{\text{$\qcs{E}\tight{0}{\boxtimes}{0}\qcs{E}$}}
\newcommand{\bExE}{\text{$\gqcs{E}\tight{0}{\boxtimes}{0}\gqcs{E}$}}
\newcommand{\AxA}{\text{$A \tight{1}{\times}{1} A$}}
\newcommand{\BxB}{\text{$B \tight{1}{\times}{1} B$}}
\newcommand{\GzxGz}{\text{$G^0 \tight{1}{\times}{1} G^0$}}
%% Margin notes
\newcommand\Clifton[1]{\marginpar{\smaller\smaller CC: #1}}
\newcommand\David[1]{\marginpar{\smaller\smaller DR: #1}}
%% Hyphenation override
\hyphenation{quasi-character}


\newcommand{\lTrFrob}[1]{\TrFrob{#1}^2}


%%%%%%%%%%%% BEGIN DOCUMENT %%%%%%%%%%%%
\begin{document}

\begin{abstract}
  We extend Deligne's function--sheaf dictionary from
  connected commutative algebraic groups over finite fields to smooth
  commutative group schemes over finite fields,
  in which case some interesting new features of the dictionary arise.
   \end{abstract}

\maketitle

\section*{Introduction}


%\subsection*{Overview}

%Deligne's function--sheaf dictionary translates characters of connected, commutative algebraic groups $G$ over finite fields $\Fq$ into certain local systems on G, from which the character of $G(\Fq)$ can be recovered using the action of Frobenius on $G$.
%The local systems which appear in this dictionary are easily characterised and often referred to as \emph{character sheaves} on $G$.
%The result is a perfect dictionary between characters of $G(\Fq)$ and character sheaves on G, with which the formidable artillery of algebraic geometry can be brought to bear on the study of characters of $G(\Fq)$.
%
%In this paper we show how this dictionary extends to the case when $G$ is not connected, and even to all smooth commutative group schemes over $\Fq$, in which case some interesting new features of the dictionary arise.


%\subsection{The main result}

Let us briefly review how Deligne's function--sheaf dictionary for connected commutative algebraic groups over finite fields \cite{deligne:SGA4.5}*{sommes trig.} translates characters into local systems.
Let $\Fq$ be a finite field and let $G$ be a connected commutative algebraic group over $\Fq$; fix an algebraic closure $\bFq$ of $\Fq$
and let $\bG$ be the base change of $G$ to $\bFq$.
Fix a prime $\ell$ invertible in $\Fq$ and let $\chi : G(\Fq) \to \EEx$ be any character.
Using little more than the Lang map for $G$, $\chi$ determines an $\ell$-adic local system $\qcs{L}$ on $G$ from which the character $\chi$ can be recovered using the Frobenius automorphism of $\bG$.
While this recovery process applies to all $\ell$-adic local systems $\qcs{L}$ on $G$, those that produce characters of $G(\Fq)$ are distinguished by a simple property: there \emph{exists} an isomorphism
\begin{equation}\label{introbox}
m^* \qcs{L} \iso \qcs{L} \boxtimes \qcs{L}
\end{equation}
 of $\ell$-adic local systems on $G$, where $m : G\times G \to G$ is the multiplication map for $G$. The function--sheaf dictionary for $G$ identifies a monoidal category of $\ell$-adic local systems on $G$ such that the group of isomorphism classes in this category is canonically identified with the $\ell$-adic character group of $G(\Fq)$, thus providing the geometrization and categorification of characters of $G(\Fq)$.
%
Although hidden in this discussion, the connectedness of $G$ played a crucial role in the geometrization and categorification of characters of $G(\Fq)$.
In particular, when the isomorphism \eqref{introbox} exists for $\qcs{L}$, it is essentially unique.

Now let $G$ be any smooth commutative group scheme over $\Fq$.
Two new features must be addressed in order to geometrize characters of $G(\Fq)$.
First, we must pass from $\ell$-adic local systems on $G$ to Weil local systems on $G$
and, second, we must keep track of the isomorphisms \eqref{introbox}.
Both issues are addressed in the main definition of this paper:
A \emph{quasicharacter sheaf} on $G$ is a triple $\qcs{L}\ceq
(\gqcs{L},\mu,\phi)$ where $\gqcs{L}$ is an $\ell$-adic local system on $\bG$ of rank~one and $\mu: m^*
\gqcs{L} \to \LxL$ and $\phi : \Frob{G}^*\gqcs{L} \to \gqcs{L}$ are isomorphisms satisfying natural compatibility conditions; here $\Frob{G}$ is the Frobenius automorphism of ${\bar G}$.
 In the main result of this paper, Theorem~\ref{thm:snake},
we form a rigid monoidal category $\lQC(G)$ of quasicharacter sheaves on $G$
and show that the Trace of Frobenius provides a functorial group isomorphism
\begin{equation}
\lQCiso{G} \to \Hom(G(\Fq), \EEx).
\end{equation}
\todo{change to remove flabbyness}

%\subsection*{Illustrative Examples}

%Three examples will illustrate some of the issues that arise when extending the function--sheaf dictionary to smooth commutative group schemes over $\Fq$.
As we show in the paper, $\ell$-adic local systems on $G$ can only be used to geometrize characters of finite order; quasicharacter sheaves, however, provide the geometrization of all characters of $G(\Fq)$.
For example, we will see how to geometrize the character $\ZZ \to \EEx$ defined by
$1 \mapsto \ell$, which has unbounded image,
using quasicharacter sheaves on the etale group scheme $\ZZ$ with trivial Galois action.
%Likewise, the dictionary is perfect for the etale group scheme $\ZZ$ with Galois action determined by $\Frob{}(n) = -n$. By contract, the etale group scheme $\ZZ \times \ZZ$ with trivial Galois action does admit invisible quasicharacter sheaves -- there are non-trivial quasicharacter sheaves on this group with trivial trace of Frobenius.\todo{Under construction} (Move this example: Define $g: \ZZ\times \ZZ \to \EEx$ by $g((n_1,m_1), (n_2, m_2)) = \ell^{m_1-m_2 + n_1-n_2}$. Then use the tehniques of Section~\ref{sec:etale} to build a non-trivial character sheaf from the pair $(f=1,g)$ with trivial trace of Frobenius.)

%\subsection*{Motivation and Application}

Our interest in the function--sheaf dictionary for smooth commutative group schemes over $\Fq$, especially etale commutative group schemes, comes from an application to $p$-adic representation theory.
In \cite{cunningham-roe:13a} we consider quasicharacter sheaves on the
Greenberg transform of the N\'eron model of an algebraic torus over an arbitrary local field.
The ability to work with non-connected group schemes,
of which the component group of the special fibre of the Neron model of a torus is an important example,
plays a crucial role in this application,
since these group schemes are not connected in general.
This process of creating a category from the group of quasicharacters of such a torus
informs our choice of the term quasicharacter sheaf, here.

%\subsection*{Comparison with other character sheaves}

We also want to situate our terminology in a historical context.
It is not uncommon to refer to local systems satisfying \eqref{introbox} on a connected, commutative algebraic group as character sheaves;
see for example, \cite{kamgarpour:09a}.
As explained above, quasicharacter sheaves evolved from this notion,
with an eye toward quasicharacters of $p$-adic groups.
However, the main use of the term character sheaf is of course due to Lusztig.
It is applied to certain perverse sheaves on connected reductive algebraic groups over algebraically closed fields in
\cite{lusztig:85a}*{Def.~2.10} and to certain perverse sheaves on reductive groups
over algebraically closed fields with finite cyclic component groups in the series of papers
beginning with \cite{lusztig:disconnected1}.
When commutative, such groups are extensions of $\ZZ/n\ZZ$ by a torus,
in which case it is not difficult to relate Frobenius-stable character sheaves to our quasicharacter sheaves.
The interesting new features pertaining to Weil sheaves and the non-triviality of $\Hh^2(\pi_0({\bar G}),\EEx)^{\Frob{G}}$ do not arise in this case.


%\subsection*{Structure of the paper}
\todo{Describe the overall structure of the paper in enough detail that one can follow the argument; include snake lemma diagram}

We close the introduction with a brief description of the structure of this paper.
After setting some basic notation in Section~\ref{sec:notation},
in Section~\ref{sec:category} we define quasicharacter sheaves and give an interpretation of
them as Weil sheaves equipped with an isomorphism of the form \eqref{introbox}.
Section~\ref{sec:Frob} introduces Trace of Frobenius,
one direction of the function--sheaf dictionary.
We define pullbacks and products of quasicharacter sheaves in Section~\ref{sec:pullback}, and use
them to prove a functoriality result on Trace of Frobenius.
In Section~\ref{sec:basechange} we study how quasicharacter sheaves behave under base change
and Weil restriction.
Sections~\ref{sec:bounded} and \ref{sec:finite} describe bounded quasicharacter sheaves and finite quasicharacter sheaves, respectively,
forming two important subcategories of $\QC(G)$.
%These subcategories play a key role in the proof of Proposition~\ref{prop:restriction}.
In Section \ref{sec:connected} we show that all quasicharacter sheaves on $G$ are finite quasicharacter sheaves when $G$ is connected, and that Trace of Frobenius is an isomorphism in this case.
We shift to \'etale group schemes $G$ in Section~\ref{sec:etale} and find a cohomological interpretation
of quasicharacter sheaves in this case.
In Section~\ref{sec:restriction} we show that for non-connected $G$, restriction to the identity component
induces an essentially surjective functor of quasicharacter sheaves.
%Section~\ref{sec:snake} presents the main theorem of this paper: Trace of Frobenius
%is a functorial isomorphism from isomorphism classes of flabby quasicharacter sheaves on $G$
%to characters of $G(\Fq)$.

\todo{Comments about Joseph Bernstein's comments?}

%\begin{acknowledgements}
\subsection*{Acknowledgments}
We thank Masoud Kamgarpour, Pramod Achar, and Hadi Salmasian
for allowing us to hijack much of our Research in Teams meeting at BIRS into a discussion of
quasicharacter sheaves; their knowledge and help have been invaluable.
We also thank Takashi Suzuki, who made some enormously helpful observations and suggestions.
%
Finally, we gratefully acknowledge the financial support of the Pacific Institute for the Mathematical Sciences
and the National Science and Engineering Research Council,
as well the hospitality of the Banff International Research Station during our week-long stay in May 2012.

%\end{acknowledgements}

\tableofcontents

\section{The category of quasicharacter sheaves}


\subsection{Notations}\label{sec:notation}

Throughout this paper, $G$ is a smooth, commutative group scheme
over a finite field $\Fq$, and $m : \GxG\to G$ is its multiplication morphism.

We fix an algebraic closure $\bFq$ of $\Fq$ and write $\bG$ for the
smooth commutative group scheme $G \times_{\Spec{\Fq}} \Spec{\bFq}$ over $\bFq$
obtained by base change from $k$. The multiplication morphism for $\bG$ will be denoted by $\bm$.

Let $\Frob{}$ denote the geometric Frobenius element in $\Gal(\bFq/\Fq)$ as
well as the corresponding automorphism of $\Spec{\bFq}$. The Weil group
$\Weil{}\subset \Gal(\bFq/\Fq)$ is the subgroup generated by $\Frob{}$.
Let $\Frob{G} \ceq \id_{G} \times \Frob{}$ be the Frobenius automorphism of $\bG$.
%When no other fields play a role we will write $\Frob{}$ and $\Weil{}$ instead.

We fix a prime $\ell$, invertible in $\Fq$.
We will work with constructible $\ell$-adic sheaves \citelist{\cite{deligne:80a}*{\S 1.1} \cite{SGA5}*{Expos\'es V, VI}}
on schemes locally of finite type over $\Fq$, employing the standard formalism.
We also make extensive use of the external tensor product of $\ell$-adic sheaves,
defined as follows: if $\mathcal{F}$ and $\mathcal{G}$ are constructible $\ell$-adic
sheaves on schemes $X$ and $Y$ and $p_X : X\times Y\to X$ and $p_Y : X\times Y \to Y$
are the projections, then $\mathcal{F}\boxtimes \mathcal{G} \ceq p_X^* \mathcal{F} \otimes p_Y^*\mathcal{G}$.

For any group $A$, we will write $A^*$ for the dual group $\Hom_\text{grp}(A, \EEx)$.

\subsection{The category of quasicharacter sheaves}\label{sec:category}

\begin{definition}\label{def:QC}
A \emph{quasicharacter sheaf on $G$} is a triple
$\qcs{L}\ceq (\gqcs{L},\mu,\phi)$ where:
\begin{enumerate}
\labitem{(QC.1)}{QC.1} $\gqcs{L}$ is a rank~one $\ell$-adic local system on $\bG$, by which we mean
a constructible $\ell$-adic sheaf on $\bG$, locally constant on each connected
component of $\bG$, whose stalks are one-dimensional $\EE$-vector spaces;
\labitem{(QC.2)}{QC.2} $\mu: \bm^* \gqcs{L} \to \LxL$ is an isomorphism of
sheaves on $\bGxG$ such that the following diagram commutes,
  where $m_3 \ceq m\circ (m\tight{1}{\times}{2}\id) = m\circ (\id\tight{2}{\times}{1} m)$;
  \[
  \begin{tikzcd}[row sep=30]
  \bm_3^*\gqcs{L} \arrow{rr}{(\bm \tight{1}{\times}{2} \id)^*\mu} \arrow[swap]{d}{(\id \tight{2}{\times}{1} \bm)^*\mu}
    &&  \bm^*\gqcs{L} \boxtimes \gqcs{L} \dar{\mu \tight{0}{\boxtimes}{1} \id} \\
    \gqcs{L} \boxtimes \bm^* \gqcs{L} \arrow{rr}{\id \boxtimes \mu}
    &&  \gqcs{L} \tight{0}{\boxtimes}{0} \LxL
  \end{tikzcd}
  \]
\labitem{(QC.3)}{QC.3} $\phi : \Frob{G}^* \gqcs{L} \to \gqcs{L}$ is an
  isomorphism of constructible $\ell$-adic sheaves on $\bG$ compatible with
  $\mu$ in the sense that the following diagram commutes.
  \[
  \begin{tikzcd}[row sep=20]
  \Frob{\GxxG}^* \bm^* \gqcs{L} \arrow{rr}{\Frob{\GxxG}^*\mu}
    && \Frob{\GxxG}^*(\LxL)\\
    \arrow[equal]{u} \bm^*  \Frob{G}^* \gqcs{L} \arrow[swap]{d}{\bm^* \phi}
    && \Frob{G}^*\gqcs{L}\boxtimes \Frob{G}^*\gqcs{L} \dar{\phi\boxtimes \phi} \arrow[equal]{u} \\
    \bm^*\gqcs{L} \arrow{rr}{\mu}
    && \LxL
  \end{tikzcd}
  \]
\end{enumerate}
\end{definition}

Morphisms in the category of quasicharacter sheaves on $G$, denoted by $\QC(G)$, are defined in the natural way:
\begin{enumerate}
\labitem{(QC.4)}{QC.4} if $\qcs{L} = (\gqcs{L},\mu,\phi)$ and
  $\qcs{L'} = (\gqcs{L'},\mu',\phi')$ are quasicharacter sheaves on $G$ then
  a morphism $\qcs{L} \to \qcs{L}'$ is a map $\rho : \gqcs{L} \to \gqcs{L'}$
  of constructible $\ell$-adic sheaves on $\bG$ such that the following diagrams both commute.
  \[
  \begin{tikzcd}[column sep=40]
  \Frob{G}^* \gqcs{L} \rar{\Frob{G}^* \rho} \arrow[swap]{d}{\phi} & \Frob{G}^* \gqcs{L'} \dar{\phi'}
  & & \arrow[swap]{d}{\mu} m^* \gqcs{L} \rar{m^* \rho} & m^* \gqcs{L'} \dar{\mu'} \\
  \gqcs{L} \rar{\rho} & \gqcs{L'}
  & {} & \LxL \rar{\tight{1}{\rho\boxtimes \rho}{1}} & \gqcs{L'} \tight{0}{\boxtimes}{0} \gqcs{L'}
  \end{tikzcd}
  \]
\end{enumerate}

The category $\QC(G)$ of quasicharacter sheaves on $G$ is a rigid monoidal category
\cite{etingof:09a}*{\S1.10} under the tensor product
$\qcs{L} \otimes \qcs{L'} \ceq (\gqcs{L}\otimes\gqcs{L'}, \mu\otimes\mu', \phi\otimes \phi')$,
with duals given by applying the sheaf hom functor
$\sheafHom(\ - \ ,\EE)$.
This rigid monoidal category structure for $\QC(G)$ gives the set $\QCiso{G}$
of isomorphism classes in $\QC(G)$ the structure of a group.

In this paper we find the group $\QCiso{G}$ [point]
and also the set $\Hom(\qcs{L},\qcs{L}')$, for all quasicharacter sheaves $\qcs{L}$, $\qcs{L}'$ on $G$ [point]; in this way we provide a complete description of the category $\QC(G)$.

\begin{remark}
The category of quasicharacter sheaves on $G$ is not abelian; $\QC(G)$
is not a tensor category in the sense of \cite{deligne:02a}*{0.1}.
\end{remark}

\subsection{Pull-back and products}\label{sec:pullback}

As a step toward understanding quasicharacter sheaves we begin by showing that quasicharacter sheaves admit pull-backs and external products.
%show that every morphism $H \to G$ of smooth commutative groups schemes over $\Fq$ induces a monoidal functor from quasicharacter sheaves on $G$ to quasicharacters on $H$. 
These simple but important results will be used in the proofs of many results in this paper.

\begin{proposition}\label{prop:pullback}
  If $f : H\to G$ is a morphism of smooth commutative group schemes over $\Fq$ then
  \begin{align*}
  f^* : \QC(G) &\to \QC(H) \\
  (\gqcs{L},\mu,\phi) &\mapsto (\bf^*\gqcs{L},(\bfxf)^*\mu,\bf^*F)
  \end{align*}
  defines a monoidal functor dual to $f \colon H(\Fq) \to G(\Fq)$:
  \[
  \begin{tikzcd}[row sep=20, column sep=30]
   \QCiso{G} \rar{f^*} \arrow[swap]{d}{\TrFrob{G}} & \QCiso{H} \dar{\TrFrob{H}} \\
   G(\Fq)^* \rar & H(\Fq)^*
  \end{tikzcd}
  \]
  is a commutative diagram of groups.  Moreover, $(f\circ g)^* = g^* \circ f^*$.
\end{proposition}

\begin{proof}
  Let $\qcs{L}$ be a quasicharacter sheaf on $G$. We start by showing that
  $\bf^*\gqcs{L}$ is a local system of rank~one. Let $c_j :\bH^j \hookrightarrow \bH$ be any
  connected component and let $d_i : \bG^i \hookrightarrow \bG$ be the image of $j$ under the group
  homomorphism $\pi_0(\bf) : \pi_0(\bH) \to \pi_0(\bG)$.  Write $\bf^j : \bH^j \to \bG^i$
  for the restriction of $f$ to $\bH^j$.  Since $\gqcs{L}$ is locally constant on the connected
  components of $\bG$, there is a finite \'etale covering
  $a_i : X_i \to \bG^i$ such that $a_i^* (\gqcs{L}\vert_{\bG^i})$
  is constant.  Define $Y_j$ in the following diagram through pullback:
  \[
  \begin{tikzcd}[row sep=20, column sep=30]
   Y_j \dar[dashed]{g_j} \rar[dashed]{b_j} & \bH^j \dar{\bf^j} \rar[hook]{c_j} & \bH \dar{\bf} \\
   X_i \rar{a_i} & \bG^i \rar[hook]{d_i} & \bG
  \end{tikzcd}
  \]
  Then $b_j$ is a finite \'etale covering
  of $\bH^j$ and
  \[
  b_j^* \left( (\bf^* \gqcs{L})\vert_{\bH^j}\right)
  = (\bf\circ c_j \circ b_j)^*\gqcs{L}
  = (d_i\circ a_i\circ g_j)^*\gqcs{L} = g_j^* a_i^* (\gqcs{L}\vert_{\bG^i}).
  \]
  Since $a_i^* (\gqcs{L}\vert_{\bG^i})$ is a constant sheaf, its pullback
  $b_j^* \left( (\bf^*\gqcs{L})\vert_{\bH^j}\right)$ along $g_j$ is also constant.
  Thus $\bf^*\gqcs{L}$ is locally constant on
  $\bH^j$. To complete the proof that $\bf^*\gqcs{L}$ satisfies
  \ref{QC.1}
  simply observe that $\bf^*\gqcs{L}$ has rank~one since
  $(\bf^*\gqcs{L})_{\bg} = \gqcs{L}_{f(\bg)}$, for every geometric point ${\bg}$ on $\bG$.


  To see that $(\bfxf)^* \mu$ satisfies \ref{QC.2},
  apply the functor $(\bfxf)^*$
  to \ref{QC.2} for $\qcs{L}$ and use the canonical isomorphism
  $(\bfxf)^*(\LxL) \iso \bf^*\gqcs{L} \tight{-3}{\boxtimes}{-3} \bf^*\gqcs{L}$.
  To show that $f^*\qcs{L}$ satisfies
  \ref{QC.3}, apply the same functor to \ref{QC.3} for $\qcs{L}$.
  Since $f$ is a morphism of group schemes defined over $\Fq$
  it provides isomorphisms $(\bfxf)^*\Frob{\GxxG}^* \iso \Frob{\GxxG}^* (\bfxf)^*$
  and $(\bfxf)^* \bm^*\iso \bm^* \bf^*$ between functors of constructible sheaves.

  Applying $\bf^*$ and $\bf^* \tight{1}{\times}{1}\bf^*$ to \ref{QC.4} defines the action
  of $f^*$ on morphisms of quasicharacter sheaves; arguing as above shows that $f^*$ is
  a functor from $\QC(G)$ to $\QC(H)$.  Since tensor products commute with pullback in schemes,
  $f^* : \QC(G) \to \QC(H)$ is a monoidal functor.
  The diagram relating $f^* : \QC(G) \to \QC(H)$, $f^* : G(k)^* \to H(k)^*$ and Trace of Frobenius
  commutes by \cite{laumon:87a}*{1.1.1.2}, where the ambient
  hypothesis that $X$ is of finite type over $\Fq$ can be replaced by
  the hypothesis that $X$ is locally of finite type over $\Fq$.

  Finally, the fact that $(f\circ g)^* = g^* \circ f^*$ follows from the analogous
  statements about the pullback functor on $\ell$-adic constructible sheaves.
\end{proof}

%We end this section with a simple result on products of quasicharacter sheaves, which is needed to show that the isomorphism above is functorial.

\begin{proposition}\label{prop:product}
If $G_1$ and $G_2$ are smooth commutative group schemes over $\Fq$ then the rule
$\boxtimes : (\qcs{L}_1,\qcs{L}_2)\to \qcs{L}_1\boxtimes\qcs{L}_2$ defines an equivalence of categories
\[
\QC(G_1)\times \QC(G_2) \to \QC(G_1\times G_2)
\]
such that
\[
\begin{tikzcd}[column sep=60]
\arrow{d}{\TrFrob{G_1} \times \TrFrob{G_2}} \QCiso{G_1}\times \QCiso{G_2} \arrow{r}{\boxtimes}
& \arrow{d}{\TrFrob{G_1\times G_2}} \QCiso{G_1\times G_2}\\
(G_1)(\Fq)^*\times (G_2)(\Fq)^* \arrow{r}{(\chi_1,\chi_2)\mapsto \chi_1\otimes \chi_2}  & (G_1\times G_2)(\Fq)^*
\end{tikzcd}
\]
commutes.
\end{proposition}

\begin{proof}
The only non-trivial part of the proof is to show that $\boxtimes : \QC(G_1)\times \QC(G_2) \to \QC(G_1\times G_2)$
is essentially surjective, so we will only address that point here.

Set $G \ceq G_1\times G_2$
and write $e_1$ and $e_2$ for the identity elements of $G_1$ and $G_2$.
Define $f : G\to G\times G$ by $f(g_1,g_2) \ceq (g_1,e_2,e_1,g_2)$.
Observe that $m\circ f = \id_G$.
Let $p_1$, $p_2$ be the projection morphisms pictured below:
\[
\begin{tikzcd}
G & \arrow[swap]{l}{p_1} G\times G \arrow{r}{p_2} & G.
\end{tikzcd}
\]
Let $r_1$ and $r_2$ be the projection morphisms pictured below,
with sections $q_1$ and $q_2$, also morphisms of group schemes:
\[
\begin{tikzcd}
G_1  \arrow[swap, bend right]{r}{q_1} &
\arrow[swap, bend right]{l}{r_1} G_1\times G_2 \arrow[bend left]{r}{r_2} &
\arrow[bend left]{l}{q_2} G_2.
\end{tikzcd}
\]
Observe that $p_1\circ f = q_1 \circ r_1$ and $p_2 \circ f = q_2\circ r_2$.

Now, let $\qcs{L} \ceq (\gqcs{L},\mu,\phi)$ be a quasicharacter sheaf on $G$.
Set $\qcs{L}_1 \ceq q_1^* \qcs{L}$ and $\qcs{L}_2 \ceq q_2^* \qcs{L}$;
by Proposition~\ref{prop:pullback}, $\qcs{L}_1$ a quasicharacter sheaf on $G_1$
and $\qcs{L}_2$ is a quasicharacter sheaf on $G_2$.
We will obtain an isomorphism $\qcs{L} \iso  \qcs{L}_1\boxtimes \qcs{L}_2$.
Applying the functor $f^*$ to the isomorphism $\mu$ yields
\begin{equation}\label{eq:fm}
f^*\mu : f^* m^* \gqcs{L} \to f^*(\gqcs{L}\boxtimes \gqcs{L}) .
\end{equation}
We have already observed that $m\circ f = \id_G$, so $f^* m^* \gqcs{L} = \gqcs{L}$.
On the other hand, $f^*(\gqcs{L}\boxtimes \gqcs{L}) = f^*p_1^*\gqcs{L}\otimes f^* p_2^*\gqcs{L}$
by definition.  Since $f^*p_1^*\gqcs{L} = r_1^* q_1^* \gqcs{L}$ and $f^*p_2^*\gqcs{L} = r_2^* q_2^* \gqcs{L}$
we get that $f^*(\gqcs{L}\boxtimes \gqcs{L}) = \gqcs{L}_1\boxtimes \gqcs{L}_2$.
It follows that \eqref{eq:fm} gives an isomorphism $\gqcs{L} \to  \gqcs{L}_1\boxtimes \gqcs{L}_2$.
It is a matter of routine to show that this morphism satisfies
\ref{qc.3} as it applies here,
from which it follows that we have exhibited an isomorphism
$\qcs{L} \to \qcs{L}_1\boxtimes \qcs{L}_2$ of quasicharacters sheaves on $G\times G$.
This completes the proof that $\boxtimes$ is essentially surjective.
\end{proof}

\subsection{Trace of Frobenius}\label{sec:Frob}

We now introduce a tool which will help us understand isomorphism classes of objects in $\QCiso{G}$.


%A Weil sheaf $(\gqcs{L},\phi)$ on $G$ may be interpreted as a constructible $\ell$-adic sheaf $\gqcs{L}$ on $\bG$ together with an action of the Weil group $\Weil{}$ on $\gqcs{L}$ compatible with the action of $\Gal(\bFq/\Fq)$ on $\bG$. 
%We now briefly review this point of view for later use in Section~\ref{sec:basechange}; see also \cite{deligne:80a}*{Def.~1.1.10}.  If $w \ceq \Frob{}^n$ we write $w_G$ for $\Frob{G}^n$.
%For each such $w$ we define an isomorphism $\varphi(w) : w_G^* \gqcs{L}\to \gqcs{L}$ by $\varphi(w) \ceq  \phi \circ \Frob{G}^*(\phi) \circ \cdots \circ (\Frob{G}^{n-1})^*(\phi);$
%these isomorphisms satisfy $\varphi(uv) = \varphi(v) \circ v_G^* \varphi(u)$ for $u,v\in \Weil{}$, and we have $\phi = \varphi(\Frob{})$.
%If we further define $\varphi_1(w) \ceq (w_G)_*(\varphi(w)^{-1})$ then $\varphi_1(w) : (w_G)_* \gqcs{L}\to \gqcs{L}$ is an isomorphism and $\varphi_1(uv) = \varphi_1(u) \circ (u_G)_* \varphi_1(v)$ for $u,v\in \Weil{}$.
%Thus the pair $(\gqcs{L},\varphi_1)$ almost satisfies the criteria for an action of $\Weil{}$ on $\gqcs{L}$ compatible with the action of $\Gal(\bFq/\Fq)$ in the sense of\cite{deligne:SGA4.5}*{Expos\'e XIII, 1.1}, failing only because $\Weil{}$ is not profinite.
%As we will see in Corollary~\ref{cor:bounded-and-finite}, our use of $\Weil{}$ rather than $\Gal(\bFq/\Fq)$ allows quasicharacter sheaves to correspond to unbounded characters.

%Observe that the rule $(\gqcs{L},\mu,\phi) \mapsto (\gqcs{L},\phi)$ defines a forgetful functor from quasicharacter
%sheaves on $G$ to ($\ell$-adic) Weil sheaves on $G$ \cite{deligne:80a}*{Def.~1.1.10 (i)}.
%


Let $(\gqcs{L},\phi)$ be a Weil sheaf on $G$. Every $g\in G(\Fq)$
determines a point $\bg$ on $\bG$ fixed by $\Frob{G}$. 
Together with the canonical isomorphism $(\Frob{G}^*\gqcs{L})_{\bg} \iso  \gqcs{L}_{\Frob{G}(\bg)}$, in this way the automorphism $\phi$ determines an automorphism $\phi_{\bg}$ of the $\EE$-vector space $\gqcs{L}_{\bg}$; let $\trace(\phi_{\bg};\gqcs{L}_{\bg})$ be the trace of $\phi_{\bg} \in \Aut_{\EE}(\gqcs{L}_{\bg})$ and let $\trFrob{(\gqcs{L},\phi)} : G(\Fq)\to \EE$ be the function defined by 
\begin{equation}\label{trWeil}
%\begin{equation}\label{trWeil}
\trFrob{(\gqcs{L},\phi)}(g) \ceq \trace(\phi_{\bg};\gqcs{L}_{\bg}),
%\end{equation}
\end{equation}
commonly called the {\em trace of Frobenius of $(\gqcs{L},\phi)$}.
Note that if $(\gqcs{L},\phi) \iso (\gqcs{L'},\phi')$ as Weil sheaves, 
then $\trFrob{(\gqcs{L},\phi)} = \trFrob{(\gqcs{L'},\phi')}$ as functions on $G(\Fq)$.

Now suppose $\qcs{L} = (\gqcs{L},\mu,\phi)$ is a quasicharacter sheaf on $G$.
The isomorphism $\mu : \bm^* \gqcs{L} \to \LxL$ together with
\ref{QC.3} guarantee
that the function $\trFrob{(\qcs{L},\phi)} : G(\Fq)\to \EEx$ is a group homomorphism.  
Moreover, this group homomorphism is insensitive to $\phi$ in the sense 
that if $(\gqcs{L},\mu,\phi)$ and $(\gqcs{L},\mu,\phi')$ are quasicharacter sheaves, then $\trFrob{(\qcs{L},\phi)} = \trFrob{(\qcs{L},\phi')}$. \todo{Sketch proof?}
This justifies abbreviating $\trFrob{(\gqcs{L},\phi)}$ to $\trFrob{\qcs{L}}$ in this case.
The diagram below defines two group homomorphisms, both denoted $\TrFrob{G}$ and both called the \emph{Trace of Frobenius} for $G$; we trust that context will remove any ambiguity regarding this notation.
\[
\begin{tikzcd}
\QCiso{G} \arrow{rr} \arrow{dr}[swap]{\qcs{L} \mapsto t_{\qcs{L}}}{\TrFrob{G}} && \arrow{dl}[swap]{\TrFrob{G}}{(\gqcs{L},\phi) \mapsto t_{\gqcs{L},\phi}} \lQCiso{G} \\
& G(\Fq)^* & 
\end{tikzcd}
\]
As remarked above, the group homomorphism $\QCiso{G} \to \lQCiso{G}$ is surjective;
we will see that $\QCiso{G} \to \lQCiso{G}$ need not be injective.
However, in Theorem~\ref{thm:snake}, we will see that the group homomorphism $\QCiso{G} \to G(\Fq)^*$ is surjective
while the main result of this paper, Theorem~\ref{thm:snake}, 
shows that $\lQCiso{G} \to G(\Fq)^*$ is an isomorphism.

\begin{proposition}\label{prop:functorialG}
Trace of Frobenius $\TrFrob{G} : \QCiso{G} \to G(\Fq)^*$ is a natural transformation
between the two contravariant additive functors
\begin{align*}
F_1 : G &\mapsto \QCiso{G} \\
F_2 : G &\mapsto G(\Fq)^*
\end{align*}
from the category of smooth commutative group schemes over $\Fq$ to the category of abelian groups.
Likewise, for $\TrFrob{G} : \lQCiso{G} \to G(\Fq)^*$, {\it mut.\hskip-1pt mut.}
\end{proposition}

\begin{proof}
The first part of Proposition~\ref{prop:pullback} shows that $F_1$ is a functor,
while the second part shows that Trace of Frobenius is a natural transformation
$T: F_1 \to F_2$. When further combined with Proposition~\ref{prop:product},
we see that $F_1$ is an additive functor and $T: F_1 \to F_2$ is a natural
transformation between additive functors,
concluding the proof of Proposition~\ref{prop:functorialG}.
\end{proof}

In [point] we will use trace of Frobenius $\TrFrob{G} : \QCiso{G} \to G(\Fq)^*$ to show that $\QCiso{G}$ is an extension of $G(\Fq)^*$ by $\Hh^0(\Weil{},\Hh^2(\pi_0({\bar G}),\EEx))$.

%\subsection{Morphisms of quasicharacter sheaves}\label{sec:mor}

\section{The case of \'etale commutative group schemes} \label{sec:etale}

%\subsection{Quasicharacter sheaves, revisited}

%\'Etale group schemes form a counterpoint to connected groups,
%since the component group of a smooth commutative group scheme
%is an \'etale group scheme \cite{vdGeer-Moonen:AbelianVarieties}*{III, \S 4}.
%However, the function--sheaf dictionary is substantially different in the two cases.
%To see why, we begin by specializing the definition of quasicharacter sheaves to the case
%of etale commutative group schemes,
%using the equivalence $G \mapsto G(\bFq)$
%from the category of \'etale group schemes over $\Fq$ to the category of groups equipped
%with an action of $\Gal(\bFq/\Fq)$, continuous for the discrete topology on the group.

In this section we find a complete characterization of quasicharacter sheaves on etale commutative group schemes over finite fields.

The equivalence $G \mapsto G(\bFq)$
from the category of \'etale commutative group schemes over $\Fq$ to the category of commutative groups equipped
with an action of $\Gal(\bFq/\Fq)$, continuous for the discrete topology on the group,
provides the following simple description of quasicharacter sheaves.
%
A quasicharacter sheaf $\qcs{L}$ on an etale commutative group scheme $G$ over $\Fq$ is:
\begin{enumerate}
 \labitem{(qc.1)}{qc.1} an indexed set of one-dimensional
  $\EE$-vector spaces $\gqcs{L}_x$, as $x$ runs over
  $G(\bFq)$;

 \labitem{(qc.2)}{qc.2} an indexed set of isomorphisms
  $\mu_{x,y} : \gqcs{L}_{x+y} \xrightarrow{\iso} \gqcs{L}_{x} \otimes\gqcs{L}_{y}$,
  for all $x,y \in G(\bFq)$, such that
  \[
   \begin{tikzcd}[row sep=40]
    \gqcs{L}_{x+y+z} \arrow{rr}{\mu_{x+y,z}} \arrow[swap]{d}{\mu_{x,y+z}}
    && \gqcs{L}_{x+y}\otimes\gqcs{L}_{z} \dar{\mu_{x,y} \tight{0.5}{\otimes}{1} \id} \\
    \gqcs{L}_{x} \otimes\gqcs{L}_{y+z} \arrow{rr}{\id \otimes\mu_{y,z}}
    && \gqcs{L}_{x} \otimes\gqcs{L}_{y} \otimes\gqcs{L}_{z}
   \end{tikzcd}
  \]
  commutes, for all $x,y,z\in G(\bFq)$; and
 \labitem{(qc.3)}{qc.3} an indexed set of isomorphisms $\phi_{x} : \gqcs{L}_{\Frob{}(x)} \to \gqcs{L}_x$
  such that
  \[
   \begin{tikzcd}[row sep=40]
    \gqcs{L}_{\Frob{}(x)+\Frob{}(y)} \arrow[swap]{d}{\phi_{x+y}} \arrow{rr}{\mu_{\Frob{}(x),\Frob{}(y)}}
    && \gqcs{L}_{\Frob{}(x)}\otimes\gqcs{L}_{\Frob{}(y)} \dar{\phi_x \tight{0}{\otimes}{0} \phi_y} \\
    \gqcs{L}_{x+y} \arrow{rr}{\mu_{x,y}}
    && \gqcs{L}_x \otimes\gqcs{L}_y
   \end{tikzcd}
  \]
  commutes, for all $x,y\in G(\bFq)$.
\end{enumerate}
Under this equivalence, a morphism $\rho : \qcs{L} \to \qcs{L'}$ of quasicharacter sheaves on $G$ is given by
\begin{enumerate}
 \labitem{(qc.4)}{qc.4} an indexed set $\rho_x : \gqcs{L}_x \to \gqcs{L'}_x$
  of linear transformations such that
  \[
   \begin{tikzcd}[column sep=40]
    \arrow[swap]{d}{\phi_x} \gqcs{L}_{\Frob{}(x)} \rar{\rho_{\Frob{}(x)}} & \gqcs{L'}_{\Frob{}(x)} \dar{\phi_x'}
    &\arrow[draw=none]{d}[pos=.4,description]{\text{\normalsize{and}}}
    & \arrow[swap]{d}{\mu_{x,y}} \gqcs{L}_{x+y} \rar{\rho_{x+y}} & \gqcs{L'}_{x+y} \dar{\mu'_{x,y}} \\
    \gqcs{L}_x \rar{\rho_x} & \gqcs{L'}_x
    & {} & \gqcs{L}_x\otimes\gqcs{L}_y \rar{\rho_x\otimes\rho_y} & \gqcs{L'}_x \otimes\gqcs{L'}_y
   \end{tikzcd}
  \]
  both commute for all $x, y \in G(\bFq)$.
\end{enumerate}

We will see that the Trace of Frobenius may not provide complete
information about isomorphism classes of quasicharacter sheaves on $G$ when $G$ is not a connected algebraic group.
Our main tool for understanding this phenomenon
is a group homomorphism from $\QCiso{G}$ to $\Hh^2(E^\bullet_G)$, defined in Section~\ref{sec:S}, for which the next two sections are preparation.

\subsection{A spectral sequence}\label{sec:E}

The zeroth page of the Hochschild-Serre spectral sequence is a double complex $E^{\bullet, \bullet}$ defined by
\[
E^{i,j} = C^i(\Weil{}, C^j(G(\bFq), \EEx)),
\]
The derivative of group cohomology yields two derivatives:
\begin{align*}
d_0 = d_G &: E^{i,j} \to E^{i,j+1} \\
d_{\Weil{}} &: E^{i,j} \to E^{i+1,j}.
\end{align*}
Combining these yields a derivative $d = d_G + (-1)^j d_{\Weil{}}$ on the total complex
\[
E^n_G = \bigoplus_{i+j=n} E^{i,j}.
\]
The machinery of spectral sequences gives us a sequence of pages $E_r^{i,j}$, converging to a page $E_{\infty}^{i,j}$. We summarize the key properties of this spectral sequence in the following proposition.

\begin{proposition}
\begin{enumerate}
\item The second page is given by $E_2^{i,j} = \Hh^i(\Weil{}, \Hh^j(G(\bFq), \EEx))$,
\item there is an isomorphism $\Hh^n(\Weil{} \ltimes G(\bFq), \EEx) \cong \Hh^n(E_G^\bullet)$,
\item there is a filtration $\Hh^n(\Weil{} \ltimes G(\bFq), \EEx) = F_n \supset \cdots \supset F_0 \supset F_{-1} = 0$ where $F_i / F_{i-1} \cong E_{\infty}^{i, n-i}$.
\end{enumerate}
\end{proposition}

Moreover, since $\Weil{} \cong \ZZ$ has cohomological dimension $1$, $E_2^{i,j} = 0$ for $i > 1$ and the sequence degenerates at the second page: $E_{\infty}^{i,j} = E_2^{i,j}$. We obtain the following corollary:

\begin{corollary}
There is a short exact sequence
 \[
  \begin{tikzcd}
    0 \arrow{r}
    & \Hh^0(\Weil{},\Hh^2({\bar G},\EEx)) \arrow{r}
    & \Hh^2(E^\bullet_G) \arrow{r}
    & \Hh^1(\Weil{},\Hh^1({\bar G},\EEx)) \arrow{r}
    & 0
  \end{tikzcd}
 \]
\end{corollary}

This sequence will play a key role in understanding the kernel of $T_G$, as described in the next few sections.
For this application, we need a good understanding of these maps to and from the total complex.

\begin{proposition} \label{prop:ses_desc}
\begin{enumerate}
\item Every class $[\alpha\oplus\beta\oplus\gamma] \in \Hh^2({\bar G},\EEx)$ is cohomologous to one with $\gamma=0$.
\item The map $\Hh^2(E^\bullet_G) \to \Hh^1(\Weil{},\Hh^1({\bar G},\EEx))$ is given by $[\alpha\oplus\beta\oplus 0] \mapsto [\beta]$.
\item Suppose $a \in Z^2({\bar G}, \EEx)$ represents a class in $\Hh^2({\bar G},\EEx)$ fixed by Frobenius.
The map $\Hh^0(\Weil{},\Hh^2({\bar G},\EEx)) \to \Hh^2(E^\bullet_G)$ is given by $[a] \mapsto [a \oplus 0 \oplus 0]$.
\end{enumerate}
\end{proposition}
\begin{proof}
Since $\Hh^2(\Weil{}, C^0({\bar G}, \EEx)) = 0$, we may find a $\gamma_1 \in C^1(\Weil{}, C^0({\bar G}, \EEx))$ with $d_{\Weil{}}\gamma_1 = \gamma$.
Subtracting $d \gamma_1$ from $\alpha\oplus\beta\oplus\gamma$, we may assume that $\gamma = 0$.

The latter two claims follow from tracing through the definition of latter pages in the spectral sequence; see Vakil \cite{} for example \todo{update reference}.
\end{proof}

\subsection{From quasicharacter sheaves to the total complex}\label{sec:S}

In this section we define an isomorphism
\[
S_G : \QCiso{G} \to \Hh^2(E^\bullet_G).
\]
Let $\qcs{L} = (\gqcs{L},\mu,\phi)$ be a quasicharacter sheaf on $G$.
For each geometric point $x\in {\bar G}$, choose a basis $\{ v_x \}$ for $\gqcs{L}_x$.
Through this choice, $\qcs{L}$ determines functions
\begin{align*}
a : {\bar G}\times {\bar G} &\to \EEx & b : {\bar G} &\to \EEx \\
\mu_{x,y}(v_{x+y}) &= a(x,y) v_x \otimes v_y & \phi_x(v_{\Frob{G}(x)}) &= b(x) v_x.
\end{align*}
Condition~\ref{QC.2} implies that
\begin{equation}\label{2-cocyle}
a(x+y,z) a(x,y) = a(x,y+z) a(y,z)
\end{equation}
for all $x,y,z\in {\bar G}$, so $a \in Z^2({\bar G},\EEx)$.  Similarly, condition~\ref{QC.3} gives
\begin{equation}\label{nohom}
\frac{a(\Frob{G}(x),\Frob{G}(y))}{a(x,y)} =  \frac{b(x+y)}{b(x) b(y)}
\end{equation}
for $x, y \in {\bar G}$.
Let $\alpha \in C^0(\Weil{},C^2({\bar G},\EEx)$ be the $0$-cochain corresponding to $a$ and let $\beta\in C^1(\Weil{},C^1({\bar G},\EEx)$ be the cocycle such that $\beta(\Frob{})$ is $b$ \emph{written additively}.
Then
\[
d_G\alpha =0, \qquad\qquad
d_{\Weil{}} \alpha = d_{G} \beta,\qquad\qquad
d_{\Weil{}} \beta =0;
\]
in other words,
\[\alpha\oplus \beta \in Z^2(E^\bullet_G).\]
Although the cocycle $\alpha\oplus \beta$ is not well defined by $\qcs{L}$, its class in $Z^2(E^\bullet_G)$ is.
To see this, let $\{ v'_x \in \gqcs{L}_x^\times \tq x \in {\bar G}\}$ be another choice and let $\alpha'\oplus \beta' \in Z^2(E^\bullet_G)$ be defined by $\qcs{L}$ and this choice, as above.
Now let $\delta \in C^0(\Weil{},C^1({\bar G},\EEx))$ be the additive version of the function $d : {\bar G}\to \EEx$ defined by $v'_x = d(x) v_x$.
Then, chasing through \ref{QC.2} and \ref{QC.3} we find
\[
\alpha'\oplus\beta' = \alpha\oplus\beta + d\delta,
\]
so the class $[\alpha\oplus\beta]$ of $\alpha\oplus\beta$ in $\Hh^2(E^\bullet_G)$ is independent of the choice made above. It is also easy to see that $[\alpha\oplus\beta] = [\alpha_0\oplus\beta_0]$ when $\qcs{L} \iso \qcs{L}_0$,
which concludes the definition of the function
\begin{align*}
S_G : \QCiso{G} &\to \Hh^2(E^\bullet_G)\\
[\qcs{L}] &\mapsto [\alpha\oplus \beta].
\end{align*}
It is also easy to see that $[\alpha_1\oplus\beta_1] + [\alpha_2\oplus\beta_2] = [\alpha_3\oplus\beta_3]$ when $\qcs{L}_3 = \qcs{L}_1\otimes \qcs{L}_2$, so $S_G$ is a group homomorphism.

\begin{remark}
Although we will only use the group homomorphism $S_G : \QCiso{G}\to \Hh^2(E^\bullet_G)$ when $G$ is an etale commutative group scheme, the function is defined for all smooth commutative group schemes $G$.
However, the next result is false in that context.
\end{remark}

\begin{proposition}
If $G$ is \'etale then $S_G$ is an isomorphism.
\end{proposition}
\begin{proof}
We first show that $S_G$ is injective.  Suppose $\qcs{L} \in \QCiso{G}$ with $S_G(\qcs{L}) = [\alpha \oplus \beta] = 0$,
so that $\alpha \oplus \beta = d\rho$ for some $\rho \in C^0(\Weil{},C^1({\bar G},\EEx) = C^1({\bar G},\EEx)$.
For each $x\in {\bar G}$, define $\rho_x : \gqcs{L}_x \to \EEx$ by $v_x \mapsto \rho(x)$.
Then the indexed set of isomorphisms $\{ \gamma_x : \gqcs{L}_x \to \EE \tq x\in {\bar G}\}$
defines an isomorphism $\qcs{L} \to (\EE)_G$.
Since $\qcs{L} = 0 \in \QCiso{G}$, $S_G$ is injective.

To see that $S_G$ is surjective, begin with $\alpha\oplus\beta\oplus 0 \in Z^2(E^\bullet_G)$.
Since $d_{\Weil{}} \beta = 0$, we may define $a = \alpha \in C^2({\bar G},\EEx)$ and
$b = \beta(\Frob{}) \in C^1({\bar G},\EEx)$, which are related to $\alpha$ and $\beta$ as above.
Set $\gqcs{L}_x = \EEx$, define $\mu_{x,y} : \gqcs{L}_{x+y} \to \gqcs{L}_x\otimes\gqcs{L}_y$
by $\mu_{x,y}(1) = a(x,y) 1\otimes 1$ and $\phi_x : \gqcs{L}_{\Frob{G}(x)} \to \gqcs{L}_x$ by $\phi_x(1)= b(x)$.
Then \ref{qc.1} holds since $d_G \alpha =0$ and \ref{qc.2} holds since $d_{\Weil{}}\alpha =d_G \beta$.
Tracing the construction backward, we have defined a quasicharacter sheaf $\qcs{L}$ on $G$ with
$S_G(\qcs{L}) = [\alpha\oplus\beta\oplus\gamma]$, showing that $S_G$ is surjective.
\end{proof}

\subsection{Objects, when $G$ is etale}%\texorpdfstring{$S$ and $T$}{S and T}}

In this section we find the relationship between the group homomorphisms $\TrFrob{G}$ and $S_G$, and use this to find the group $\QCiso{G}$ when $G$ is an etale commutative group scheme over $\Fq$.

%
We begin with a simple, general result relating duals, invariants and coinvariants.

\begin{lemma} \label{lem:dual-inv}
Let $X$ be an abelian group equipped with an action of $\Weil{}$.
 Then
\begin{align*}
 (X^*)_{\Frob{}} &\to (X^{\Frob{}})^* \\
 [f] &\mapsto f|_{X^{\Frob{}}}
\end{align*}
is an isomorphism.
\end{lemma}

\begin{proof}
We can describe $X^{\Frob{}}$ as the kernel of the map $X \xrightarrow{\Frob{}-1} X$;
let $Y = (\Frob{}-1)X$ be the augmentation ideal.  Dualizing the sequence
\[
 0 \to X^{\Frob{}} \to X \to Y \to 0
\]
yields
\[
 0 \to Y^* \to X^* \to (X^{\Frob{}})^* \to \Ext^1_\ZZ(Y, \EEx).
\]
Since $\Ext^1_\ZZ(-,\EEx)$ vanishes, we get a natural isomorphism from the cokernel of $Y^* \xrightarrow{\Frob{}-1} X^*$ to $(X^{\Frob{}})^*$.
\end{proof}

\begin{proposition}\label{prop:sur_etale}
If $G$ is \'etale then $\TrFrob{G} : \QCiso{G} \to G(\Fq)^*$ is surjective.
\end{proposition}
\begin{proof}
Pick $\chi \in G(\Fq)^*$.
By Lemma~\ref{lem:dual-inv}, there is some $b\in G(\bFq)^*$ such that $b\vert_{G(\Fq)^*} = \chi$.
Set $\gqcs{L}_x = \EE$ for every $x\in G(\bFq)$.
Define $\mu_{x,y} : \gqcs{L}_{x+y} \to \gqcs{L}_x\otimes \gqcs{L}_y$ by $\mu_{x,y}(1) = 1 \otimes 1$ and
$\phi_{x} : \gqcs{L}_{\Frob{}(x)} \to \gqcs{L}_x$ by $\phi_{x}(1) = b(x)$.
Since $b : G(\bFq) \to \EEx$ is a group homomorphism,
condition \eqref{nohom} is satisfied with $a =1$ and $\qcs{L} = (\gqcs{L}, \mu, \phi)$
is a quasicharacter sheaf with $\trFrob{\qcs{L}} = \chi$.
\end{proof}



\begin{proposition} \label{prop:etale-iso}
 If $G$ is \'etale then the map $S_G : \QCiso{G}\to \Hh^2(E^\bullet_G)$ induces an isomorphism of short exact sequences
\[
\begin{tikzcd}
 0 \arrow{r} & \ker \TrFrob{G} \arrow{d} \arrow{r} & \QCiso{G}\arrow{d}{S_G} \arrow{r}{\TrFrob{G}} \arrow{r} & G(\Fq)^* \arrow{d} \arrow{r} & 0\\
  0 \arrow{r} & \Hh^0(\Weil{},\Hh^2({\bar G},\EEx)) \arrow{r} & \Hh^2(E^\bullet_G) \arrow{r} & \Hh^1(\Weil{},\Hh^1({\bar G},\EEx)) \arrow{r} & 0.
 \end{tikzcd}
 \]
\end{proposition}
\begin{proof}
This result follows easily from Propositions~\ref{prop:ses_desc} and \ref{prop:sur_etale}.
\end{proof}

\subsection{Morphisms}\label{sec:mor-etale}

Most of this paper focuses on the question of determining the isomorphism classes of objects; a complete understanding of the morphisms in $\QC(G)$ also requires a description of the automorphisms of an arbitrary quasicharacter sheaf $\qcs{L}$.

\begin{proposition}\label{prop:mor_etale}
Let $G$ be an etale commutative group scheme over $\Fq$.
If $\qcs{L}$ and $\qcs{L}'$ are quasicharacter sheaves on $G$ then
every $\rho\in \Hom(\qcs{L},\qcs{L}')$ is either trivial or an isomorphism. Moreover, the trace map induces an isomorphism of groups
\[
\Aut(\qcs{L}) \to \Hom(G(\bFq)_{\Weil{}}, \EEx).
\]
\end{proposition}

\begin{proof}
Suppose $\rho \in \Hom(\qcs{L},\qcs{L}')$.
If $\rho_0 = 0$ then the second diagram in \ref{qc.4} for $y=0$ implies that $\rho_x = 0$ for all $x\in G$, in which case $\rho$ is trivial.
On the other hand, if $\rho_0$ is nonzero then the second diagram in \ref{qc.4} for $y = -x$ implies that $\rho_x$ is nonzero for all $x$ and thus an isomorphism since the stalk of quasicharacter sheaves are one dimensional; in this case $\rho$ is an isomorphism.

Now suppose $\rho \in \Aut(\qcs{L})$.
The second diagram in \ref{qc.4} shows that the association $x \mapsto \rho_x$ is a homomorphism from $G(\bFq)$ to $\EEx$ and the first diagram in \ref{qc.4} shows that it factors through $G(\bFq)_{\Weil{}}$.  Conversely, if $\rho : G(\bFq)_{\Weil{}} \to \EEx$ is any homomorphism then defining $\rho_x$ as multiplication by $\rho(x)$ will satisfy the two diagrams.  Composition of morphisms corresponds to pointwise multiplication in this correspondence, showing that the resulting bijection is actually a group isomorphism.
\end{proof}

Note that Proposition~\ref{prop:mor_etale} tells us that if $G$ is an etale commutative group scheme over $\Fq$ then every hom-set is either trivial or $\left(G(\bFq)_{\Weil{}}\right)^*$, non-canonically.

\section{Main results}\label{sec:main}

In this section we find $\QCiso{G}$ and $\Hom(\qcs{L},\qcs{L}')$ for every smooth commutative group scheme over $\Fq$; note that we found these in Section~\ref{sec:etale} when $G$ is etale. 

%\subsection{Bounded quasicharacter sheaves}\label{sec:bounded}
\subsection{Descent to G}\label{sec:bounded}

%Let $G$ be a smooth commutative group scheme over $\Fq$.
In this section we consider a category of sheaves on $G$ obtained by
replacing the Weil sheaf $(\gqcs{L}, \phi)$ on $\bG$ in the definition of a quasicharacter sheaf with an $\ell$-adic local system on $G$ itself.

\begin{definition}
Let $\bQC(G)$ be the category of pairs $(\qcs{E},\mu_\qcs{E})$
where $\qcs{E}$ an $\ell$-adic local system on $G$ of rank~one,
equipped with an isomorphism $\mu_\qcs{E} : m^* \qcs{E} \to \qcs{E} \boxtimes \qcs{E}$
satisfying the analogue of \ref{QC.1} on $G$;
morphisms in $\bQC(G)$ are defined as in the second part of
\ref{QC.3}.
%This is the category of \emph{bounded quasicharacter sheaves} on $G$.
\end{definition}

Category $\bQC(G)$ is a rigid monoidal category in the obvious way.

\begin{proposition}\label{prop:BG}
Extension of scalars defines a full and faithful functor $B_G : \bQC(G) \to \QC(G)$.
\end{proposition}

\begin{proof}
 Let $b_G : {\bar G} \to G$ be the pullback of $\Spec{\bFq} \to \Spec{\Fq}$ along $G\to \Spec{\Fq}$.
 Suppose $(\qcs{E},\mu_\qcs{E})$ in an object in $\bQC(G)$.
 Then $\qcs{E}$ is an $\ell$-adic constructible sheaf on $G$ and
 $b_G^* \qcs{E}$ comes equipped with an isomorphism
 $\phi_\qcs{E} : \Frob{G}^* b_G^*\qcs{E} \to b_G^* \qcs{E}$.
 The functor $\qcs{E} \mapsto (b_G^* \qcs{E},\phi_\qcs{E})$
 from $\ell$-adic constructible sheaves on $G$ to $\ell$-adic constructible sheaves on $G$
 is full and faithful \citelist{\cite{deligne-katz:SGA7.2}*{Expos\'e XIII} \cite{beilinson-bernstein-deligne:81a}*{Prop. 5.2.1}}.
 This functor preserves local constancy, so takes local systems to local systems.
 Set $\mu \ceq b_{G\times G}^*\mu_\qcs{E}$; clearly, this satisfies \ref{QC.2}
 with $b_G^*\qcs{E}$ playing the role of $\gqcs{L}$.
 Moreover, $\phi_\qcs{E}$ is compatible with $\mu_\qcs{E}$ in the sense of \ref{QC.3}.
 This construction defines the functor $B_G : (\qcs{E},\mu_\qcs{E}) \mapsto (b_G^*\qcs{E},b_{G\times G}^*\mu_\qcs{E}, \phi_\qcs{E})$
 and also shows that it is full and faithful.
\end{proof}

We will identify $\bQC(G)$ with its image under $B_G$ and say that a quasicharacter sheaf $\qcs{L} \in \QC(G)$ \emph{descend to $G$} if it is isomorphic to some $B_G(\qcs{E}, \mu_\qcs{E})$.
%We will see in Corollary~\ref{cor:bounded-and-finite} that bounded quasicharacter sheaves are exactly quasicharacter sheaves with bounded Trace of Frobenius.\todo{Check this, later.}

\subsection{Quasicharacter sheaves on connected commutative algebraic groups}\label{sec:connected}

In general, $\bQC(G)$ is an essentially
proper subcategory of $\QC(G)$. 
However, if $G$ is connected and of finite type, the categories are equivalent, as we now show.

\begin{lemma}\label{lem:bounded_connected}
If $G$ is a connected commutative algebraic group over $\Fq$ then every quasisharacter sheaf on $G$ is finite and $B_G : \bQC(G) \to \QC(G)$ is an equivalence of categories.
\end{lemma}

\begin{proof}
Choose any $\Fq$-rational point $g$ on $G$ and let $\bg$ be the geometric point on $G$ lying above $g$.
Recall that the \emph{Weil group} of $G$, which we will denote by $\W(G,\bg)$, is a subgroup of the \'etale
fundamental group defined by the following diagram:
\[
 \begin{tikzcd}
 1 \rar & \ar[equal]{d} \pi_1(\bG, \bg) \rar & \W(G,\bg) \rar \dar[hook] & \Weil{} \rar \dar[hook] & 1 \\
 1 \rar &  \pi_1(\bG, \bg) \rar & \pi_1(G,\bg) \rar & \Gal(\bFq/\Fq) \rar & 1.
 \end{tikzcd}
\]
The $\Fq$-rational point $g$ under the geometric point $\bg$ determines a splitting
$\Weil{}\to \W(G,\bg)$ of $\W(G,\bg)\to \Weil{}$.
%
  Since $G$ is connected, the geometric point $\bg$ determines
  an equivalence between the category of $\ell$-adic Weil local systems on $G$ and
  $\ell$-adic representations of $\W(G,\bg)$ \cite{deligne:80a}*{1.1.12}.
  
  Now let $(\gqcs{L},\mu,\phi)$ be a quasicharacter sheaf on $G$
  and let $\rho : \W(G, \bg) \to \EEx$ be the character determined by $(\gqcs{L},\phi)$.
  Composing with the splitting $\Weil{} \to \W(G,\bg)$ yields an $\ell$-adic character
  $\rho_g : \Weil{} \to \EEx$, which is the same as the Trace of Frobenius defined in Section~\ref{sec:Frob}, for every $\Fq$ rational point $g$ on $G$:
  $
  \rho_g(\Frob{}) =  \trFrob{\qcs{L}}(g).
  $
%
  On the other hand, we have already seen that $\trFrob{\qcs{L}} : G(\Fq) \to \EEx$
  is a group homomorphism. Since $G$ is an algebraic group over $\Fq$, it is a
  variety over $\Fq$ and thus $G(\Fq)$ is finite.
  Therefore $\trFrob{\qcs{L}}(g) = \rho_g(\Frob{})$ is a root of unity
  for every $g\in G(\Fq)$.  Since $\Weil{}$ is generated by
  $\Frob{}$ and $\rho_g : \Weil{} \to \EEx$ is
  a character, it follows that the image of $\rho_g$ is a finite group.
  Thus, $\rho_g$ extends to an $\ell$-adic character of $\Gal(\bFq/\Fq)$,
  which we will also denote $\rho_g$.
%
  We may now lift the $\ell$-adic character $\rho_g : \Gal(\bFq/\Fq) \to \EEx$
  to an $\ell$-adic character $\pi_1(G,\bg) \to \EEx$ using the canonical topological group homomorphism
  $\pi_1(G,\bg) \to \Gal(\bFq/\Fq)$. 
 % 
  The $\Fq$ rational point $g$ also
  determines an equivalence between the category of $\ell$-adic
  representations of $\pi_1(G,\bg)$ and $\ell$-adic local systems on $G$. Let
  $\qcs{L}_0$ be a local system on $G$ in the isomorphism class
  determined by this $\ell$-adic character of $\pi_1(G,\bg)$.
  Then $b_G^*\qcs{E} \iso \gqcs{L}$.
  
  Since $b_G^*$ is full and faithful
  \citelist{\cite{deligne-katz:SGA7.2}*{Expos\'e XIII} \cite{beilinson-bernstein-deligne:81a}*{Prop. 5.2.1}},
  $
  b_{G\times G}^* : \Hom(m^*\qcs{E},\qcs{E}\boxtimes\qcs{E}) \to \Hom({\bar m}^*\gqcs{L},\gqcs{L}\boxtimes\gqcs{L})
  $
  is a bijection
  (hom taken in the categories on constructible $\ell$-adic sheaves on
  $G\times G$ and ${\bar G}\times {\bar G}$ respectively,
  in which $\ell$-adic local systems sit as full subcategories).
  Let $\mu_\qcs{E} : m^*\qcs{E} \to \qcs{E}\boxtimes\qcs{E}$ be the isomorphism matching
  $\mu : {\bar m}^*\gqcs{L} \to \gqcs{L}\boxtimes\gqcs{L}$,
  the latter appearing in the definition of $\qcs{L}$.
  Then, as in Section~\ref{sec:bounded}, $(\qcs{E},\mu_\qcs{E})$ is an object in $\bQC(G)$
  and $\qcs{L} \ceq (\gqcs{L},\mu,\phi)$ is isomorphic to $(b_G^*\qcs{E},b_{G\times G}^*\mu_\qcs{E})$ in $\QC(G)$.
  Thus, the full and faithful functor $B_G : \bQC(G) \to \QC(G)$ from Section~\ref{sec:bounded}
  is also essentially surjective, hence an equivalence.
\end{proof}


\begin{proposition}\label{prop:connected}
 If $G$ is a connected, commutative algebraic group over $\Fq$ then
 \[
  \TrFrob{G} : \QCiso{G} \to G(\Fq)^*
 \]
 is an isomorphism of groups.
 Moreover, for every quasicharacter sheaf $\qcs{L}$ on $G$, $\Aut(\qcs{L}) = 1$
 and every $\rho \in \Hom(\qcs{L},\qcs{L}')$ is either trivial or an isomorphism.
 \end{proposition}

\begin{proof}
In Lemma~\ref{lem:bounded_connected} we saw that every quasicharacter sheaf $\qcs{L}$ on $G$ descends to bounded quasicharacter sheaf $\qcs{E}$ on $G$. Since the functor $B_G : \bQC(G) \to \QC(G)$ is full and faithful, $\Aut(\qcs{L}) = \Aut(\qcs{E})$.
From here, Deligne's function--sheaf dictionary for connected commutative algebraic groups over finite fields \citelist{\cite{deligne:SGA4.5}*{Sommes trig.}, \cite{laumon:87a}*{1.1.3}}  gives us all we need, as we briefly recall.
The key observation is that, by etale descent, pull-back by the Lang isogeny $\Lang : G\to G$ defines an equivalence of categories from $\bQC(G)$ to the category of $1$-dimensional $\ell$-adic representations $V$ of $G(\Fq)$ equipped with an isomorphism $V \to V\otimes V$ such that the trace of $\Lang^*\qcs{E}$ is $\trFrob{\qcs{E}}^{-1}$ for every bounded quasicharacter sheaf $\qcs{E}$ on $G$. 
Note that since $V$ is $1$-dimensional, the choice of $V \to V\otimes V$ is exactly the choice of an isomorphism $V\iso \EE$.
Using the equivalence given by $\Lang^*$, if $\Lang^*\qcs{E} = V$ with character $\psi$ and isomorphism $V\to V\otimes V$ then 
$\qcs{E} \iso (\Lang_* V)_\psi$, the $\psi$-isotypic component of the push-forward $\Lang_* V$ of the constand sheaf $V$ on $G$, equipped with an isomorphism $\mu_\qcs{E} : m^* \qcs{E} \to \qcs{E} \boxtimes\qcs{E}$ determined by $V\to V\otimes V$.
Moreover, $\Aut(\qcs{E})$ is the group of automorphisms of $\rho : V\to V$ for which 
\[
\begin{tikzcd}
\arrow{d}{} V \arrow{r}{\rho} & V\arrow{d}{}\\
V\otimes V \arrow{r}{\rho\otimes \rho} & V\otimes V
\end{tikzcd}
\]
commutes. 
Since the only such isomorphism $\rho$ is $\id_V$, it follows that $\Aut(\qcs{E}) = 1$, completing the proof.
For the last part of the proposition, argue as in the analogous part of Proposition~\ref{prop:mor_etale}.
\end{proof}


We have just seen that, for a connected commutative algebraic group $G$ over $\Fq$, the category of quasicharacters $\qcs{L}$ on $G$ is equivalent to the category of characters $\psi$ of $G(\Fq)$.
We have also just seen if the character of $\Lang^*\qcs{L}$ is $\psi$ then the canonical isomorphism $m^*\psi \iso \psi \boxtimes \psi$ determines the isomorphism $\mu : \qcs{L} \to \qcs{L}\boxtimes\qcs{L}$ which is part of the data of the quasicharacter sheaf $\qcs{L}$. That leads to a perspective on the function--sheaf dictionary common in the literature in which one considers $1$-dimensional local systems $\qcs{L}$ on $G$ for which \emph{there exists} an isomorphism $m^*\qcs{L} \iso \qcs{L} \boxtimes\qcs{L}$ \cite{kamgarpour:09a}*{Introduction}, or sometimes, $1$-dimensional local systems $\gqcs{L}$ on $\bG$ for which \emph{there exists} an isomorphism $\Frob{G}^*\gqcs{L} \iso \gqcs{L}$ and an isomorphism $\bm^*\gqcs{L} \iso \gqcs{L} \boxtimes\gqcs{L}$.

%In the introduction to this paper we noted that, when working with connected commutative algebraic groups over finite fields, Deligne's dictionary can be described using Weil sheaves $\qcs{L}$ for which there exists an isomorphism $m^* \qcs{L} \iso \qcs{L} \boxtimes\qcs{L}$, without keeping track of the isomorphism.

Although the category of quasicharacter sheaves on commutative smooth group schemes $G$ over finite fields does specialize to that common notion when $G$ is connected and of finite type, that notion is not appropriate if one wishes to extend the dictionary to commutative smooth group schemes over finite fields. 
In particular, as we have already seen in Section~\ref{sec:etale}, for a given quasicharacter sheaf $\qcs{L} = (\gqcs{L},\mu,\phi)$ there may be a different isomorphism $\mu' : \bm^*\gqcs{L} \to \gqcs{L}\boxtimes\gqcs{L}$ for which $\qcs{L}'=(\gqcs{L},\mu',\phi)$ is also a quasicharacter sheaf on $G$, not isomorphic to $\qcs{L}$. 
Indeed, Proposition~\ref{prop:etale-iso} shows that $\Hh^0(\Weil{},\Hh^2(\bG,\EEx))$ measures the possibilities for such $\mu'$ when $G$ is etale.
We will see later in this section that, for any smooth commutative group scheme $G$, the possibilities for such $\mu'$ are measured by $\Hh^0(\Weil{},\Hh^2(\pi_0(\bG),\EEx))$.

\subsection{Finite quasicharacter sheaves}

In this section we return to the case when $G$ is any smooth commutative group scheme over $\Fq$ and describe a class of quasicharacter sheaves on $G$ that will play a role in Section~\ref{sec:restriction}.

A finite, etale, surjective morphism $H\to G$ of smooth group schemes over $\Fq$ for which the action of $\Gal(\bFq/\Fq)$ on the kernel is trivial is called a {\it discrete isogeny}.

\begin{proposition}\label{prop:finite}
Let $f: H \to G$ be a discrete isogeny; let $A$ be the kernel of $f$.
Let $\psi : A \to \EEx$ be a character.
Then $(f_* \EE)_\psi$ (the $\psi$-isotypic component of $f_*\EE$) is a bounded quasicharacter on $G$.
\end{proposition}

\begin{proof}
Let $f$, $A$ and $\psi$ be as above; set $\qcs{E} = (f_! \EE)_\psi$.
It is clear that $\qcs{E}$ is an $\ell$-adic local system on $G$ of rank one.
We must show that comes equipped with an isomorphism $\mu_\qcs{E} : m^* \qcs{E} \to \qcs{E}\boxtimes\qcs{E}$.
To do this we may use etale descent exactly as in the proof of Proposition~\ref{prop:connected}. 
Pull-back along $f$ gives an equivalence between $\ell$-adic local systems on $G$ and $A$-equivariant local systems on $H$. 
In particular, $f^*\qcs{E}$ is the $A$-equivariant constant sheaf $\EE$ on $H$ with character $\psi$.
Since $f$ is a morphism of group schemes, the functor $f^*$ defines $\mu_\qcs{E} : m^*\qcs{E} \to \qcs{E}\boxtimes\qcs{E}$ from the canonical isomorphism $m^*\psi \iso \psi \boxtimes\psi$.
\end{proof}

\subsection{Restriction to the identity component} \label{sec:restriction}

Consider the short exact sequence
defining the component group scheme for $G$:
\begin{equation}\label{eq:pi0}
\begin{tikzcd}
0 \rar & G^0 \arrow{r}{\iota_0} & G \arrow{r}{\pi_0} & \pi_0(G) \rar & 0.
\end{tikzcd}
\end{equation}
Since $\pi_0(G)$ is a etale commutative group scheme, and this smooth,
Proposition~\ref{prop:pullback} implies that \eqref{eq:pi0} defines the sequence of functors
\begin{equation}\label{eq:pi1}
\begin{tikzcd}
\QC(0) \rar & \QC(\pi_0(G)) \arrow{r}{\pi_0^*} & \QC(G) \arrow{r}{\iota_0^*} & \QC(G^0) \rar & \QC(0)
\end{tikzcd}
\end{equation}
and therefore, after passing to isomorphism classes, the sequence of abelian groups
\begin{equation}\label{eq:pi2}
\begin{tikzcd}
0 \rar &
\QCiso{\pi_0(G)} \arrow{r}{\pi_0^*} & \QCiso{G} \arrow{r}{\iota_0^*} & \QCiso{G^0} \rar & 0.
\end{tikzcd}
\end{equation}
 Note that we found the groups $\QCiso{G^0}$
and $\QCiso{\pi_0(G)}$
in Sections~\ref{sec:connected} and \ref{sec:etale}, respectively.
In this section we show that \eqref{eq:pi2} is right exact.

We say that a morphism $f : H\to G$ of commutative group $\Fq$-schemes is a discrete isogeny if it is a finite, surjective \'etale morphism and
the action of $\Gal(\bFq/\Fq)$ on the \'etale group scheme $\ker f$ is trivial.

\begin{lemma}\label{lemma:ext}
Every discrete isogeny onto $G^0$ extends to a discrete
isogeny onto $G$ inducing an isomorphism on component groups.
\end{lemma}

\begin{proof}
Let $\pi: B \to G^0$ be a discrete isogeny and set $A \ceq \ker \pi$.
  We will find a discrete isogeny $f: H\to G$
  such that that $H^0 = B$, $f^0 =\pi$ and
  $\pi_0(f) : \pi_0(H)\to \pi_0(G)$ is an isomorphism of component
  groups.  Namely, we will fit $\pi$ into the following diagram,
  \begin{equation}\label{extension-diagram}
  \begin{tikzcd}
  A \arrow[equal]{r} \dar & A \dar \\
  B \rar \dar[swap]{\pi} & H \rar \dar[swap]{f} & \pi_0(H) \arrow{d}[below,rotate=90]{\sim}[swap]{\pi_0(f)} \\
  G^0 \rar & G \rar & \pi_0(G),
  \end{tikzcd}
  \end{equation}
  where all rows and columns are exact and all maps are defined over
  $\Fq$.  We will do so by passing back and forth between group
  schemes over $\Fq$ and their $\bFq$-points.

  Extensions of $G^0(\bFq)$ by $A(\bFq)$, such as $B(\bFq)$,
  correspond to classes in $\Ext^1_{\ZZ[\Weil{}]}(G^0(\bFq), A(\bFq))$.
  Similarly, extensions of $G(\bFq)$ by $A(\bFq)$ correspond to
  classes in $\Ext^1_{\ZZ[\Weil{}]}(G(\bFq), A(\bFq))$.  The map
  $G^0(\bFq) \to G(\bFq)$ induces the map
  \[
  \Ext^1_{\ZZ[\Weil{}]}(G(\bFq), A(\bFq)) \to \Ext^1_{\ZZ[\Weil{}]}(G^0(\bFq), A(\bFq))
  \]
  fitting into the long exact sequence derived from applying
  the functor $\Hom(\mbox{---}, A(\bFq))$ to $G^0(\bFq) \to G(\bFq) \to \pi_0(G)(\bFq)$:
  \[
  \Ext^1_{\ZZ[\Weil{}]}(G(\bFq), A(\bFq)) \to \Ext^1_{\ZZ[\Weil{}]}(G^0(\bFq), A(\bFq)) \to \Ext^2_{\ZZ[\Weil{}]}(\pi_0(G)(\bFq), A(\bFq)).
  \]
  Since $\Weil{} \cong \ZZ$ has cohomological dimension $1$ \cite{brown:CohomologyGrps}*{Ex. 4.3},
  $\Ext^2_{\ZZ[\Weil{}]}(\pi_0(G)(\bFq), A(\bFq))$ vanishes \cite{cartan-eilenberg:HomologicalAlgebra}*{Thm. 2.6}.

  We therefore have the existence of diagram \eqref{extension-diagram}
  at the level of $\bFq$-points.  This expresses $H(\bFq)$ as a
  disjoint union of translates of $B(\bFq)$; by transport of structure
  we may take $H$ to be a group scheme over $\bFq$.  Similarly, the
  restriction of $f$ to each component of $H$ is a morphism of
  schemes, and thus $f$ is as well.  Finally, the whole diagram
  descends to a diagram of $\Fq$-schemes since the $\bFq$-points of
  the objects come equipped with continuous $\Gamma$-actions and the
  morphisms are $\Gamma$-equivariant.
\end{proof}

In order to use the results of Section~\ref{sec:connected}, we need to know that
identity component of $G$ is actually an algebraic group.

\begin{lemma} \label{lem:G0alg-grp}
If $G$ is a commutative smooth group scheme over $\Fq$ then $G^0$ is a connected algebraic group.
\end{lemma}
\begin{proof}
 Since $G$ is a smooth group scheme over $\Fq$, its
 identity component $G^0$ of $G$ is a connected smooth,
 group scheme of finite type over $\Fq$, reduced over some finite extension of $\Fq$
 \cite{vdGeer-Moonen:AbelianVarieties}*{3.17}.
 Since $\Fq$ is a finite field and hence perfect, $G^0$ is actually reduced over $\Fq$
 \cite{EGAIV2}*{Prop 6.4.1}.  Since every group scheme over a field is separated
 \cite{vdGeer-Moonen:AbelianVarieties}*{3.12},
 it follows that $G^0$ is a connected algebraic group.
\end{proof}

\begin{proposition}\label{prop:restriction}
%For every quasicharacter sheaf $\qcs{L}^0$ on $G^0$ there is some finite quasicharacter sheaf
%$\qcs{L}$ on $G$ such that $\qcs{L}\vert_{G^0} \iso \qcs{L}^0$.
%As a consequence, t
The restriction functor $\iota_0^* : \QC(G)\to \QC(G^0)$ is essentially surjective.
\end{proposition}

\begin{proof}
  By Lemma~\ref{lem:G0alg-grp} and Proposition~\ref{prop:connected}, every
  quasicharacter sheaf on $G^0$ is isomorphic to $(\pi_! \EE)\psi$ for some discrete isogeny $\pi : B \to G^0$ and character $\psi : \ker \pi \to \EEx$.
  So to prove the proposition it suffices to show that $(\pi_! \EE)\psi$ extends to a quasicharacter sheaf on $G$.
%
 %Let $(\pi,\psi)$ be a finite quasicharacter sheaf on $G^0$.
 By Lemma~\ref{lemma:ext}, there is an extension of the
 discrete isogeny $\pi : B \to G^0$ to a discrete isogeny $f : H \to G$
 such that $\pi_0(f) : \pi_0(H)\to \pi_0(G)$ is an isomorphism.
 Then $(f_! \EE)\psi$ is a quasicharacter sheaf on $G$ and
 $(f_! \EE)\psi\vert_{G^0} \iso (\pi_! \EE)\psi$.
\end{proof}

\subsection{The component group sequence} \label{sec:component}

\begin{lemma}\label{lem:extension}
The group homomorphism $\pi_0^*: \QCiso{\pi_0(G)} \to \QCiso{G}$ is injective.
\end{lemma}
\begin{proof}
Let $\qcs{L}$ be a quasicharacter sheaf on $\pi_0(G)$ and let $\rho : \pi_0^*\qcs{L} \to (\EE)_{G}$ be an isomorphism in $\QC(G)$. For each $x\in \pi_0(\bG)$, the restriction $\pi_0^*\gqcs{L}\vert_{\bG^x}$ is the constant sheaf $(\gqcs{L}_x)_{\bG^x}$ so the isomorphism $\rho_{\bG^x} : (\gqcs{L}_x)_{\bG^x} \to (\EE)_{\bG^x}$ determines an isomorphism $\rho_x : \gqcs{L}_x \to (\EE)_x$. The collection $\{ \rho_x \tq x\in \pi_0(\bG) \}$ determines an isomorphism $\qcs{L} \to (\EE)_{\pi_0(G)}$  in $\QC(\pi_0(G))$.
\end{proof}


\begin{proposition}\label{prop:middleexact}
 The sequence
 \[
  \begin{tikzcd}
  0 \rar & \QCiso{\pi_0(G)} \arrow{r}{\pi_0^*} & \QCiso{G} \arrow{r}{\iota_0^*} & \QCiso{G^0} \rar & 0.
  \end{tikzcd}
 \]
 is exact.
\end{proposition}

\begin{proof}
The sequence is exact at $\QCiso{G^0}$ by Proposition~\ref{prop:restriction}
and exact at $\QCiso{\pi_0(G)}$ by Lemma~\ref{lem:extension}.
Here we show that it is also exact at $\QCiso{G}$.
First note that $\iota_0^* \circ \pi_0^*$ is trivial by Proposition~\ref{prop:pullback}.
So it suffices to show that if $\qcs{L} = (\gqcs{L},\mu,\phi)$ is a quasicharacter sheaf on $G$
with $\qcs{L}\vert_{G^0} = (\EE)_{G^0}$ then $\qcs{L}$ is in the essential image of $\pi_0^*$.

For each $x\in \pi_0(\bG)$, set $\bG^x \ceq \pi_0^{-1}(x)$.
Let $g, g'$ be geometric points in the same
geometric connected component $\bG^x$.
Set $a = g^{-1}g'$ and note that $a$ is a geometric point in $\bG^0$.
Let $\mu_{g,a} : \gqcs{L}_{ga} \to \gqcs{L}_g \otimes \gqcs{L}_a$
be the isomorphism of vector spaces obtained by restriction of
$\mu : m^*\gqcs{L} \to \gqcs{L} \boxtimes \gqcs{L}$ to the
geometric point $(g,a)$ on $\bG^x \times \bG^0$.
Since $\qcs{L}\vert_{G^0} = (\EE)_{G^0}$,
the stalk of $\gqcs{L}$ at $a$ is $\EE$.
In this way the pair of geometric points $g, g' \in \bG^x$
determines an isomorphism $\varphi_{g,g'} \ceq \mu_{g,a}^{-1}$
from $\gqcs{L}_{g}$ to $\gqcs{L}_{g'}$.

The isomorphisms $\varphi_{g,g'}: \gqcs{L}_{g} \to \gqcs{L}_{g'}$ are canonical
in the following sense: if $g,g'\in \bG^x$ and $h,h'\in \bG^y$
then it follows from \ref{QC.2} and \ref{QC.3}
that
 \begin{equation}\label{eq:qc}
  \begin{tikzcd}[column sep=55]
   \gqcs{L}_{gh} \arrow{r}{\varphi_{gh,g'h'}} \arrow[swap]{d}{\mu_{g,h}}
  & \gqcs{L}_{g'h'} \arrow{d}{\mu_{g',h'}}
  &\arrow[draw=none]{d}[pos=.4,description]{\text{\normalsize{and}}}
  &  \gqcs{L}_{\Frob{}(g)} \arrow{r}{\varphi_{\Frob{}(g),\Frob{}(g')}} \arrow[swap]{d}{\phi_{g}} & \gqcs{L}_{\Frob{}(g')} \arrow{d}{\phi_{g'}} \\
  \gqcs{L}_{g} \otimes \gqcs{L}_{h} \arrow{r}{\varphi_{g,g'}\otimes \varphi_{h,h'}}
  & \gqcs{L}_{g'} \otimes \gqcs{L}_{h'}
  & {}
  & \gqcs{L}_{g} \arrow{r}{\varphi_{g,g'}} & \gqcs{L}_{g'}
  \end{tikzcd}
 \end{equation}
both commute.

For each $x\in \pi_0(\bG)$, pick $g(x)\in \bG^x$
and set $\gqcs{E}_x \ceq \gqcs{L}_{g(x)}$.
Let $\phi_x : \gqcs{E}_{\Frob{}(x)} \to \gqcs{E}_x$
be the isomorphism of $\EE$-vector spaces obtained by composing
$\varphi_{g(\Frob{}(x)),\Frob{}(g(x))} : \gqcs{L}_{g(\Frob{}(x))} \to \gqcs{L}_{\Frob{}(g(x))}$
with $\phi_{g(x)} : \gqcs{L}_{\Frob{}(g(x))} \to \gqcs{L}_{g(x)}$.
For each pair $x,y\in \pi_0(\bG)$
let $\mu_{x,y} : \gqcs{E}_{x+y}\to \gqcs{E}_x\otimes \gqcs{E}_y$
be the isomorphism of $\EE$-vector spaces obtained by composing
$\varphi_{g(x+y),g(x)g(y)} : \gqcs{L}_{g(x+y)} \to \gqcs{L}_{g(x)g(y)}$
with $\mu_{g(x),g(y)} : \gqcs{L}_{g(x)g(y)} \to \gqcs{L}_{g(x)}\otimes \gqcs{L}_{g(y)}$.
Using \eqref{eq:qc}, it follows that \ref{qc.1}, \ref{qc.2} and \ref{qc.3} are satisfied for
$\qcs{E} \ceq (\gqcs{E}_x, \mu_{x,y}, \phi_x)$, thus defining a quasicharacter sheaf on $\pi_0(G)$.

The pullback $\pi_0^*(\qcs{E})$ of $\qcs{E}$ along $\pi_0 : G \to \pi_0(G)$ is constant
on geometric connected components, with stalks given by
$(\pi_0^* \qcs{E})_g = \qcs{E}_{x}$ for all $g\in \bG^x$.  Thus both $\pi_0^*\qcs{E}$ and $\qcs{L}$
are constant on geometric connected components of $G$.
The choices above define isomorphisms
$\gqcs{L}\vert_{\bG^x} \to  (\gqcs{E}_{x})_{\bG^x}$ for each $x\in \pi_0(\bG)$.
The resulting isomorphism $\gqcs{L} \to \pi_0^* \gqcs{E}$ satisfies \ref{QC.4},
thus defining an isomorphism $\qcs{L} \to \pi_0^* \qcs{E}$ in $\QC(G)$.
\end{proof}

\subsection{The function--sheaf dictionary for smooth, commutative group schemes}
\label{sec:snake}

We saw in Proposition~\ref{prop:functorialG} that Trace of Frobenius
$\TrFrob{G} : \QCiso{G} \to G(\Fq)^*$ is a functorial group homomorphism.
In this section we improve that result.

\begin{theorem}\label{thm:snake}
  If $G$ is a smooth, commutative group scheme over $\Fq$ then
  \[
  \TrFrob{G} : \QCiso{G} \to G(\Fq)^*
  \]
is surjective with kernel isomorphic to $\Hh^0(\Weil{},\Hh^2(\pi_0({\bar G}),\EEx))$.
\end{theorem}

\begin{proof}
  Recall the short exact sequence \eqref{eq:pi0}
  defining the component group scheme for $G$:
  \[
  \begin{tikzcd}
    1 \rar & G^0 \rar & G \rar & \pi_0(G) \rar & 0.
  \end{tikzcd}
  \]
  Let
  \[
  \begin{tikzcd}[row sep=20]
    0 \rar & \ker \TrFrob{\pi_0(G)} \arrow[dashed]{r} \dar & \arrow{d} \ker \TrFrob{G} \arrow[dashed]{r} & \ker \TrFrob{G^0} =0 \arrow[dotted, out=-10, in=170]{dddll} \dar & \\
    0 \rar & \QCiso{\pi_0(G)} \rar \dar{\TrFrob{\pi_0(G)}}
    & \QCiso{G} \rar \dar{\TrFrob{G}} & \QCiso{G^0} \rar \dar{\TrFrob{G^0}} & 0\\
    0 \rar & \pi_0(G)(\Fq)^* \rar \dar
    & \arrow{d} G(\Fq)^* \rar & G^0(\Fq)^* \rar \dar & 0\\
    & \coker \TrFrob{\pi_0(G)} =0 \arrow[dashed]{r} & \coker \TrFrob{G} \arrow[dashed]{r} &  \coker \TrFrob{G^0} =0 &
  \end{tikzcd}
  \]
  be the commutative diagram of abelian groups obtained by applying
  Proposition~\ref{prop:pullback} to \eqref{eq:pi0}.
 %
  The sequence of abelian groups
  \begin{equation}\label{eq:pi0k}
  \begin{tikzcd}
    1 \rar & G^0(\Fq) \rar & G(\Fq) \rar & \pi_0(G)(\Fq) \rar & 0,
  \end{tikzcd}
  \end{equation}
  is exact since $\Hh^1(\Fq,G^0) =0$ by Lemma~\ref{lem:G0alg-grp} and Lang's theorem on connected algebraic groups over finite fields \cite{lang:56a}.
  Since $\EEx$ is divisible, $\Hom_\text{Ab}(\ - \ ,\EEx)$ is exact and thus the dual sequence of
  character groups is also exact.
%
  The upper row is exact by Proposition~\ref{prop:middleexact}.
  Now Lemma~\ref{lem:G0alg-grp} and Proposition~\ref{prop:connected}
  imply that $\ker \TrFrob{G^0} =0$ and $\coker \TrFrob{G^0}=0$,
  while Proposition~\ref{prop:etale-iso} gives $\ker \TrFrob{\pi_0(G)} \iso \Hh^0(\Weil{},\Hh^2(\pi_0({\bar G}),\EEx))$
  and $\coker \TrFrob{\pi_0(G)}=0$.
%
It follows from the snake lemma that $\coker \TrFrob{G} =0$
and $\ker \TrFrob{\pi_0(G)} \to \ker \TrFrob{G}$ is an isomorphism.
\end{proof}

\subsection{Morphisms of quasicharacters}

\begin{theorem}\label{thm:hom}
Let $G$ be a smooth, commutative group scheme over $\Fq$.
For all quasicharacter sheaves $\qcs{L}$ and $\qcs{L}'$ on $G$,
every $\rho \in \Hom(\qcs{L},\qcs{L}')$ is either trivial or an isomorphism.
Moreover, $\Aut(\qcs{L}) \iso \Hom(\pi_0(\bG)_{\Weil{}},\EEx)$, canonically.
\end{theorem}
\begin{proof} 
For the first part of the proposition, argue as in the analogous part of Proposition~\ref{prop:mor_etale}.
For the second, fix $\qcs{L} = (\gqcs{L},\mu,\phi)$ and consider the homomorphism $\Aut(\qcs{L}) \to \Hom(\bG_{\Weil{}},\EEx)$ defined in Proposition~\ref{prop:mor_etale}.
This group homomorphism is clearly injective: if $\rho_x = \id_{\qcs{L}_x}$ for every $x\in \bG$ then $\rho = \id_{\qcs{L}}$.
Note that the image of $\Aut(\qcs{L}) \to \Hom(\bG_{\Weil{}},\EEx)$ is contained in $\Hom_\text{cts}(\bG_{\Weil{}},\EEx)$, where $\bG_{\Weil{}}$ is given the topology of the base of the espace tal attached to $\gqcs{L}$.
Since $\ell$ is invertible in $\Fq$, it follows that $\Hom_\text{cts}(\bG_{\Weil{}},\EEx) = \Hom(\pi_0(\bG_{\Weil{}}),\EEx)$. 
Note that $\pi_0(\bG_{\Weil{}})=\pi_0(\bG)_{\Weil{}}$. 
To see that $\Aut(\qcs{L}) \to \Hom(\pi_0(\bG)_{\Weil{}},\EEx)$ is surjective, begin with $\theta\in\Hom(\pi_0(\bG)_{\Weil{}},\EEx)$ and, for each $[x] \in \pi_0(\bG)_{\Weil{}}$ define $\bar\rho_y: \gqcs{L}_y \to \gqcs{L}_y$ by scalar multiplication by $\theta([x])\in \EEx$ for each $y\in [x]$.
This defines an isomorphism $\bar\rho : \gqcs{L}\to \gqcs{L}$ of local systems on $\bG$ compatible with $\mu$ and $\phi$, and thus an isomorphism $\rho :\qcs{L}\to \qcs{L}$ with maps to $\theta$ under $\Aut(\qcs{L}) \to \Hom(\pi_0(\bG)_{\Weil{}},\EEx)$.
\end{proof}




\section{Application to \texorpdfstring{$p$}{p}-adic tori}

On general smooth group $\Fq$-schemes $G$, 
there are bounded quasicharacter sheaves which are not finite.  
Identifying $\fQC(G)$ with its image under $B_G \circ L_G$, as defined in
Proposition~\ref{prop:BG} and in the proof of Proposition~\ref{prop:bounded},
we will see in Corollary~\ref{cor:bounded-and-finite} that
a quasicharacter sheaf is finite if and only if its Trace of Frobenius has finite image.

\begin{corollary} \label{cor:bounded-and-finite}
Let $G$ be a smooth commutative group scheme over $\Fq$.
\begin{enumerate}
\item $\qcs{L} \in \QC(G)$ is bounded if and only if $\trFrob{\qcs{L}}$ has bounded image,
\item $\qcs{L}\in \QC(G)$ is finite if and only if $\trFrob{\qcs{L}}$ has finite image.
\end{enumerate}
\end{corollary}

\begin{proof}
We first reduce to the case that $G$ is etale.
On the connected component
$G^0$, all quasicharacter sheaves are bounded and finite by Proposition~\ref{prop:connected}.
On the other hand, $G^0(\Fq)$ is finite by Lemma~\ref{lem:G0alg-grp} and thus Trace of Frobenius
has finite and therefore bounded image.  If $\chi \in G(\Fq)^*$ then there is some finite-image character $\chi_0$
with the same restriction to $G^0(\Fq)$ since $G^0(\Fq)$ is lies inside the torsion part of
the finitely generated abelian group $G(\Fq)$.  Therefore $\chi$ is bounded (resp. has finite image)
if and only if $\chi \cdot \chi_0^{-1}$ is bounded (resp. has finite image).  But $\chi \cdot \chi_0^{-1}$ descends
to a character of $\pi_0(G)$.  A similar argument relates boundedness/finiteness of quasicharacter
sheaves on $G$ to those on $\pi_0(G)$, using the fact that the preimage constructed in the proof of
Proposition~\ref{prop:restriction} is a finite quasicharacter sheaf on $G$.
Using these equivalences, it is enough to prove Corollary~\ref{cor:bounded-and-finite} when $G$ is etale.

In the case that $G$ is \'etale, which we now suppose,
one can easily detect when a quasicharacter sheaf is bounded or finite.
With reference to Section~\ref{sec:S},
let $S_G(\qcs{L}) = [\alpha \oplus \beta]$
and let $b : {\bar G}\to \EEx$ be the multiplicative version of $\beta(\Frob{})$.
Then $\qcs{L}$ is finite if and only if
$b(x)$ is a root of unity for all $x\in {\bar G}$.
By \cite{beilinson-bernstein-deligne:81a}*{Rem. 5.2.1},
$\qcs{L}$ is bounded if and only if $b(x) \in \Zlx$ for all $x\in {\bar G}$.
\end{proof}

With Corollary~\ref{cor:bounded-and-finite} in hand
we see that all quasicharacter sheaves on $G$ are finite quasicharacter sheaves
when $G$ is a commutative algebraic group over $\Fq$;
observe that the component group $\pi_0({\bar G})$ is finite in this case.
On the other hand, Corollary~\ref{cor:bounded-and-finite} also shows us
why neither finite quasicharacter sheaves nor bounded quasicharacter sheaves
are up to the task of geometrizing all characters of $G(\Fq)$ for smooth commutative group schemes $G$ since, in general, neither of the full subcategories
$\fQC(G) \subset \bQC(G) \subset \QC(G)$ are equivalences.
For example, consider the case when $G$ is the discrete \'etale group scheme $\ZZ$:
the flabby quasicharacter sheaf on $G$ corresponding, under Theorem~\ref{thm:snake},
to the character $1 \mapsto \ell$ is not a bounded quasicharacter sheaf,
while the flabby quasicharacter sheaf on $G$ corresponding
to the character $1 \mapsto 1+ \ell$ is a bounded but not finite quasicharacter sheaf.
%In this latter case the stalk of the quasicharacter sheaf at the component $1$ is defined by a pro-\'etale cover rather than an \'etale cover.

\subsection{Base change}\label{sec:basechange}

When using quasicharacter sheaves to study characters, it is useful to understand
how quasicharacter sheaves behave under change of fields.
Let $k'$ be a finite extension of $k$. Then $k \hookrightarrow k'$ induces a group homomorphism
$i_{k'/k} : G(k) \hookrightarrow G(k')$ and thus a homomorphism
\begin{align*}
i_{k'/k}^* : G(k')^* &\to G(k)^* \\
\chi &\mapsto \chi\circ i_{k'/k}.
\end{align*}
We can interpret this operation on characters in terms of quasicharacter sheaves:

\begin{proposition} \label{prop:csbe}
Set $G_{k'} \ceq G\times_\Spec{k} \Spec{k'}$ and let
\[
\QC(\Res_{k'/k}(G_{k'})) \xrightarrow{\iota^*} \QC(G)
\]
be the functor obtained by pullback along the canonical closed immersion of $k$-schemes
$\iota : G \hookrightarrow \Res_{k'/k}(G_{k'})$
\cite{bosch-lutkebohmert-reynaud:NeronModels}*{\S 7.6}.
The following diagram commutes:
\[
\begin{tikzcd}
\QCiso{\Res_{k'/k}(G_{k'})} \arrow[two heads]{r}{\iota^*} \dar[swap]{\TrFrob{\Res_{k'/k}(G_{k'})}} & \QCiso{G} \dar{\TrFrob{G}} \\
G(k')^* \arrow[two heads]{r}{i_{k'/k}^*} & G(k)^*.
\end{tikzcd}
\]
\end{proposition}
\begin{proof}
This result follows immediately from Proposition~\ref{prop:pullback} together with the identifications
\[
\Res_{k'/k}(G_{k'})(k) \cong G_{k'}(k') \cong G(k')
\]
from the definitions of Weil restriction and base change.
\end{proof}

In the opposite direction, let $\Nm : G(k') \to G(k)$ be the norm map and consider the group homomorphism:
\begin{align*}
\Nm^* : G(k)^* &\to G(k')^* \\
\chi &\mapsto \chi\circ \Nm.
\end{align*}
We can also interpret this operation on characters in terms of quasicharacter sheaves.

If $\qcs{L} \ceq (\gqcs{L}, \mu, \phi)$ is a quasicharacter sheaf on $G$, we define
a quasicharacter sheaf $\qcs{L}' \ceq (\gqcs{L}, \mu, \phi_{k'})$ on the base change
$G_{k'}$ of $G$ to $k'$ by setting
\[
\phi_{k'} \ceq \phi \circ \Frob{G}^*(\phi) \circ \cdots \circ (\Frob{G}^{n-1})^*(\phi).
\]
The commutativity of the diagram (QC.3) for $\phi_{k'}$
follows from the fact that $\Frob{G_{k'}} = \Frob{G}^n$.
Note that we may also think about the construction of $\phi_{k'}$ from $\phi$
as taking the action $\varphi$ of $\Weil{k}$ on $\gqcs{L}$
defined in Section~\ref{sec:category} and restricting it to the subgroup $\Weil{k'}$.

\begin{proposition}\label{prop:basechange}
With notation above,
the rule $\nu_{k'/k}: (\gqcs{L}, \mu, \phi) \mapsto (\gqcs{L}, \mu, \phi_{k'})$
 defines a monoidal functor $\QC(G) \to \QC(G_{k'})$.
 Moreover, the following diagram commutes:
\[
\begin{tikzcd}[column sep=60]
\QCiso{G} \rar{\nu_{k'/k}} \dar{\TrFrob{G}} & \QCiso{G_{k'}} \dar{\TrFrob{G_{k'}}} \\
G(k)^*  \rar{\Nm^*} & G(k')^*.
\end{tikzcd}
\]
\end{proposition}

\begin{proof}
Let $\qcs{L} \ceq (\gqcs{L}, \mu, \phi) \in \QC(G)$ and write $F$ for $\Frob{G}$.  For any $x \in G(k')$,
we may compute the value of $t_{G_{k'}}(\nu_{k'/k}\qcs{L})(x)= t_{\nu_{k'/k}\qcs{L}}(x)$ as the trace of $\phi_{k'}$ on $\gqcs{L}_x$,
and the value of $\Nm^*(\TrFrob{G}(\qcs{L}))(x)$ as the trace of $\phi$ on $\gqcs{L}_{\Nm(x)}$.
Applying \ref{QC.3} to the stalk of $\gqcs{L}^{\boxtimes n}$ at the point $(x, \Frob{}(x), \ldots, \Frob{}^{n-1}(x))$ yields a diagram
\[
\begin{tikzcd}
\gqcs{L}_{\Nm(x)} \rar \dar{\phi_{\Nm(x)}} & \gqcs{L}_{F(x)} \otimes \gqcs{L}_{F^2(x)} \otimes \cdots \otimes \gqcs{L}_x
\dar{\phi_x \otimes (F^*\phi)_x \otimes \cdots \otimes ((F^{n-1})^*\phi)_x} \\
\gqcs{L}_{\Nm(x)} \rar & \gqcs{L}_x \otimes \gqcs{L}_{F(x)} \otimes \cdots \otimes \gqcs{L}_{F^{n-1}(x)}.
\end{tikzcd}
\]
Choose a basis vector $v$ for $\gqcs{L}_{\Nm(x)}$ and write the image of $v$ under the
bottom map as $v_0 \otimes v_1 \otimes \cdots \otimes v_{n-1}$
for $v_i \in \gqcs{L}_{\Frob{}^i(x)}$.  By \ref{QC.2}, $v$ maps to
$v_1 \otimes v_2 \otimes \cdots \otimes v_0$ along the top of the diagram.
Let $\alpha_i \in \EEx$ represent $((F^i)^*\phi)_x$ with respect to these bases and let $\alpha$ be
the trace of $\phi_{\Nm(x)}$.  We may now equate the trace $\alpha$ of $\phi$ on $\gqcs{L}_{\Nm(x)}$
with the product $\alpha_0 \cdots \alpha_{n-1}$, which is the trace of $\phi_{k'}$ on $\gqcs{L}_x$.
\end{proof}

Finally, let $G'$ be a smooth commutative group scheme over $k'$;
we explain how to geometrize the canonical isomorphism between characters of $G'(k')$ and of $(\Res_{k'/k}G')(k)$.
We may decompose the base change $(\Res_{k'/k}G')_{k'}$ of $\Res_{k'/k}G'$ to $k'$
into a product of copies of $G'$, indexed by elements of $\Gal(k'/k)$:
\[
(\Res_{k'/k}G')_{k'} \cong \prod_{\Gal(k'/k)} G'.
\]
Since products and coproducts agree for group schemes we have a natural inclusion of $k'$-schemes
\[
G' \hookrightarrow (\Res_{k'/k}G')_{k'}
\]
mapping $G'$ into the summand corresponding to $1 \in \Gal(k'/k)$.  Composing $\nu_{k'/k}$
from Proposition~\ref{prop:basechange} with pullback along this map yields a functor
\[
\rho : \QC(\Res_{k'/k}G') \to \QC(G').
\]

\begin{proposition}
Let $k'/k$ be a finite extension and let $G'$ be a smooth commutative group scheme over $k'$.
The following diagram of isomorphisms commutes, where the bottom map is the identity:
\[
\begin{tikzcd}
\QCiso{\Res_{k'/k} G'} \dar{\TrFrob{\Res_{k'/k} G'}} \rar{\rho} & \QCiso{G'} \dar{\TrFrob{G'}}\\
G'(k')^* \rar & G'(k')^*
\end{tikzcd}
\]
\end{proposition}
\begin{proof}
By Proposition~\ref{prop:pullback} the pullback part of the definition of $\rho$ corresponds to the map
\[
(\Res_{k'/k}G')(k') \to G'(k')^*
\]
induced by $g \mapsto (g, 1, \ldots, 1)$.  Since the action of $\Gal(k'/k)$ on
\[
(\Res_{k'/k}G')_{k'} \cong \prod_{\Gal(k'/k)} G'
\]
is given by permuting coordinates, composition with the norm map yields the identity on $G'(k')$.
\end{proof}

\todo{Can we improve on this result by proving that $\rho$
is an equivalence of categories?}

\bibliographystyle{amsalpha}
\bibliography{Biblio}

\end{document}

\begin{table}[ht]
\caption{A big diagram}
\begin{center}
{\smaller\smaller\smaller
    \[
  \begin{tikzcd}[row sep=20, column sep=3]
&   &  0 \arrow{dd} && 0 \arrow{dd} && 0\arrow{dd} & \\
& &&  0 \arrow[crossing over]{dd} && 0 \arrow[crossing over]{dd} && 0\arrow{dd} & & \\
&   {}& \ker \TrFrob{C} \arrow[->>]{rr} \arrow[>->>]{dr} \arrow{dd} && \arrow{dd} \ker \TrFrob{B} \arrow{rr} \arrow[>->]{dr}  && \ker \TrFrob{A}=0 \arrow[>->>]{dr} \arrow{dd} \arrow{rr} && 0 & \\
& && \Hh^0(\Weil{},\Hh^2(C,\EEx)) \arrow[crossing over,->>]{rr} \arrow[crossing over]{dd} && \Hh^0(\Weil{},\Hh^2(B,\EEx)) \arrow[crossing over]{rr} \arrow[crossing over]{dd} && \Hh^0(\Weil{},\Hh^2(A,\EEx)) \arrow[crossing over]{dd}  &  &  \\
0  \arrow{rr} & & \QCiso{C} \arrow[>->>]{dr}\arrow{rr} \arrow{dd}%{\TrFrob{C}}
    && \QCiso{B} \arrow[>->]{dr} \arrow{rr} \arrow{dd}%{\TrFrob{B}}
    && \QCiso{A} \arrow[>->>]{dr} \arrow{dd}%{\TrFrob{A}}
    \arrow{rr}  &   & 0 & \\
& \Hh^1(E^\bullet_{A}) \arrow[crossing over]{rr}  && \Hh^2(E^\bullet_{C}) \arrow[crossing over]{rr} \arrow[crossing over]{dd} && \Hh^2(E^\bullet_{B}) \arrow[crossing over]{rr} \arrow[crossing over]{dd} && \Hh^2(E^\bullet_{A}) \arrow{rr} \arrow[crossing over]{dd} &  & \Hh^3(E^\bullet_{C}) \\
0  \arrow{rr} & & C(\Fq)^* \arrow[>->>]{dr} \arrow{rr} \arrow{dd}
    && \arrow{dd} B(\Fq)^* \arrow[>->>]{dr} \arrow{rr} && A(\Fq)^* \arrow[>->>]{dr}  \arrow{dd}
    \arrow{rr}&& 0 & \\
& %\Hh^2(\Weil{},\Hh^1({\bar A},\EEx)) \arrow{rr}
 && \Hh^1(\Weil{},\Hh^1(C,\EEx)) \arrow[crossing over]{dd} \arrow[crossing over]{rr}  && \Hh^1(\Weil{},\Hh^1(B,\EEx)) \arrow[crossing over]{dd} \arrow[crossing over]{rr} && \Hh^1(\Weil{},\Hh^1(A,\EEx)) \arrow[crossing over]{dd}  &  & %\Hh^0(\Weil{},\Hh^1({\bar C},\EEx))
 \\
& & 0  && 0  &&  0  && & \\
 &      &&  0 && 0 && 0 & & \\
  \end{tikzcd}
  \]
}
\end{center}
\label{diagram}
\end{table}


\begin{proof}
Here are some pieces that might help . . .

Consider Diagram~\ref{diagram}, where $B=G$, $C= \pi_0(G)$ and $A=G^0$:
We have just seen that the back of this diagram commutes and its sequences are exact.
The front of this diagram also commutes and all its vertical sequences are also exact,
as we saw in Section~\ref{sec:spectral}.
Joining the back to the front are the injections from
Section~\ref{sec:spectral} making the entire diagram commute.
The vertical left face is an isomorphism of exact sequences by Proposition~\ref{prop:etale-iso}
and the vertical right face is an isomorphism of exact sequences by Proposition~\ref{prop:connected-iso}.
%
Note that these injections are isomorphisms at the bottom, by Lemma~\ref{lem:dual-inv}, and at the left, by Section~\ref{sec:etale}, and at the right, by Section~\ref{sec:connected} and the Five Lemma.
It now follows that $\ker T_B \to \Hh^0(\Weil{},\Hh^2(B,\EEx))$ is also an isomorphism,
completing the proof of Theorem~\ref{thm:snake}.
\end{proof}



\begin{corollary}\label{cor:exact}
  If $G$ is a smooth, commutative group scheme over
  $\Fq$ then pullback yields an exact sequence
\[
\Hh^1(E^\bullet_{G^0}) \to \QCiso{\pi_0(G)} \to \QCiso{G} \to \QCiso{G^0} \to 0
\]
of abelian groups.\todo{Pure speculation.}
\end{corollary}

\begin{proof}
Really? Then does this make sense: $\Hh^3(E^\bullet_{\pi_0(G)}) =0$? Perhaps. $\Hh^3(\pi_0({\bar G})\rtimes \Weil{},\EEx)=0?$
\end{proof}

\subsection{Finite quasicharacter sheaves}\label{sec:finite}

In this section we define \emph{finite quasicharacter sheaves}, 
a notion informed by a certain perspective on local systems on connected groups.
Finite quasicharacter sheaves will play a role in Section \ref{sec:restriction}.

%The definition of finite quasicharacter sheaves will require several steps, beginning with the localization of a category introduced here.
Consider the category $C(G)$ whose objects consist of triples $(f,\psi,r)$, where:
\begin{itemize}
\item $f : H\to G$ is a \emph{discrete isogeny} (a morphism of smooth commutative group schemes over $\Fq$ which is finite, surjective and \'etale and for which the action of $\Gal(\bFq/\Fq)$ on the \'etale group scheme $\ker f = f^{-1}({\bar e)} = \Aut(f)$ is trivial);
\item $\psi : \Aut(f)\to \Aut(V)$ is a finite-dimensional $\EE$-representation;
\item $r : V \to V\otimes V$ is an injective linear transformation.
\end{itemize}
A morphism $(f,\psi,r) \to (f',\psi',r)$ in $C(G)$ is a pair $(\gamma,T)$, where:
\begin{itemize}
\item $\gamma : H' \to H$ is a morphism of group schemes such that $f\circ \gamma = f'$;
\item $T: V\to V'$ is a linear transformation, equivariant for the action of
$\Aut(f')$ on $V'$ by $\psi'$ and the action of $\Aut(f')$ on $V$ by $\psi \circ \gamma$,
\end{itemize}
such that
\[
\begin{tikzcd}
\arrow{d}[swap]{T\otimes T} V\otimes V & \arrow{l}{r} V \arrow{d}{T} 
%& \Aut(V) & \arrow[swap]{l}{\psi} \Aut(f) \arrow{r} & H \arrow{r}{f} & \arrow[equal]{d} G
\\
V'\otimes V' & \arrow{l}{r'} V' 
%& \Aut(V') & \arrow[swap]{l}{\psi'} \arrow[swap]{u}{} \Aut(f') \arrow{r} & \arrow[swap]{u}{\gamma} H' \arrow{r}{f'} & G
\end{tikzcd}
\]
commutes.

We define a tensor product in $C(G)$ as follows.
Let $(f,\psi,r)$ and $(f',\psi',r')$ be objects in $C(G)$.
Write $f\times_G f' : H\times_G H' \to G$ for the product of $f$ and $f'$
in the category of isogenies to $G$. We define an external tensor product
$\psi \otimes\psi' :  \ker(f\times_G f') \to \Aut(V\otimes V')$ and a external sum
$\psi \oplus\psi' :  \ker(f\times_G f') \to \Aut(V\oplus V')$
using the canonical isomorphism $\ker(f\times_G f') \iso (\ker f)\times (\ker f')$.
We may thus define $(f,\psi,r)\otimes(f',\psi',r') \ceq (f\times_G f' ,\psi\otimes\psi', r\otimes r')$ and
$(f,\psi,r)\oplus(f',\psi',r')\ceq (f\times_G f' ,\psi\oplus\psi', r\oplus r')$. 
To define duals in $C(G)$,
let $V^\vee \ceq \Hom_\text{vec}(V,\EE)$ and $\psi^\vee : \ker f \to \Aut(V^\vee)$ be
the dual representation.  We may then set $(f,\psi,r)^\vee \ceq (f,\psi^\vee, r^\vee)$ 
where $r^\vee : V^\vee \to V^\vee \otimes V^\vee$ is the adjoint of $r$.
These operations give $C(G)$ the structure of a tensor category.

Now we localize $C(G)$.
Let us say that $(\gamma,T)$ in $C(G)$ is a \emph{weak isomorphism} if $T$ is an isomorphism of vector spaces.  
Let $W$ be the family of weak isomorphism and
et $C(G)[W^{-1}]$ be the localization of $C(G)$ with respect to $W$, 
in the sense of \cite{kashiwara-schapira:CatgoriesSheaves}*{Def 7.1.1}.
Since weak isomorphisms in $C(G)$ form a \emph{right multiplicative system}, in the sense of \cite{kashiwara-schapira:CatgoriesSheaves}*{Def 7.1.5}, it follows from \cite{kashiwara-schapira:CatgoriesSheaves}*{Thm 7.1.16} that morphisms in $C(G)[W^{-1}]$ are simple to describe: 
a morphism in $C(G)[W^{-1}]$ is an equivalence class of diagrams
\[
\begin{tikzcd}[column sep=30]
   (f,\psi,r) \arrow{r}{(\gamma,T)} & (f',\psi',r') & \arrow[swap]{l}{(\gamma_1,T_1)}[swap]{\text{w-iso}} (f_1,\psi_1,V_1)
   \end{tikzcd}
\]
 where $(\gamma,T) : (f,\psi,r) \to (f',\psi',r')$ is any map in $C(G)$
 and $(\gamma_1, T_1) :  (f',\psi',r') \to (f_1,\psi_1,r_1)$ is a weak isomorphism in $C(G)$;
for the equivalence relation on these diagrams, see \cite{kashiwara-schapira:CatgoriesSheaves}*{(7.1.3)}.

It is straightforward to verify that the subcategory $C_1(G)$ of $C(G)$ consisting of $(f,\psi,r)$ for which $\psi$ is one-dimensional, is a full, rigid monoidal subcategory of $C(G)$ and further, that the family $W_1$ of weak isomorphisms in $C_1(G)$ is a right multiplicative system.

\begin{definition}
The category of \emph{finite quasicharacter sheaves} of $G$, denoted by $\fQC(G)$,
is the rigid monoidal category $C_1(G)[W_1^{-1}]$ obtained by localizing $C_1(G)$ at weak isomorphisms $W_1$.
\end{definition}

\begin{remark}
Recall that every geometric point $\bg$ on a connected scheme $G$
determines an equivalence between the categories of $\ell$-adic local systems on $G$
and $\ell$-adic representations of the \'etale fundamental group $\pi_1(G, \bg)$
\citelist{\cite{SGA5}*{VI,Prop. 1.2.5} \cite{deligne:80a}*{1.1.1}}.
 Since $\pi_1(G, \bg)$ is a projective limit of automorphism groups of finite \'etale covers,
 a general local system corresponds to a projective limit of characters of such groups.
 But some local systems can be described in terms of a single cover $f: H \to G$
 and a representation $\psi: \ker f \to \Aut(V)$;
 two such descriptions yield isomorphic local systems if and only if they are related by a weak
 isomorphism in $C(G)$.  While the description of local systems in terms of $\pi_1(G, \bg)$ does
 not adapt well to non-connected $G$, a perspective using finite \'etale covers does.
\end{remark}

Later in the paper we will make a study of isomorphism classes of objects in $\fQC(G)$. Here we focus on morphisms in this category.

\begin{proposition}\label{prop:autornaught}
Every morphism in $\fQC(G)$ is either an isomorphism or trivial.
Moreover, for every finite quasicharacter sheaf $(f,\psi,r)$, the group $\Aut_{\fQC(G)}(f,\psi,r)$ is trivial.
\end{proposition}

\begin{proof}
\todo{This proof is under construction.}
Trivial morphisms in $\fQC(G)$ are defined as follows. Let $(f,\psi,r)$ and $(f_1,\psi_1,r_1)$ be finite quasicharacter sheaves on $G$.  
Form $(f\times_G f_1,1\otimes \psi_1, r\otimes r_1)$ in $C_1(G)$. 
Let $0 : V \to V\otimes V_1$ be the trivial linear transformation. 
Choose $0\ne v \in V$ and let $T_v: V_1 \to V\otimes V_1$ be the isomorphism $T_v(v_1) = v\otimes v_1$.  
Let $\pi : H\times_G H_1 \to H$ and $\pi_1 : H\times_G H_1 \to H_1$ be the natural projections.
Then $(\pi,0) : (f,\psi, V) \to  (f\times_G f_1,1\otimes \psi_1, V\otimes V_1)$ is a morphism in $C_1(G)$ and $(\pi_1,T_v) : (f_1,\psi_1,V_1) \to (f\times_G f_1,1\otimes \psi_1, V\otimes V_1)$ is a weak isomorphism in $C_1(G)$.
%
The morphism in $\fQC(G)$ represented by
\[
\begin{tikzcd}[column sep=30]
   (f,\psi,V) \arrow{r}{(\pi,0)} & (f\times_G f_1,1\otimes \psi_1, V\otimes V_1) & \arrow[swap]{l}{(\pi_1,T_v)}[swap]{\text{w-iso}}  (f_1,\psi_1,V_1),
   \end{tikzcd}
\]
does not depend on the choice of $0\ne v\in V$; this defines the {\em trivial morphism} $0: (f,\psi,V) \to (f_1,\psi_1,V_1)$ in $\fQC(G)$.

 
Let $(f,\psi,V)$ and $(f_1,\psi_1,V_1)$ be finite quasicharacter sheaves on $G$. 
Let
\[
\begin{tikzcd}[column sep=30]
   (f,\psi,V) \arrow{r}{(\gamma,T)} & (f',\psi',V') & \arrow[swap]{l}{(\gamma_1,T_1)}[swap]{\text{w-iso}}  (f_1,\psi_1,V_1)
   \end{tikzcd}
\]
represent a morphism $(f,\psi,V)  \to (f_1,\psi_1,V_1)$ in $\fQC(G)$;
note that, by definition, $(\gamma_1 , T_1) : (f_1,\psi_1,V_1) \to (f',\psi',V')$ is a weak isomorphism.
Since $V$, $V'$ and $V_1$ are one-dimensional $\EE$-vector spaces, either $T : V \to V'$ is an isomorphism or trivial.  

Suppose $T$ is trivial. 
Let $\theta : H'\to H\times_G H_1$ be the morphism of group schemes given by the universal property of the pull back of $f: H\to G$ and $f_1 : H_1 \to G$, as pictured below.
\[
\begin{tikzcd}
\ & \arrow{ddl}[swap]{\gamma} H' \arrow{d}{\theta} \arrow{ddr}{\gamma_1} & \\
\ & \arrow{dl}{\pi} H \times_G H_1 \arrow{dr}[swap]{\pi_1} & \\
H \arrow{rd}[swap]{f} && \arrow{ld}{f_1} H_1 \\
& G & \\
\end{tikzcd}
\]
Let $T_1' : V\otimes V_1 \to V'$ be the linear transformation defined by projection $V\otimes V_1 \to V_1$ followed by $T_1 : V_1 \to V'$. Then
\[
\begin{tikzcd}[column sep=30]
\ & (f',\psi',V')  & \\
\arrow{dr}[swap]{(\pi,0)}  (f,\psi,V)  \arrow{ru}{(\gamma,T=0)} &  & \arrow[swap]{lu}{(\gamma_1,T_1)}[swap]{\text{w-iso}} (f_1,\psi_1,V_1) \arrow{dl}{(\pi_1,T_v)}[swap]{\text{w-iso}} \\
\ & \arrow{uu}[swap]{(\theta,T_1')} (f\times_G f_1,1\otimes \psi_1, V\otimes V_1) & \\   
   \end{tikzcd}
\]
is a commuting diagram in $C_1(G)$, where $T_v : V_1 \to V\otimes V_1$ is defined as in the construction of the trivial morphism $0 : (f,\psi,V) \to (f_1,\psi_1,V_1)$, above.
By \cite{kashiwara-schapira:CatgoriesSheaves}*{Thm 7.1.16}, 
it follows that $(f,\psi,V)  \to (f_1,\psi_1,V_1)$ is the trivial morphism in $\fQC(G)$.

Now suppose $T$ is an isomorphism, then $(\gamma,T)$ is a weak isomorphism, in which case the morphism $(f,\psi,V) \to (f_1,\psi_1,V_1)$ is an isomorphism in $\fQC(G)$.
\todo{This is where some information about $\Aut_{\fQC(G)}(f,\psi,V)$ will go, when I've sorted it out.}
\end{proof}

\subsection{When quasicharacter sheaves are finite}

\begin{proposition}\label{prop:connected}
  If $G$ is a connected commutative algebraic group over $\Fq$ then
  the full subcategories $\fQC(G) \hookrightarrow \bQC(G) \hookrightarrow \QC(G)$
  appearing in Sections~\ref{sec:bounded} and \ref{sec:finite} are equivalences.
\end{proposition}

\begin{proof}
  Observe that the forgetful functor $(\gqcs{L},\mu,\phi) \mapsto (\gqcs{L},\phi)$
  sends quasicharacter sheaves on $G$ to $\ell$-adic Weil sheaves on $G$ \cite{deligne:80a}*{1.1.10}.
  While is it not true that all Weil sheaves on $G$ descend to local systems on $G$,
  we will see that those that appear in the image of this forgetful functor from quasicharacter sheaves do.

%When $G$ is connected, we may apply the classic function--sheaf dictionary.  
%In order to do so, however, we must relate our notion of quasicharacter sheaf to the sheaf side of the standard dictionary.
Choose any $\Fq$-rational point of $G$ and let $\bg$ be the geometric point on $G$ lying above $g$.
Recall that the \emph{Weil group} of $G$, which we will denote by $\W(G,\bg)$, is a subgroup of the \'etale
fundamental group defined by the following diagram:
\[
 \begin{tikzcd}
 1 \rar & \ar[equal]{d} \pi_1(\bG, \bg) \rar & \W(G,\bg) \rar \dar[hook] & \Weil{} \rar \dar[hook] & 1 \\
 1 \rar &  \pi_1(\bG, \bg) \rar & \pi_1(G,\bg) \rar & \Gal(\bFq/\Fq) \rar & 1.
 \end{tikzcd}
\]
The $\Fq$-rational point $g$ under the geometric point $\bg$ determines a splitting
$\Weil{}\to \W(G,\bg)$ of $\W(G,\bg)\to \Weil{}$.

  Since $G$ is connected, the geometric point $\bg$ determines
  an equivalence between the category of $\ell$-adic Weil local systems on $G$ and
  $\ell$-adic representations of $\W(G,\bg)$ \cite{deligne:80a}*{1.1.12}.
  Now let $(\gqcs{L},\mu,\phi)$ be a quasicharacter sheaf on $G$
  and let $\rho : \W(G, \bg) \to \EEx$ be the character determined by $(\gqcs{L},\phi)$.
  Composing with the splitting $\Weil{} \to \W(G,\bg)$ yields an $\ell$-adic character
  $\rho_g : \Weil{} \to \EEx$, which is the same as the Trace of Frobenius defined in Section~\ref{sec:Frob}:
  \[
  \rho_g(\Frob{}) =  \trFrob{\qcs{L}}(g).
  \]

  On the other hand, we have already seen that $\trFrob{\qcs{L}} : G(\Fq) \to \EEx$
  is a group homomorphism. Since $G$ is an algebraic group over $\Fq$, it is a
  variety over $\Fq$ and thus $G(\Fq)$ is finite.
  Therefore $\trFrob{\qcs{L}}(g) = \rho_g(\Frob{})$ is a root of unity
  for every $g\in G(\Fq)$.  Since $\Weil{}$ is generated by
  $\Frob{}$ and $\rho_g : \Weil{} \to \EEx$ is
  a character, it follows that the image of $\rho_g$ is a finite group.
  Thus, $\rho_g$ extends to an $\ell$-adic character of $\Gal(\bFq/\Fq)$,
  which we will also denote $\rho_g$.

  We may now lift the $\ell$-adic character $\rho_g : \Gal(\bFq/\Fq) \to \EEx$
  to an $\ell$-adic character $\pi_1(G,\bg) \to \EEx$ using the canonical topological group homomorphism
  $\pi_1(G,\bg) \to \Gal(\bFq/\Fq)$. But $\bg$ also
  determines an equivalence between the category of $\ell$-adic
  representations of $\pi_1(G,\bg)$ and $\ell$-adic local systems on $G$. Let
  $\qcs{L}_0$ be a local system on $G$ in the isomorphism class
  determined by this $\ell$-adic character of $\pi_1(G,\bg)$.
  Then $b_G^*\qcs{L}_0 \iso \gqcs{L}$.
  Since $b_G^*$ is full and faithful
  \citelist{\cite{deligne-katz:SGA7.2}*{Expos\'e XIII} \cite{beilinson-bernstein-deligne:81a}*{Prop. 5.2.1}},
  $
  b_{G\times G}^* : \Hom(m^*\qcs{L}_0,\qcs{L}_0\boxtimes\qcs{L}_0) \to \Hom({\bar m}^*\gqcs{L},\gqcs{L}\boxtimes\gqcs{L})
  $
  is a bijection
  (hom taken in the categories on constructible $\ell$-adic sheaves on
  $G\times G$ and ${\bar G}\times {\bar G}$ respectively,
  in which $\ell$-adic local systems sit as full subcategories).
  Let $\mu_0 : m^*\qcs{L}_0 \to \qcs{L}_0\boxtimes\qcs{L}_0$ be the isomorphism matching
  $\mu : {\bar m}^*\gqcs{L} \to \gqcs{L}\boxtimes\gqcs{L}$,
  the latter appearing in the definition of $\qcs{L}$.
  Then, as in Section~\ref{sec:bounded}, $(\qcs{L}_0,\mu_0)$ is an object in $\bQC(G)$
  and $\qcs{L} \ceq (\gqcs{L},\mu,\phi)$ is isomorphic to $(b_G^*\qcs{L}_0,b_{G\times G}^*\mu_0)$ in $\QC(G)$.
  Thus, the full and faithful functor $B_G : \bQC(G) \to \QC(G)$ from Section~\ref{sec:bounded}
  is also essentially surjective, hence an equivalence.

  In Section~\ref{sec:finite} we saw that $\fQC(G)$ is a full subcategory of $\bQC(G)$;
  more precisely, we exhibited a full and faithful functor $L_G : \fQC(G) \to \bQC(G)$.
  We now show that this functor is essentially surjective
  when $G$ is a connected, commutative algebraic group over $\Fq$.

  Let $(\qcs{L}_0,\mu_0)$ be a bounded quasicharacter sheaf on $G$.
  Then $\qcs{L}\ceq B_G(\qcs{L}_0,\mu_0)$ is a quasicharacter sheaf on $G$.
  Recall the definition of the character $\trFrob{\qcs{L}} : G(\Fq) \to \EEx$ from Section~\ref{sec:Frob}.
  Let $f : G\to G$ be the Lang isogeny.
  Recall that $\ker f = G(\Fq) = G^{\Frob{}}$;
  in particular, the action of $\Gal(\bFq/\Fq)$ on $\ker f$ is trivial.
  Let $V \ceq \EE$ and let $\psi : \ker f \to \Aut(V)$ be the representation given by
  $\psi(g)(v) \ceq \trFrob{\qcs{L}}(g) v$ for $v\in V$.
  Then $(f,\psi)$ is a finite quasicharacter sheaf.

  To show that $L_G(f,\psi) \iso (\qcs{L}_0,\mu_0)$ we apply the function--sheaf dictionary
  \citelist{\cite{laumon:87a}*{1.1.3} \cite{deligne:SGA4.5}*{sommes trig.}}  as follows.
  First, recall that $L_G(f,\psi) \ceq (L(f,\psi), \mu(f,\psi))$.
  Let $k'/k$ be any degree-$n$ extension;
  let $\Nm : G(k')\to G(k)$ be the norm map
  and let $b : G_{k'} \to G$ be the base change map.
  By \cite{laumon:87a}*{1.1.3.3},
  $\trFrob{b^*L(f,\psi)} = \trFrob{\qcs{L}} \circ \Nm$;
  on the other hand, $\trFrob{\qcs{L}} \circ \Nm = \trFrob{b^*\qcs{L}}$,
   by Proposition~\ref{prop:basechange}.
  Using \cite{laumon:87a}*{Th\'eor\`eme 1.1.2}, it follows that  $L(f,\psi) \iso \qcs{L}_0$ in $\Loc(G)$.
  It is now clear that $(L(f,\psi),\mu(f,\psi)) \iso (\qcs{L}_0,\mu_0)$ in $\bQC(G)$.
  This completes the proof that $L_G $ is essentially surjective.
  Since we have already seen (in Section~\ref{sec:finite}) that $L_G$ is full and faithful,
  it follows that $L_G$ is an equivalence.
\end{proof}

As Proposition~\ref{prop:connected} shows,
when $G$ is a connected algebraic group over $\Fq$,
it is appropriate to replace quasicharacter sheaves on $G$
with the conceptually simpler category $\fQC(G)$ of finite quasicharacter sheaves on $G$.
In this context, finite quasicharacter sheaves may also be apprehended as
\emph{certain} $\ell$-adic characters of fundamental group $\pi_1(G,{\bar e})$.
As explained in \cite{kamgarpour:09a}*{\S2},
the relevant characters of $\pi_1(G,{\bar e})$ are precisely those
that factor through a particular quotient of $\pi_1(G,{\bar e})$
denoted there by $\Pi_\text{disc}(G)$.
Using this fact, one can show that the category of discrete isogenies to $G$ is a Galois category,
in the sense of \cite{grothendieck:SGA1}*{Expos\'e V, \S 4}.
Moreover, since $\Pi_\text{disc}(G) \iso G(\Fq)$ \cite{kamgarpour:09a}*{App'x B},
the fundamental functor attached to this Galois category can be used to produce an equivalence
between the category of finite quasicharacter sheaves on $G$ and
the category of one-dimensional representations of $G(\Fq)^*$.
We will see an alternate proof of this fact in the next section; see Corollary~\ref{cor:connected}.

In principle, something similar is possible in the more general
context of this paper, where $G$ is a smooth commutative group scheme over $\Fq$. 
%to which we now return.
In this generality, however, neither of the full subcategories $\fQC(G) \subset \bQC(G) \subset \QC(G)$ are equivalences;
see the end of Section~\ref{sec:snake}.
Nevertheless, every quasicharacter sheaf $(\gqcs{L},\mu,\phi)$ on $G$
determines a Weil sheaf $(\gqcs{L},\phi)$ on $G$
so if we choose a geometric point ${\bar g}_x$ in each component $\bG^x$ of $G$
then this choice can be used to convert
the Weil sheaf $(\gqcs{L},\phi)$ into an $\ell$-adic character of $\prod_{x\in \pi_0(\bG)}\W(\bG^x, {\bar g}_x)$.
However, it seemed cumbersome to manage various
choices of families of base points and track the action
of $\Gal(\bFq/\Fq)$ on this (generally) infinite product of
Weil groups and also difficult to identify the relevant quotient of this group.
Viewed in this light, Definition~\ref{def:QC} seems comparatively simple.

\subsection{Recovery}

We are in a good position to understand $\QC(G)$ when $G$ is a connected algebraic group over $\Fq$, since we can now describe objects and maps in this category in very concrete terms. We begin by recovering a classical result. 


Morphisms in $\QC(G)$ are also very simple.

\begin{proposition}
If $G$ is a connected algebraic group then $\Aut_{\QC(G)}(\qcs{L})$ is . . . .
\end{proposition}

\begin{proof}
Pick up from the proof of Proposition~\ref{prop:autornaught}.
\end{proof}


%sagemathcloud={"zoom_width":105}
