% !TEX encoding = UTF-8 Unicode
\documentclass{amsart}
\pdfoutput=1

%%%%%%%%%%%%%%%%%% HEADING %%%%%%%%%%%%%%%%%%

\title[The function--sheaf dictionary, with applications over local fields]{The function--sheaf dictionary for smooth commutative group schemes over finite fields, with applications over local fields}

\date{\today}
\author{Clifton Cunningham}
\email{cunning@math.ucalgary.ca}
\address{University of Calgary}
\author{David Roe}
\email{roed.math@gmail.com}
\address{Pacific Institute for the Mathematical Sciences, University of Calgary}
\subjclass[2010]{14F05 (primary), 14L15 (secondary)}
\keywords{function--sheaf dictionary, trace of Frobenius, geometrization, quasicharacters, quasicharacter sheaves, smooth commutative group schemes}

%%%%%%%%%%%%%%%%% PACKAGES %%%%%%%%%%%%%%%%%
% Encodings
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
% AMS packages
\usepackage{amsmath, amsthm, amssymb, todonotes}%, showkeys}
\usepackage[alphabetic]{amsrefs}
% Fonts
\usepackage{mathrsfs, yfonts}
%Geometry
\usepackage{geometry}
% Enumitem
%\usepackage{enumitem}
% TikZ
\usepackage{tikz}
\usetikzlibrary{shapes,arrows,calc,matrix}
\usepackage{tikz-cd}
% Hyperrefs
\usepackage{hyperref}

%%%%%%%%%%%%%%% THEOREM STYLES %%%%%%%%%%%%%%%
\theoremstyle{plain}
      \newtheorem{theorem}{Theorem}[section]
      \newtheorem{proposition}[theorem]{Proposition}
      \newtheorem{lemma}[theorem]{Lemma}
      \newtheorem{corollary}[theorem]{Corollary}

      \theoremstyle{definition}
      \newtheorem{definition}[theorem]{Definition}

      \theoremstyle{remark}
      \newtheorem{remark}[theorem]{Remark}

%%%%%%%%%%%%%%%% TIKZ SETTINGS %%%%%%%%%%%%%%%%
\tikzset{every picture/.style={>=stealth},label/.style={font=\footnotesize}}

%%%%%%%%%%%%%%% RINGS AND GROUPS %%%%%%%%%%%%%%%
\newcommand{\FF}{{\mathbb{F}}}
\newcommand{\ZZ}{{\mathbb{Z}}}
\newcommand{\NN}{{\mathbb{N}}}
\newcommand{\CC}{{\mathbb{C}}}
\newcommand{\QQ}{{\mathbb{Q}}}
\newcommand{\RR}{{\mathbb{R}}}
\newcommand{\EE}{\mathbb{\bar Q}_\ell}
\newcommand{\Zl}{\mathbb{\bar Z}_\ell}
\newcommand{\OK}{\mathcal{O}_K}
\newcommand{\pK}{\mathfrak{p}_K}
\newcommand{\OKp}{\mathcal{O}_{K'}}
\newcommand{\pKp}{\mathfrak{p}_{K'}}
\newcommand{\OL}{\mathcal{O}_L}
\newcommand{\OO}[1]{\mathcal{O}_{#1}}
\newcommand{\Zp}{\mathbb{Z}_p}
\newcommand{\Qp}{\mathbb{Q}_p}
\newcommand{\bFq}{\bar{k}}
\newcommand{\Fq}{k}
\newcommand{\Fqm}{k_m}
\newcommand{\WW}{\mathbb{W}}
\newcommand{\EEx}{\EE^\times}
\newcommand{\Zlx}{\mathbb{\bar Z}_\ell^\times}
\newcommand{\Weil}[1]{\mathcal{W}_{#1}}

%%%%%%%%%%%%%%% ALGEBRAIC GROUPS %%%%%%%%%%%%%%%
\newcommand{\mathswab}[1]{\operatorname{\textswab{#1}}}
\newcommand{\Gm}[1]{\mathbb{G}_{\hskip-1pt\textbf{m},#1}}
\newcommand{\GN}[1]{\mathswab{#1}}
\newcommand{\bGN}[1]{{\bar{\mathswab{#1}}}}
\newcommand{\TT}{\underline{T}}
\newcommand{\TL}{\underline{T_L}}
\newcommand{\TTp}{\underline{T}'}

%%%%%%%%%%%%%%% NAMED OPERATORS %%%%%%%%%%%%%%%
\DeclareMathOperator{\Gal}{Gal}
\DeclareMathOperator{\W}{W}
\newcommand{\Frob}[1]{\operatorname{F}_{#1}}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\ord}{ord}
\DeclareMathOperator{\coker}{coker}
\DeclareMathOperator{\Gr}{Gr}
\DeclareMathOperator{\Irrep}{Irrep}
\DeclareMathOperator{\Pic}{Pic}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\Ext}{Ext}
\DeclareMathOperator{\Hh}{H}
\DeclareMathOperator{\Res}{Res}
\DeclareMathOperator{\Nm}{Nm}
\DeclareMathOperator{\trace}{Tr}
\DeclareMathOperator{\obj}{obj}
\DeclareMathOperator{\mor}{mor}
\DeclareMathOperator{\Lang}{Lang}
\DeclareMathOperator{\image}{im}
\DeclareMathOperator{\Loc}{Loc}
\DeclareMathOperator{\Tot}{Tot}
\newcommand{\gal}[1]{{\operatorname{Gal}\hskip-1pt\left( {\bar #1}/#1 \right)}}
\newcommand{\Spec}[1]{{\operatorname{Spec}\hskip-1pt( #1 )}}

%%%%%%%%%%%% MISCELLANEOUS OPERATORS %%%%%%%%%%%%
\newcommand{\sheafHom}{{\mathscr{H}\hskip-4pt{\it o}\hskip-2pt{\it m}}}
\newcommand{\abs}[1]{{\vert #1 \vert}}
\newcommand{\ceq}{{\, :=\, }}
\newcommand{\tq}{{\ \vert\ }}
\newcommand{\iso}{{\ \cong\ }}
%% Limits
\newcommand{\invlim}[1]{\lim\limits_{\overleftarrow{#1}}}
\newcommand{\dirlim}[1]{\lim\limits_{\overrightarrow{#1}}}
\newcommand{\limit}[1]{\mathop{\textsc{lim}}\limits_{#1}}
\newcommand{\colimit}[1]{\mathop{\textsc{colim}}\limits_{#1}}
%% Fonts for quasicharacter sheaves
\newcommand{\qcs}[1]{{\mathcal{#1}}}
\newcommand{\gqcs}[1]{{\mathcal{\bar #1}}}
\newcommand{\dualgcs}[1]{\gqcs{#1}^\dagger}
\newcommand{\dualcs}[1]{\qcs{#1}^\dagger}
%% Categories
\newcommand{\QC}{{\mathcal{Q\hskip-0.8pt C}}}
\newcommand{\lQC}{{\QC_\text{flb}}}
\newcommand{\lQCiso}[1]{\lQC(#1)_{/\text{iso}}}
\newcommand{\bQC}{{\QC_0}}
\newcommand{\fQC}{{\QC_\text{fin}}}
\newcommand{\QCiso}[1]{\QC(#1)_{/\text{iso}}}
\newcommand{\bQCiso}[1]{\bQC(#1)_{/\text{iso}}}
\newcommand{\fQCiso}[1]{\fQC(#1)_{/\text{iso}}}
\newcommand{\trFrob}[1]{t_{#1}}
\newcommand{\TrFrob}[1]{T_{#1}}
%% amsmath replacements for \atop
\newcommand{\latop}[2]{\genfrac{}{}{0pt}{0}{#1}{#2}}
\newcommand{\partop}[2]{\genfrac{(}{)}{0pt}{0}{#1}{#2}}
%% Labeled items
\makeatletter
\newcommand{\labitem}[2]{
\def\@itemlabel{\textbf{#1}}
\item
\def\@currentlabel{#1}\label{#2}}
\makeatother
%% Shorthand for bars
\renewcommand{\bf}{\bar{f}}
\newcommand{\bg}{\bar{g}}
\newcommand{\bm}{\bar{m}}
\newcommand{\bG}{\bar{G}}
\newcommand{\bH}{\bar{H}}
%% Spacing control
\newcommand{\tight}[3]{\hspace{-#1pt}{#2}\hspace{-#3pt}}
\newcommand{\GxG}{\text{$G \tight{1}{\times}{1} G$}}
\newcommand{\bGxG}{\text{$\bar{G} \tight{1}{\times}{1} \bar{G}$}}
\newcommand{\bfxf}{\text{$\bar{f} \tight{1}{\times}{1} \bar{f}$}}
\newcommand{\GxxG}{\text{$G \tight{1}{\times}{1} G$}}
\newcommand{\LxL}{\text{$\gqcs{L} \tight{0}{\boxtimes}{0} \gqcs{L}$}}
\newcommand{\ExE}{\text{$\qcs{E}\tight{0}{\boxtimes}{0}\qcs{E}$}}
\newcommand{\bExE}{\text{$\gqcs{E}\tight{0}{\boxtimes}{0}\gqcs{E}$}}
\newcommand{\AxA}{\text{$A \tight{1}{\times}{1} A$}}
\newcommand{\BxB}{\text{$B \tight{1}{\times}{1} B$}}
\newcommand{\GzxGz}{\text{$G^0 \tight{1}{\times}{1} G^0$}}
%% Margin notes
\newcommand\Clifton[1]{\marginpar{\smaller\smaller CC: #1}}
\newcommand\David[1]{\marginpar{\smaller\smaller DR: #1}}
%% Hyphenation override
\hyphenation{quasi-character}
\newcommand{\lTrFrob}[1]{\TrFrob{#1}^2}
\newcommand{\comp}{\Pi} % Component group
\newcommand{\m}{{\mathfrak{m}}}

%%%%%%%%%%%% BEGIN DOCUMENT %%%%%%%%%%%%
\begin{document}

\begin{abstract}
  We extend Deligne's function--sheaf dictionary from
  connected commutative algebraic groups over finite fields to smooth
  commutative group schemes over finite fields,
  in which case some interesting new features of the dictionary arise.
   \end{abstract}

\maketitle

\section*{Introduction}


%\subsection*{Overview}

%Deligne's function--sheaf dictionary translates characters of connected, commutative algebraic groups $G$ over finite fields $\Fq$ into certain local systems on G, from which the character of $G(\Fq)$ can be recovered using the action of Frobenius on $G$.
%The local systems which appear in this dictionary are easily characterised and often referred to as \emph{character sheaves} on $G$.
%The result is a perfect dictionary between characters of $G(\Fq)$ and character sheaves on G, with which the formidable artillery of algebraic geometry can be brought to bear on the study of characters of $G(\Fq)$.
%
%In this paper we show how this dictionary extends to the case when $G$ is not connected, and even to all smooth commutative group schemes over $\Fq$, in which case some interesting new features of the dictionary arise.


%\subsection{The main result}

Let us briefly review how Deligne's function--sheaf dictionary for connected commutative algebraic groups over finite fields \cite{deligne:SGA4.5}*{sommes trig.} translates characters into local systems.
Let $\Fq$ be a finite field and let $G$ be a connected commutative algebraic group over $\Fq$; fix an algebraic closure $\bFq$ of $\Fq$
and let $\bG$ be the base change of $G$ to $\bFq$.
Fix a prime $\ell$ invertible in $\Fq$ and let $\chi : G(\Fq) \to \EEx$ be any character.
Using little more than the Lang map for $G$, $\chi$ determines an $\ell$-adic local system $\qcs{L}$ on $G$ from which the character $\chi$ can be recovered using the Frobenius automorphism of $\bG$.
While this recovery process applies to all $\ell$-adic local systems $\qcs{L}$ on $G$, those that produce characters of $G(\Fq)$ are distinguished by a simple property: there \emph{exists} an isomorphism
\begin{equation}\label{introbox}
m^* \qcs{L} \iso \qcs{L} \boxtimes \qcs{L}
\end{equation}
 of $\ell$-adic local systems on $G$, where $m : G\times G \to G$ is the multiplication map for $G$. The function--sheaf dictionary for $G$ identifies a monoidal category of $\ell$-adic local systems on $G$ such that the group of isomorphism classes in this category is canonically identified with the $\ell$-adic character group of $G(\Fq)$, thus providing the geometrization and categorification of characters of $G(\Fq)$.
%
Although hidden in this discussion, the connectedness of $G$ played a crucial role in the geometrization and categorification of characters of $G(\Fq)$.
In particular, when the isomorphism \eqref{introbox} exists for $\qcs{L}$, it is essentially unique.

Now let $G$ be any smooth commutative group scheme over $\Fq$.
Two new features must be addressed in order to geometrize characters of $G(\Fq)$.
First, we must pass from $\ell$-adic local systems on $G$ to Weil local systems on $G$
and, second, we must keep track of the isomorphisms \eqref{introbox}.
Both issues are addressed in the main definition of this paper:
A \emph{quasicharacter sheaf} on $G$ is a triple $\qcs{L}\ceq
(\gqcs{L},\mu,\phi)$ where $\gqcs{L}$ is an $\ell$-adic local system on $\bG$ of rank~one and $\mu: m^*
\gqcs{L} \to \LxL$ and $\phi : \Frob{G}^*\gqcs{L} \to \gqcs{L}$ are isomorphisms satisfying natural compatibility conditions; here $\Frob{G}$ is the Frobenius automorphism of ${\bar G}$.
 In the main result of this paper, Theorem~\ref{thm:snake},
we form a rigid monoidal category $\lQC(G)$ of quasicharacter sheaves on $G$
and show that the Trace of Frobenius provides a functorial group isomorphism
\begin{equation}
\lQCiso{G} \to \Hom(G(\Fq), \EEx).
\end{equation}
\todo{change to remove flabbyness}

%\subsection*{Illustrative Examples}

%Three examples will illustrate some of the issues that arise when extending the function--sheaf dictionary to smooth commutative group schemes over $\Fq$.
As we show in the paper, $\ell$-adic local systems on $G$ can only be used to geometrize characters of finite order; quasicharacter sheaves, however, provide the geometrization of all characters of $G(\Fq)$.
For example, we will see how to geometrize the character $\ZZ \to \EEx$ defined by
$1 \mapsto \ell$, which has unbounded image,
using quasicharacter sheaves on the etale group scheme $\ZZ$ with trivial Galois action.
%Likewise, the dictionary is perfect for the etale group scheme $\ZZ$ with Galois action determined by $\Frob{}(n) = -n$. By contract, the etale group scheme $\ZZ \times \ZZ$ with trivial Galois action does admit invisible quasicharacter sheaves -- there are non-trivial quasicharacter sheaves on this group with trivial trace of Frobenius.\todo{Under construction} (Move this example: Define $g: \ZZ\times \ZZ \to \EEx$ by $g((n_1,m_1), (n_2, m_2)) = \ell^{m_1-m_2 + n_1-n_2}$. Then use the tehniques of Section~\ref{sec:etale} to build a non-trivial character sheaf from the pair $(f=1,g)$ with trivial trace of Frobenius.)

%\subsection*{Motivation and Application}

Our interest in the function--sheaf dictionary for smooth commutative group schemes over $\Fq$, especially etale commutative group schemes, comes from an application to $p$-adic representation theory.
In \cite{cunningham-roe:13a} we consider quasicharacter sheaves on the
Greenberg transform of the N\'eron model of an algebraic torus over an arbitrary local field.
The ability to work with non-connected group schemes,
of which the component group of the special fibre of the NÃ©ron model of a torus is an important example,
plays a crucial role in this application,
since these group schemes are not connected in general.
This process of creating a category from the group of quasicharacters of such a torus
informs our choice of the term quasicharacter sheaf, here.

%\subsection*{Comparison with other character sheaves}

We also want to situate our terminology in a historical context.
It is not uncommon to refer to local systems satisfying \eqref{introbox} on a connected, commutative algebraic group as character sheaves;
see for example, \cite{kamgarpour:09a}.
As explained above, quasicharacter sheaves evolved from this notion,
with an eye toward quasicharacters of $p$-adic groups.
However, the main use of the term character sheaf is of course due to Lusztig.
It is applied to certain perverse sheaves on connected reductive algebraic groups over algebraically closed fields in
\cite{lusztig:85a}*{Def.~2.10} and to certain perverse sheaves on reductive groups
over algebraically closed fields with finite cyclic component groups in the series of papers
beginning with \cite{lusztig:disconnected1}.
When commutative, such groups are extensions of $\ZZ/n\ZZ$ by a torus,
in which case it is not difficult to relate Frobenius-stable character sheaves to our quasicharacter sheaves.
The interesting new features pertaining to Weil sheaves and the non-triviality of $\Hh^2(\pi_0({\bar G}),\EEx)^{\Frob{G}}$ do not arise in this case.


%\subsection*{Structure of the paper}
\todo{Describe the overall structure of the paper in enough detail that one can follow the argument; include snake lemma diagram}

We close the introduction with an overview of the structure of this paper.
After setting some basic notation in Section~\ref{sec:notation},
in Section~\ref{sec:category} we define the category of quasicharacter sheaves.
We define pullbacks and products of quasicharacter sheaves in Section~\ref{sec:pullback}
Section~\ref{sec:Frob} introduces Trace of Frobenius,
one direction of the function--sheaf dictionary.
, and use
them to prove a functoriality result on Trace of Frobenius.
In Section~\ref{sec:basechange} we study how quasicharacter sheaves behave under base change
and Weil restriction.
Sections~\ref{sec:bounded} and \ref{sec:finite} describe bounded quasicharacter sheaves and finite quasicharacter sheaves, respectively,
forming two important subcategories of $\QC(G)$.
%These subcategories play a key role in the proof of Proposition~\ref{prop:restriction}.
In Section \ref{sec:connected} we show that all quasicharacter sheaves on $G$ are finite quasicharacter sheaves when $G$ is connected, and that Trace of Frobenius is an isomorphism in this case.
We shift to \'etale group schemes $G$ in Section~\ref{sec:etale} and find a cohomological interpretation
of quasicharacter sheaves in this case.
In Section~\ref{sec:restriction} we show that for non-connected $G$, restriction to the identity component
induces an essentially surjective functor of quasicharacter sheaves.
%Section~\ref{sec:snake} presents the main theorem of this paper: Trace of Frobenius
%is a functorial isomorphism from isomorphism classes of flabby quasicharacter sheaves on $G$
%to characters of $G(\Fq)$.

\todo{Comments about Joseph Bernstein's comments?}

%\begin{acknowledgements}
\subsection*{Acknowledgments}
We thank Masoud Kamgarpour, Pramod Achar, and Hadi Salmasian
for allowing us to hijack much of our Research in Teams meeting at BIRS into a discussion of
quasicharacter sheaves; their knowledge and help have been invaluable.
We also thank Takashi Suzuki, who made some enormously helpful observations and suggestions.
%
Finally, we gratefully acknowledge the financial support of the Pacific Institute for the Mathematical Sciences
and the National Science and Engineering Research Council,
as well the hospitality of the Banff International Research Station during our week-long stay in May 2012.

%\end{acknowledgements}

\tableofcontents

\section{The category of quasicharacter sheaves}


\subsection{Notations}\label{sec:notation}

Throughout this paper, $G$ is a smooth, commutative group scheme
over a finite field $\Fq$, and $m : \GxG\to G$ is its multiplication morphism.

We fix an algebraic closure $\bFq$ of $\Fq$ and write $\bG$ for the
smooth commutative group scheme $G \times_{\Spec{\Fq}} \Spec{\bFq}$ over $\bFq$
obtained by base change from $k$. The multiplication morphism for $\bG$ will be denoted by $\bm$.

Let $\Frob{}$ denote the geometric Frobenius element in $\Gal(\bFq/\Fq)$ as
well as the corresponding automorphism of $\Spec{\bFq}$. The Weil group
$\Weil{}\subset \Gal(\bFq/\Fq)$ is the subgroup generated by $\Frob{}$.
Let $\Frob{G} \ceq \id_{G} \times \Frob{}$ be the Frobenius automorphism of $\bG$.
%When no other fields play a role we will write $\Frob{}$ and $\Weil{}$ instead.

We fix a prime $\ell$, invertible in $\Fq$.
We will work with constructible $\ell$-adic sheaves \citelist{\cite{deligne:80a}*{\S 1.1} \cite{SGA5}*{Expos\'es V, VI}}
on schemes locally of finite type over $\Fq$, employing the standard formalism.
We also make extensive use of the external tensor product of $\ell$-adic sheaves,
defined as follows: if $\mathcal{F}$ and $\mathcal{G}$ are constructible $\ell$-adic
sheaves on schemes $X$ and $Y$ and $p_X : X\times Y\to X$ and $p_Y : X\times Y \to Y$
are the projections, then $\mathcal{F}\boxtimes \mathcal{G} \ceq p_X^* \mathcal{F} \otimes p_Y^*\mathcal{G}$.

For any group $A$, we will write $A^*$ for the dual group $\Hom_\text{grp}(A, \EEx)$.

\subsection{The category of quasicharacter sheaves}\label{sec:category}

\begin{definition}\label{def:QC}
A \emph{quasicharacter sheaf on $G$} is a triple
$\qcs{L}\ceq (\gqcs{L},\mu,\phi)$ where:
\begin{enumerate}
\labitem{(QC.1)}{QC.1} $\gqcs{L}$ is a rank~one $\ell$-adic local system on $\bG$, by which we mean
a constructible $\ell$-adic sheaf on $\bG$, locally constant on each connected
component of $\bG$, whose stalks are one-dimensional $\EE$-vector spaces;
\labitem{(QC.2)}{QC.2} $\mu: \bm^* \gqcs{L} \to \LxL$ is an isomorphism of
sheaves on $\bGxG$ such that the following diagram commutes,
  where $m_3 \ceq m\circ (m\tight{1}{\times}{2}\id) = m\circ (\id\tight{2}{\times}{1} m)$;
  \[
  \begin{tikzcd}[row sep=30]
  \bm_3^*\gqcs{L} \arrow{rr}{(\bm \tight{1}{\times}{2} \id)^*\mu} \arrow[swap]{d}{(\id \tight{2}{\times}{1} \bm)^*\mu}
    &&  \bm^*\gqcs{L} \boxtimes \gqcs{L} \dar{\mu \tight{0}{\boxtimes}{1} \id} \\
    \gqcs{L} \boxtimes \bm^* \gqcs{L} \arrow{rr}{\id \boxtimes \mu}
    &&  \gqcs{L} \tight{0}{\boxtimes}{0} \LxL
  \end{tikzcd}
  \]
\labitem{(QC.3)}{QC.3} $\phi : \Frob{G}^* \gqcs{L} \to \gqcs{L}$ is an
  isomorphism of constructible $\ell$-adic sheaves on $\bG$ compatible with
  $\mu$ in the sense that the following diagram commutes.
  \[
  \begin{tikzcd}[row sep=20]
  \Frob{\GxxG}^* \bm^* \gqcs{L} \arrow{rr}{\Frob{\GxxG}^*\mu}
    && \Frob{\GxxG}^*(\LxL)\\
    \arrow[equal]{u} \bm^*  \Frob{G}^* \gqcs{L} \arrow[swap]{d}{\bm^* \phi}
    && \Frob{G}^*\gqcs{L}\boxtimes \Frob{G}^*\gqcs{L} \dar{\phi\boxtimes \phi} \arrow[equal]{u} \\
    \bm^*\gqcs{L} \arrow{rr}{\mu}
    && \LxL
  \end{tikzcd}
  \]
\end{enumerate}
\end{definition}

Morphisms in the category of quasicharacter sheaves on $G$, denoted by $\QC(G)$, are defined in the natural way:
\begin{enumerate}
\labitem{(QC.4)}{QC.4} if $\qcs{L} = (\gqcs{L},\mu,\phi)$ and
  $\qcs{L'} = (\gqcs{L'},\mu',\phi')$ are quasicharacter sheaves on $G$ then
  a morphism $\qcs{L} \to \qcs{L}'$ is a map $\rho : \gqcs{L} \to \gqcs{L'}$
  of constructible $\ell$-adic sheaves on $\bG$ such that the following diagrams both commute.
  \[
  \begin{tikzcd}[column sep=40]
  \Frob{G}^* \gqcs{L} \rar{\Frob{G}^* \rho} \arrow[swap]{d}{\phi} & \Frob{G}^* \gqcs{L'} \dar{\phi'}
  & & \arrow[swap]{d}{\mu} m^* \gqcs{L} \rar{m^* \rho} & m^* \gqcs{L'} \dar{\mu'} \\
  \gqcs{L} \rar{\rho} & \gqcs{L'}
  & {} & \LxL \rar{\tight{1}{\rho\boxtimes \rho}{1}} & \gqcs{L'} \tight{0}{\boxtimes}{0} \gqcs{L'}
  \end{tikzcd}
  \]
\end{enumerate}

The category $\QC(G)$ of quasicharacter sheaves on $G$ is a rigid monoidal category
\cite{etingof:09a}*{\S1.10} under the tensor product
$\qcs{L} \otimes \qcs{L'} \ceq (\gqcs{L}\otimes\gqcs{L'}, \mu\otimes\mu', \phi\otimes \phi')$,
with duals given by applying the sheaf hom functor
$\sheafHom(\ - \ ,\EE)$.
This rigid monoidal category structure for $\QC(G)$ gives the set $\QCiso{G}$
of isomorphism classes in $\QC(G)$ the structure of a group.

In this paper we find the group $\QCiso{G}$ [point]
and also the set $\Hom(\qcs{L},\qcs{L}')$, for all quasicharacter sheaves $\qcs{L}$, $\qcs{L}'$ on $G$ [point]; in this way we provide a complete description of the category $\QC(G)$.

\begin{remark}
The category of quasicharacter sheaves on $G$ is not abelian; $\QC(G)$
is not a tensor category in the sense of \cite{deligne:02a}*{0.1}.
\end{remark}

\subsection{Trace of Frobenius}\label{sec:Frob}

In this section we introduce two tools which will help us understand isomorphism classes of objects in $\QC(G)$: the trace of Frobenius map $\QCiso{G} \to G(k)^*$ and the pullback functor $\QC(G) \to \QC(H)$ associated to a morphism $H \to G$.

%A Weil sheaf $(\gqcs{L},\phi)$ on $G$ may be interpreted as a constructible $\ell$-adic sheaf $\gqcs{L}$ on $\bG$ together with an action of the Weil group $\Weil{}$ on $\gqcs{L}$ compatible with the action of $\Gal(\bFq/\Fq)$ on $\bG$. 
%We now briefly review this point of view for later use in Section~\ref{sec:basechange}; see also \cite{deligne:80a}*{Def.~1.1.10}.  If $w \ceq \Frob{}^n$ we write $w_G$ for $\Frob{G}^n$.
%For each such $w$ we define an isomorphism $\varphi(w) : w_G^* \gqcs{L}\to \gqcs{L}$ by $\varphi(w) \ceq  \phi \circ \Frob{G}^*(\phi) \circ \cdots \circ (\Frob{G}^{n-1})^*(\phi);$
%these isomorphisms satisfy $\varphi(uv) = \varphi(v) \circ v_G^* \varphi(u)$ for $u,v\in \Weil{}$, and we have $\phi = \varphi(\Frob{})$.
%If we further define $\varphi_1(w) \ceq (w_G)_*(\varphi(w)^{-1})$ then $\varphi_1(w) : (w_G)_* \gqcs{L}\to \gqcs{L}$ is an isomorphism and $\varphi_1(uv) = \varphi_1(u) \circ (u_G)_* \varphi_1(v)$ for $u,v\in \Weil{}$.
%Thus the pair $(\gqcs{L},\varphi_1)$ almost satisfies the criteria for an action of $\Weil{}$ on $\gqcs{L}$ compatible with the action of $\Gal(\bFq/\Fq)$ in the sense of\cite{deligne:SGA4.5}*{Expos\'e XIII, 1.1}, failing only because $\Weil{}$ is not profinite.
%As we will see in Corollary~\ref{cor:bounded-and-finite}, our use of $\Weil{}$ rather than $\Gal(\bFq/\Fq)$ allows quasicharacter sheaves to correspond to unbounded characters.

%Observe that the rule $(\gqcs{L},\mu,\phi) \mapsto (\gqcs{L},\phi)$ defines a forgetful functor from quasicharacter
%sheaves on $G$ to ($\ell$-adic) Weil sheaves on $G$ \cite{deligne:80a}*{Def.~1.1.10 (i)}.
%


Let $(\gqcs{L},\phi)$ be a Weil sheaf on $G$. Every $g\in G(\Fq)$
determines a point $\bg$ on $\bG$ fixed by $\Frob{G}$. 
Together with the canonical isomorphism $(\Frob{G}^*\gqcs{L})_{\bg} \iso  \gqcs{L}_{\Frob{G}(\bg)}$, in this way the automorphism $\phi$ determines an automorphism $\phi_{\bg}$ of the $\EE$-vector space $\gqcs{L}_{\bg}$; let $\trace(\phi_{\bg};\gqcs{L}_{\bg})$ be the trace of $\phi_{\bg} \in \Aut_{\EE}(\gqcs{L}_{\bg})$ and let $\trFrob{(\gqcs{L},\phi)} : G(\Fq)\to \EE$ be the function defined by 
\begin{equation}\label{trWeil}
%\begin{equation}\label{trWeil}
\trFrob{(\gqcs{L},\phi)}(g) \ceq \trace(\phi_{\bg};\gqcs{L}_{\bg}),
%\end{equation}
\end{equation}
commonly called the {\em trace of Frobenius of $(\gqcs{L},\phi)$}.
Note that if $(\gqcs{L},\phi) \iso (\gqcs{L'},\phi')$ as Weil sheaves, 
then $\trFrob{(\gqcs{L},\phi)} = \trFrob{(\gqcs{L'},\phi')}$ as functions on $G(\Fq)$.

Now suppose $\qcs{L} = (\gqcs{L},\mu,\phi)$ is a quasicharacter sheaf on $G$.
The isomorphism $\mu : \bm^* \gqcs{L} \to \LxL$ together with
\ref{QC.3} guarantee
that the function $\trFrob{(\gqcs{L},\phi)} : G(\Fq)\to \EEx$ is a group homomorphism, which we will also denote by $\trFrob{\qcs{L}}$.  Moreover,
this homomorphism depends only on the isomorphism class of $\qcs{L}$, so we obtain a map
\begin{align*}
\TrFrob{G} : \QCiso{G} &\to G(\Fq)^* \\
\qcs{L} &\mapsto \trFrob{\qcs{L}}.
\end{align*}
Since tensor products on the stalks of $\qcs{L}$ induce pointwise multiplication on the trace of Frobenius, $\TrFrob{G}$ is a group homomorphism.  We devote the remainder of this section to
studying the behavior of the trace of Frobenius under morphisms of group schemes.  These simple but important
results on pullbacks and external products will be used in the proofs of many results in this paper.

\begin{proposition}\label{prop:pullback}
  If $f : H\to G$ is a morphism of smooth commutative group schemes over $\Fq$ then
  \begin{align*}
  f^* : \QC(G) &\to \QC(H) \\
  (\gqcs{L},\mu,\phi) &\mapsto (\bf^*\gqcs{L},(\bfxf)^*\mu,\bf^*F)
  \end{align*}
  defines a monoidal functor dual to $f \colon H(\Fq) \to G(\Fq)$:
  \[
  \begin{tikzcd}[row sep=20, column sep=30]
   \QCiso{G} \rar{f^*} \arrow[swap]{d}{\TrFrob{G}} & \QCiso{H} \dar{\TrFrob{H}} \\
   G(\Fq)^* \rar & H(\Fq)^*
  \end{tikzcd}
  \]
  is a commutative diagram of groups.  Moreover, $(f\circ g)^* = g^* \circ f^*$.
\end{proposition}

\begin{proof}
  Let $\qcs{L}$ be a quasicharacter sheaf on $G$. We start by showing that
  $\bf^*\gqcs{L}$ is a local system of rank~one. Let $c_j :\bH^j \hookrightarrow \bH$ be any
  connected component and let $d_i : \bG^i \hookrightarrow \bG$ be the image of $j$ under the group
  homomorphism $\pi_0(\bf) : \pi_0(\bH) \to \pi_0(\bG)$.  Write $\bf^j : \bH^j \to \bG^i$
  for the restriction of $f$ to $\bH^j$.  Since $\gqcs{L}$ is locally constant on the connected
  components of $\bG$, there is a finite \'etale covering
  $a_i : X_i \to \bG^i$ such that $a_i^* (\gqcs{L}\vert_{\bG^i})$
  is constant.  Define $Y_j$ in the following diagram through pullback:
  \[
  \begin{tikzcd}[row sep=20, column sep=30]
   Y_j \dar[dashed]{g_j} \rar[dashed]{b_j} & \bH^j \dar{\bf^j} \rar[hook]{c_j} & \bH \dar{\bf} \\
   X_i \rar{a_i} & \bG^i \rar[hook]{d_i} & \bG
  \end{tikzcd}
  \]
  Then $b_j$ is a finite \'etale covering
  of $\bH^j$ and
  \[
  b_j^* \left( (\bf^* \gqcs{L})\vert_{\bH^j}\right)
  = (\bf\circ c_j \circ b_j)^*\gqcs{L}
  = (d_i\circ a_i\circ g_j)^*\gqcs{L} = g_j^* a_i^* (\gqcs{L}\vert_{\bG^i}).
  \]
  Since $a_i^* (\gqcs{L}\vert_{\bG^i})$ is a constant sheaf, its pullback
  $b_j^* \left( (\bf^*\gqcs{L})\vert_{\bH^j}\right)$ along $g_j$ is also constant.
  Thus $\bf^*\gqcs{L}$ is locally constant on
  $\bH^j$. To complete the proof that $\bf^*\gqcs{L}$ satisfies
  \ref{QC.1}
  simply observe that $\bf^*\gqcs{L}$ has rank~one since
  $(\bf^*\gqcs{L})_{\bg} = \gqcs{L}_{f(\bg)}$, for every geometric point ${\bg}$ on $\bG$.


  To see that $(\bfxf)^* \mu$ satisfies \ref{QC.2},
  apply the functor $(\bfxf)^*$
  to \ref{QC.2} for $\qcs{L}$ and use the canonical isomorphism
  $(\bfxf)^*(\LxL) \iso \bf^*\gqcs{L} \tight{-3}{\boxtimes}{-3} \bf^*\gqcs{L}$.
  To show that $f^*\qcs{L}$ satisfies
  \ref{QC.3}, apply the same functor to \ref{QC.3} for $\qcs{L}$.
  Since $f$ is a morphism of group schemes defined over $\Fq$
  it provides isomorphisms $(\bfxf)^*\Frob{\GxxG}^* \iso \Frob{\GxxG}^* (\bfxf)^*$
  and $(\bfxf)^* \bm^*\iso \bm^* \bf^*$ between functors of constructible sheaves.

  Applying $\bf^*$ and $\bf^* \tight{1}{\times}{1}\bf^*$ to \ref{QC.4} defines the action
  of $f^*$ on morphisms of quasicharacter sheaves; arguing as above shows that $f^*$ is
  a functor from $\QC(G)$ to $\QC(H)$.  Since tensor products commute with pullback in schemes,
  $f^* : \QC(G) \to \QC(H)$ is a monoidal functor.
  The diagram relating $f^* : \QC(G) \to \QC(H)$, $f^* : G(k)^* \to H(k)^*$ and Trace of Frobenius
  commutes by \cite{laumon:87a}*{1.1.1.2}, where the ambient
  hypothesis that $X$ is of finite type over $\Fq$ can be replaced by
  the hypothesis that $X$ is locally of finite type over $\Fq$.

  Finally, the fact that $(f\circ g)^* = g^* \circ f^*$ follows from the analogous
  statements about the pullback functor on $\ell$-adic constructible sheaves.
\end{proof}

%We end this section with a simple result on products of quasicharacter sheaves, which is needed to show that the isomorphism above is functorial.

\begin{proposition}\label{prop:product}
If $G_1$ and $G_2$ are smooth commutative group schemes over $\Fq$ then the rule
$\boxtimes : (\qcs{L}_1,\qcs{L}_2)\to \qcs{L}_1\boxtimes\qcs{L}_2$ defines an equivalence of categories
\[
\QC(G_1)\times \QC(G_2) \to \QC(G_1\times G_2)
\]
such that
\[
\begin{tikzcd}[column sep=60]
\arrow{d}{\TrFrob{G_1} \times \TrFrob{G_2}} \QCiso{G_1}\times \QCiso{G_2} \arrow{r}{\boxtimes}
& \arrow{d}{\TrFrob{G_1\times G_2}} \QCiso{G_1\times G_2}\\
(G_1)(\Fq)^*\times (G_2)(\Fq)^* \arrow{r}{(\chi_1,\chi_2)\mapsto \chi_1\otimes \chi_2}  & (G_1\times G_2)(\Fq)^*
\end{tikzcd}
\]
commutes.
\end{proposition}

\begin{proof}
The only non-trivial part of the proof is to show that $\boxtimes : \QC(G_1)\times \QC(G_2) \to \QC(G_1\times G_2)$
is essentially surjective, so we will only address that point here.

Set $G \ceq G_1\times G_2$
and write $e_1$ and $e_2$ for the identity elements of $G_1$ and $G_2$.
Define $f : G\to G\times G$ by $f(g_1,g_2) \ceq (g_1,e_2,e_1,g_2)$.
Observe that $m\circ f = \id_G$.
Let $p_1$, $p_2$ be the projection morphisms pictured below:
\[
\begin{tikzcd}
G & \arrow[swap]{l}{p_1} G\times G \arrow{r}{p_2} & G.
\end{tikzcd}
\]
Let $r_1$ and $r_2$ be the projection morphisms pictured below,
with sections $q_1$ and $q_2$, also morphisms of group schemes:
\[
\begin{tikzcd}
G_1  \arrow[swap, bend right]{r}{q_1} &
\arrow[swap, bend right]{l}{r_1} G_1\times G_2 \arrow[bend left]{r}{r_2} &
\arrow[bend left]{l}{q_2} G_2.
\end{tikzcd}
\]
Observe that $p_1\circ f = q_1 \circ r_1$ and $p_2 \circ f = q_2\circ r_2$.

Now, let $\qcs{L} \ceq (\gqcs{L},\mu,\phi)$ be a quasicharacter sheaf on $G$.
Set $\qcs{L}_1 \ceq q_1^* \qcs{L}$ and $\qcs{L}_2 \ceq q_2^* \qcs{L}$;
by Proposition~\ref{prop:pullback}, $\qcs{L}_1$ a quasicharacter sheaf on $G_1$
and $\qcs{L}_2$ is a quasicharacter sheaf on $G_2$.
We will obtain an isomorphism $\qcs{L} \iso  \qcs{L}_1\boxtimes \qcs{L}_2$.
Applying the functor $f^*$ to the isomorphism $\mu$ yields
\begin{equation}\label{eq:fm}
f^*\mu : f^* m^* \gqcs{L} \to f^*(\gqcs{L}\boxtimes \gqcs{L}) .
\end{equation}
We have already observed that $m\circ f = \id_G$, so $f^* m^* \gqcs{L} = \gqcs{L}$.
On the other hand, $f^*(\gqcs{L}\boxtimes \gqcs{L}) = f^*p_1^*\gqcs{L}\otimes f^* p_2^*\gqcs{L}$
by definition.  Since $f^*p_1^*\gqcs{L} = r_1^* q_1^* \gqcs{L}$ and $f^*p_2^*\gqcs{L} = r_2^* q_2^* \gqcs{L}$
we get that $f^*(\gqcs{L}\boxtimes \gqcs{L}) = \gqcs{L}_1\boxtimes \gqcs{L}_2$.
It follows that \eqref{eq:fm} gives an isomorphism $\gqcs{L} \to  \gqcs{L}_1\boxtimes \gqcs{L}_2$.
It is a matter of routine to show that this morphism satisfies
\ref{qc.3} as it applies here,
from which it follows that we have exhibited an isomorphism
$\qcs{L} \to \qcs{L}_1\boxtimes \qcs{L}_2$ of quasicharacters sheaves on $G\times G$.
This completes the proof that $\boxtimes$ is essentially surjective.
\end{proof}

Using these results on pullbacks and products, we may prove a naturality property of $\TrFrob{G}$.

\begin{proposition}\label{prop:functorialG}
Trace of Frobenius $\TrFrob{G} : \QCiso{G} \to G(\Fq)^*$ is a natural transformation
between the two contravariant additive functors
\begin{align*}
F_1 : G &\mapsto \QCiso{G} \\
F_2 : G &\mapsto G(\Fq)^*
\end{align*}
from the category of smooth commutative group schemes over $\Fq$ to the category of abelian groups.
Likewise, for $\TrFrob{G} : \lQCiso{G} \to G(\Fq)^*$, {\it mut.\hskip-1pt mut.}
\end{proposition}

\begin{proof}
The first part of Proposition~\ref{prop:pullback} shows that $F_1$ is a functor,
while the second part shows that Trace of Frobenius is a natural transformation
$T: F_1 \to F_2$. When further combined with Proposition~\ref{prop:product},
we see that $F_1$ is an additive functor and $T: F_1 \to F_2$ is a natural
transformation between additive functors,
concluding the proof of Proposition~\ref{prop:functorialG}.
\end{proof}

%\subsection{Morphisms of quasicharacter sheaves}\label{sec:mor}

\section{Quasicharacter sheaves on \'etale commutative group schemes} \label{sec:etale}

%\subsection{Quasicharacter sheaves, revisited}

%\'Etale group schemes form a counterpoint to connected groups,
%since the component group of a smooth commutative group scheme
%is an \'etale group scheme \cite{vdGeer-Moonen:AbelianVarieties}*{III, \S 4}.
%However, the function--sheaf dictionary is substantially different in the two cases.
%To see why, we begin by specializing the definition of quasicharacter sheaves to the case
%of etale commutative group schemes,
%using the equivalence $G \mapsto G(\bFq)$
%from the category of \'etale group schemes over $\Fq$ to the category of groups equipped
%with an action of $\Gal(\bFq/\Fq)$, continuous for the discrete topology on the group.

In this section we find a complete characterization of quasicharacter sheaves on etale commutative group schemes over finite fields.

The equivalence $G \mapsto G(\bFq)$
from the category of \'etale commutative group schemes over $\Fq$ to the category of commutative groups equipped
with an action of $\Gal(\bFq/\Fq)$, continuous for the discrete topology on the group,
provides the following simple description of quasicharacter sheaves.
%
A quasicharacter sheaf $\qcs{L}$ on an etale commutative group scheme $G$ over $\Fq$ is:
\begin{enumerate}
 \labitem{(qc.1)}{qc.1} an indexed set of one-dimensional
  $\EE$-vector spaces $\gqcs{L}_x$, as $x$ runs over
  $G(\bFq)$;

 \labitem{(qc.2)}{qc.2} an indexed set of isomorphisms
  $\mu_{x,y} : \gqcs{L}_{x+y} \xrightarrow{\iso} \gqcs{L}_{x} \otimes\gqcs{L}_{y}$,
  for all $x,y \in G(\bFq)$, such that
  \[
   \begin{tikzcd}[row sep=40]
    \gqcs{L}_{x+y+z} \arrow{rr}{\mu_{x+y,z}} \arrow[swap]{d}{\mu_{x,y+z}}
    && \gqcs{L}_{x+y}\otimes\gqcs{L}_{z} \dar{\mu_{x,y} \tight{0.5}{\otimes}{1} \id} \\
    \gqcs{L}_{x} \otimes\gqcs{L}_{y+z} \arrow{rr}{\id \otimes\mu_{y,z}}
    && \gqcs{L}_{x} \otimes\gqcs{L}_{y} \otimes\gqcs{L}_{z}
   \end{tikzcd}
  \]
  commutes, for all $x,y,z\in G(\bFq)$; and
 \labitem{(qc.3)}{qc.3} an indexed set of isomorphisms $\phi_{x} : \gqcs{L}_{\Frob{}(x)} \to \gqcs{L}_x$
  such that
  \[
   \begin{tikzcd}[row sep=40]
    \gqcs{L}_{\Frob{}(x)+\Frob{}(y)} \arrow[swap]{d}{\phi_{x+y}} \arrow{rr}{\mu_{\Frob{}(x),\Frob{}(y)}}
    && \gqcs{L}_{\Frob{}(x)}\otimes\gqcs{L}_{\Frob{}(y)} \dar{\phi_x \tight{0}{\otimes}{0} \phi_y} \\
    \gqcs{L}_{x+y} \arrow{rr}{\mu_{x,y}}
    && \gqcs{L}_x \otimes\gqcs{L}_y
   \end{tikzcd}
  \]
  commutes, for all $x,y\in G(\bFq)$.
\end{enumerate}
Under this equivalence, a morphism $\rho : \qcs{L} \to \qcs{L'}$ of quasicharacter sheaves on $G$ is given by
\begin{enumerate}
 \labitem{(qc.4)}{qc.4} an indexed set $\rho_x : \gqcs{L}_x \to \gqcs{L'}_x$
  of linear transformations such that
  \[
   \begin{tikzcd}[column sep=40]
    \arrow[swap]{d}{\phi_x} \gqcs{L}_{\Frob{}(x)} \rar{\rho_{\Frob{}(x)}} & \gqcs{L'}_{\Frob{}(x)} \dar{\phi_x'}
    &\arrow[draw=none]{d}[pos=.4,description]{\text{\normalsize{and}}}
    & \arrow[swap]{d}{\mu_{x,y}} \gqcs{L}_{x+y} \rar{\rho_{x+y}} & \gqcs{L'}_{x+y} \dar{\mu'_{x,y}} \\
    \gqcs{L}_x \rar{\rho_x} & \gqcs{L'}_x
    & {} & \gqcs{L}_x\otimes\gqcs{L}_y \rar{\rho_x\otimes\rho_y} & \gqcs{L'}_x \otimes\gqcs{L'}_y
   \end{tikzcd}
  \]
  both commute for all $x, y \in G(\bFq)$.
\end{enumerate}

We will see that the Trace of Frobenius may not provide complete
information about isomorphism classes of quasicharacter sheaves on $G$ when $G$ is not a connected algebraic group.
Our main tool for understanding this phenomenon
is a group homomorphism from $\QCiso{G}$ to $\Hh^2(E^\bullet_G)$, defined in Section~\ref{sec:S}, for which the next two sections are preparation.

\subsection{A spectral sequence}\label{sec:E}

The zeroth page of the Hochschild-Serre spectral sequence is a double complex $E^{\bullet, \bullet}$ defined by
\[
E^{i,j} = C^i(\Weil{}, C^j(G(\bFq), \EEx)),
\]
The derivative of group cohomology yields two derivatives:
\begin{align*}
d_0 = d_G &: E^{i,j} \to E^{i,j+1} \\
d_{\Weil{}} &: E^{i,j} \to E^{i+1,j}.
\end{align*}
Combining these yields a derivative $d = d_G + (-1)^j d_{\Weil{}}$ on the total complex
\[
E^n_G = \bigoplus_{i+j=n} E^{i,j}.
\]
The machinery of spectral sequences gives us a sequence of pages $E_r^{i,j}$, converging to a page $E_{\infty}^{i,j}$. We summarize the key properties of this spectral sequence in the following proposition.

\begin{proposition}
\begin{enumerate}
\item The second page is given by $E_2^{i,j} = \Hh^i(\Weil{}, \Hh^j(G(\bFq), \EEx))$,
\item there is an isomorphism $\Hh^n(\Weil{} \ltimes G(\bFq), \EEx) \cong \Hh^n(E_G^\bullet)$,
\item there is a filtration $\Hh^n(\Weil{} \ltimes G(\bFq), \EEx) = F_n \supset \cdots \supset F_0 \supset F_{-1} = 0$ where $F_i / F_{i-1} \cong E_{\infty}^{i, n-i}$.
\end{enumerate}
\end{proposition}

Moreover, since $\Weil{} \cong \ZZ$ has cohomological dimension $1$, $E_2^{i,j} = 0$ for $i > 1$ and the sequence degenerates at the second page: $E_{\infty}^{i,j} = E_2^{i,j}$. We obtain the following corollary:

\begin{corollary}
There is a short exact sequence
 \[
  \begin{tikzcd}
    0 \arrow{r}
    & \Hh^0(\Weil{},\Hh^2({\bar G},\EEx)) \arrow{r}
    & \Hh^2(E^\bullet_G) \arrow{r}
    & \Hh^1(\Weil{},\Hh^1({\bar G},\EEx)) \arrow{r}
    & 0
  \end{tikzcd}
 \]
\end{corollary}

This sequence will play a key role in understanding the kernel of $T_G$, as described in the next few sections.
For this application, we need a good understanding of these maps to and from the total complex.

\begin{proposition} \label{prop:ses_desc}
\begin{enumerate}
\item Every class $[\alpha\oplus\beta\oplus\gamma] \in \Hh^2({\bar G},\EEx)$ is cohomologous to one with $\gamma=0$.
\item The map $\Hh^2(E^\bullet_G) \to \Hh^1(\Weil{},\Hh^1({\bar G},\EEx))$ is given by $[\alpha\oplus\beta\oplus 0] \mapsto [\beta]$.
\item Suppose $a \in Z^2({\bar G}, \EEx)$ represents a class in $\Hh^2({\bar G},\EEx)$ fixed by Frobenius.
The map $\Hh^0(\Weil{},\Hh^2({\bar G},\EEx)) \to \Hh^2(E^\bullet_G)$ is given by $[a] \mapsto [a \oplus 0 \oplus 0]$.
\end{enumerate}
\end{proposition}
\begin{proof}
Since $\Hh^2(\Weil{}, C^0({\bar G}, \EEx)) = 0$, we may find a $\gamma_1 \in C^1(\Weil{}, C^0({\bar G}, \EEx))$ with $d_{\Weil{}}\gamma_1 = \gamma$.
Subtracting $d \gamma_1$ from $\alpha\oplus\beta\oplus\gamma$, we may assume that $\gamma = 0$.

The latter two claims follow from tracing through the definition of latter pages in the spectral sequence; see Vakil \cite{} for example \todo{update reference}.
\end{proof}

\subsection{From quasicharacter sheaves to the total complex}\label{sec:S}

In this section we define an isomorphism
\[
S_G : \QCiso{G} \to \Hh^2(E^\bullet_G).
\]
Let $\qcs{L} = (\gqcs{L},\mu,\phi)$ be a quasicharacter sheaf on $G$.
For each geometric point $x\in {\bar G}$, choose a basis $\{ v_x \}$ for $\gqcs{L}_x$.
Through this choice, $\qcs{L}$ determines functions
\begin{align*}
a : {\bar G}\times {\bar G} &\to \EEx & b : {\bar G} &\to \EEx \\
\mu_{x,y}(v_{x+y}) &= a(x,y) v_x \otimes v_y & \phi_x(v_{\Frob{G}(x)}) &= b(x) v_x.
\end{align*}
Condition~\ref{QC.2} implies that
\begin{equation}\label{2-cocyle}
a(x+y,z) a(x,y) = a(x,y+z) a(y,z)
\end{equation}
for all $x,y,z\in {\bar G}$, so $a \in Z^2({\bar G},\EEx)$.  Similarly, condition~\ref{QC.3} gives
\begin{equation}\label{nohom}
\frac{a(\Frob{G}(x),\Frob{G}(y))}{a(x,y)} =  \frac{b(x+y)}{b(x) b(y)}
\end{equation}
for $x, y \in {\bar G}$.
Let $\alpha \in C^0(\Weil{},C^2({\bar G},\EEx)$ be the $0$-cochain corresponding to $a$ and let $\beta\in C^1(\Weil{},C^1({\bar G},\EEx)$ be the cocycle such that $\beta(\Frob{})$ is $b$ \emph{written additively}.
Then
\[
d_G\alpha =0, \qquad\qquad
d_{\Weil{}} \alpha = d_{G} \beta,\qquad\qquad
d_{\Weil{}} \beta =0;
\]
in other words,
\[\alpha\oplus \beta \in Z^2(E^\bullet_G).\]
Although the cocycle $\alpha\oplus \beta$ is not well defined by $\qcs{L}$, its class in $Z^2(E^\bullet_G)$ is.
To see this, let $\{ v'_x \in \gqcs{L}_x^\times \tq x \in {\bar G}\}$ be another choice and let $\alpha'\oplus \beta' \in Z^2(E^\bullet_G)$ be defined by $\qcs{L}$ and this choice, as above.
Now let $\delta \in C^0(\Weil{},C^1({\bar G},\EEx))$ be the additive version of the function $d : {\bar G}\to \EEx$ defined by $v'_x = d(x) v_x$.
Then, chasing through \ref{QC.2} and \ref{QC.3} we find
\[
\alpha'\oplus\beta' = \alpha\oplus\beta + d\delta,
\]
so the class $[\alpha\oplus\beta]$ of $\alpha\oplus\beta$ in $\Hh^2(E^\bullet_G)$ is independent of the choice made above. It is also easy to see that $[\alpha\oplus\beta] = [\alpha_0\oplus\beta_0]$ when $\qcs{L} \iso \qcs{L}_0$,
which concludes the definition of the function
\begin{align*}
S_G : \QCiso{G} &\to \Hh^2(E^\bullet_G)\\
[\qcs{L}] &\mapsto [\alpha\oplus \beta].
\end{align*}
It is also easy to see that $[\alpha_1\oplus\beta_1] + [\alpha_2\oplus\beta_2] = [\alpha_3\oplus\beta_3]$ when $\qcs{L}_3 = \qcs{L}_1\otimes \qcs{L}_2$, so $S_G$ is a group homomorphism.

\begin{remark}
Although we will only use the group homomorphism $S_G : \QCiso{G}\to \Hh^2(E^\bullet_G)$ when $G$ is an etale commutative group scheme, the function is defined for all smooth commutative group schemes $G$.
However, the next result is false in that context.
\end{remark}

\begin{proposition}
If $G$ is \'etale then $S_G$ is an isomorphism.
\end{proposition}
\begin{proof}
We first show that $S_G$ is injective.  Suppose $\qcs{L} \in \QCiso{G}$ with $S_G(\qcs{L}) = [\alpha \oplus \beta] = 0$,
so that $\alpha \oplus \beta = d\rho$ for some $\rho \in C^0(\Weil{},C^1({\bar G},\EEx) = C^1({\bar G},\EEx)$.
For each $x\in {\bar G}$, define $\rho_x : \gqcs{L}_x \to \EEx$ by $v_x \mapsto \rho(x)$.
Then the indexed set of isomorphisms $\{ \gamma_x : \gqcs{L}_x \to \EE \tq x\in {\bar G}\}$
defines an isomorphism $\qcs{L} \to (\EE)_G$.
Since $\qcs{L} = 0 \in \QCiso{G}$, $S_G$ is injective.

To see that $S_G$ is surjective, begin with $\alpha\oplus\beta\oplus 0 \in Z^2(E^\bullet_G)$.
Since $d_{\Weil{}} \beta = 0$, we may define $a = \alpha \in C^2({\bar G},\EEx)$ and
$b = \beta(\Frob{}) \in C^1({\bar G},\EEx)$, which are related to $\alpha$ and $\beta$ as above.
Set $\gqcs{L}_x = \EEx$, define $\mu_{x,y} : \gqcs{L}_{x+y} \to \gqcs{L}_x\otimes\gqcs{L}_y$
by $\mu_{x,y}(1) = a(x,y) 1\otimes 1$ and $\phi_x : \gqcs{L}_{\Frob{G}(x)} \to \gqcs{L}_x$ by $\phi_x(1)= b(x)$.
Then \ref{qc.1} holds since $d_G \alpha =0$ and \ref{qc.2} holds since $d_{\Weil{}}\alpha =d_G \beta$.
Tracing the construction backward, we have defined a quasicharacter sheaf $\qcs{L}$ on $G$ with
$S_G(\qcs{L}) = [\alpha\oplus\beta\oplus\gamma]$, showing that $S_G$ is surjective.
\end{proof}

\subsection{Objects, when $G$ is etale}%\texorpdfstring{$S$ and $T$}{S and T}}

In this section we find the relationship between the group homomorphisms $\TrFrob{G}$ and $S_G$, and use this to find the group $\QCiso{G}$ when $G$ is an etale commutative group scheme over $\Fq$.

%
We begin with a simple, general result relating duals, invariants and coinvariants.

\begin{lemma} \label{lem:dual-inv}
Let $X$ be an abelian group equipped with an action of $\Weil{}$.
 Then
\begin{align*}
 (X^*)_{\Frob{}} &\to (X^{\Frob{}})^* \\
 [f] &\mapsto f|_{X^{\Frob{}}}
\end{align*}
is an isomorphism.
\end{lemma}

\begin{proof}
We can describe $X^{\Frob{}}$ as the kernel of the map $X \xrightarrow{\Frob{}-1} X$;
let $Y = (\Frob{}-1)X$ be the augmentation ideal.  Dualizing the sequence
\[
 0 \to X^{\Frob{}} \to X \to Y \to 0
\]
yields
\[
 0 \to Y^* \to X^* \to (X^{\Frob{}})^* \to \Ext^1_\ZZ(Y, \EEx).
\]
Since $\Ext^1_\ZZ(-,\EEx)$ vanishes, we get a natural isomorphism from the cokernel of $Y^* \xrightarrow{\Frob{}-1} X^*$ to $(X^{\Frob{}})^*$.
\end{proof}

\begin{proposition}\label{prop:sur_etale}
If $G$ is \'etale then $\TrFrob{G} : \QCiso{G} \to G(\Fq)^*$ is surjective.
\end{proposition}
\begin{proof}
Pick $\chi \in G(\Fq)^*$.
By Lemma~\ref{lem:dual-inv}, there is some $b\in G(\bFq)^*$ such that $b\vert_{G(\Fq)^*} = \chi$.
Set $\gqcs{L}_x = \EE$ for every $x\in G(\bFq)$.
Define $\mu_{x,y} : \gqcs{L}_{x+y} \to \gqcs{L}_x\otimes \gqcs{L}_y$ by $\mu_{x,y}(1) = 1 \otimes 1$ and
$\phi_{x} : \gqcs{L}_{\Frob{}(x)} \to \gqcs{L}_x$ by $\phi_{x}(1) = b(x)$.
Since $b : G(\bFq) \to \EEx$ is a group homomorphism,
condition \eqref{nohom} is satisfied with $a =1$ and $\qcs{L} = (\gqcs{L}, \mu, \phi)$
is a quasicharacter sheaf with $\trFrob{\qcs{L}} = \chi$.
\end{proof}



\begin{proposition} \label{prop:etale-iso}
 If $G$ is \'etale then the map $S_G : \QCiso{G}\to \Hh^2(E^\bullet_G)$ induces an isomorphism of short exact sequences
\[
\begin{tikzcd}
 0 \arrow{r} & \ker \TrFrob{G} \arrow{d} \arrow{r} & \QCiso{G}\arrow{d}{S_G} \arrow{r}{\TrFrob{G}} \arrow{r} & G(\Fq)^* \arrow{d} \arrow{r} & 0\\
  0 \arrow{r} & \Hh^0(\Weil{},\Hh^2({\bar G},\EEx)) \arrow{r} & \Hh^2(E^\bullet_G) \arrow{r} & \Hh^1(\Weil{},\Hh^1({\bar G},\EEx)) \arrow{r} & 0.
 \end{tikzcd}
 \]
\end{proposition}
\begin{proof}
This result follows easily from Propositions~\ref{prop:ses_desc} and \ref{prop:sur_etale}.
\end{proof}

\subsection{Morphisms}\label{sec:mor-etale}

Most of this paper focuses on the question of determining the isomorphism classes of objects; a complete understanding of the morphisms in $\QC(G)$ also requires a description of the automorphisms of an arbitrary quasicharacter sheaf $\qcs{L}$.

\begin{proposition}\label{prop:autornaught_etale}
Let $G$ be an etale commutative group scheme over $\Fq$.
If $\qcs{L}$ and $\qcs{L}'$ are quasicharacter sheaves on $G$ then
every $\rho\in \Hom(\qcs{L},\qcs{L}')$ is either trivial or an isomorphism. Moreover, the trace map induces an isomorphism of groups
\[
\Aut(\qcs{L}) \to \Hom(G(\bFq)_{\Weil{}}, \EEx).
\]
\end{proposition}

\begin{proof}
Suppose $\rho \in \Hom(\qcs{L},\qcs{L}')$.
If $\rho_0 = 0$ then the second diagram in \ref{qc.4} for $y=0$ implies that $\rho_x = 0$ for all $x\in G$, in which case $\rho$ is trivial.
On the other hand, if $\rho_0$ is nonzero then the second diagram in \ref{qc.4} for $y = -x$ implies that $\rho_x$ is nonzero for all $x$ and thus an isomorphism since the stalk of quasicharacter sheaves are one dimensional; in this case $\rho$ is an isomorphism.

Now suppose $\rho \in \Aut(\qcs{L})$.
The second diagram in \ref{qc.4} shows that the association $x \mapsto \rho_x$ is a homomorphism from $G(\bFq)$ to $\EEx$ and the first diagram in \ref{qc.4} shows that it factors through $G(\bFq)_{\Weil{}}$.  Conversely, if $\rho : G(\bFq)_{\Weil{}} \to \EEx$ is any homomorphism then defining $\rho_x$ as multiplication by $\rho(x)$ will satisfy the two diagrams.  Composition of morphisms corresponds to pointwise multiplication in this correspondence, showing that the resulting bijection is actually a group isomorphism.
\end{proof}

%Note that Proposition~\ref{prop:autornaught_etale} tells us that if $G$ is an etale commutative group scheme over $\Fq$ then every hom-set is either trivial or $\{ 0 \} \cup \left(G(\bFq)_{\Weil{}}\right)^*$, non-canonically.

\section{Quasicharacter sheaves on commutative algebraic groups}

%In this section we find $\QCiso{G}$ and $\Aut(\qcs{L})$ for commutative algebraic group over $\Fq$; note that we found these in Section~\ref{sec:etale} when $G$ is etale. 

%\subsection{Bounded quasicharacter sheaves}\label{sec:bounded}
\subsection{Descent to G}\label{sec:bounded}

%Let $G$ be a smooth commutative group scheme over $\Fq$.
In this section we consider a category of sheaves on $G$ obtained by
replacing the Weil sheaf $(\gqcs{L}, \phi)$ on $\bG$ in the definition of a quasicharacter sheaf with an $\ell$-adic local system on $G$ itself.

\begin{definition}
Let $\bQC(G)$ be the category of pairs $(\qcs{E},\mu_\qcs{E})$
where $\qcs{E}$ an $\ell$-adic local system on $G$ of rank~one,
equipped with an isomorphism $\mu_\qcs{E} : m^* \qcs{E} \to \qcs{E} \boxtimes \qcs{E}$
satisfying the analogue of \ref{QC.1} on $G$;
morphisms in $\bQC(G)$ are defined as in the second part of
\ref{QC.3}.
%This is the category of \emph{bounded quasicharacter sheaves} on $G$.
\end{definition}

Category $\bQC(G)$ is a rigid monoidal category in the obvious way.

\begin{proposition}\label{prop:BG}
Extension of scalars defines a full and faithful functor $B_G : \bQC(G) \to \QC(G)$.
\end{proposition}

\begin{proof}
 Let $b_G : {\bar G} \to G$ be the pullback of $\Spec{\bFq} \to \Spec{\Fq}$ along $G\to \Spec{\Fq}$.
 Suppose $(\qcs{E},\mu_\qcs{E})$ in an object in $\bQC(G)$.
 Then $\qcs{E}$ is an $\ell$-adic constructible sheaf on $G$ and
 $b_G^* \qcs{E}$ comes equipped with an isomorphism
 $\phi_\qcs{E} : \Frob{G}^* b_G^*\qcs{E} \to b_G^* \qcs{E}$.
 The functor $\qcs{E} \mapsto (b_G^* \qcs{E},\phi_\qcs{E})$
 from $\ell$-adic constructible sheaves on $G$ to $\ell$-adic constructible sheaves on $G$
 is full and faithful \citelist{\cite{deligne-katz:SGA7.2}*{Expos\'e XIII} \cite{beilinson-bernstein-deligne:81a}*{Prop. 5.2.1}}.
 This functor preserves local constancy, so takes local systems to local systems.
 Set $\mu \ceq b_{G\times G}^*\mu_\qcs{E}$; clearly, this satisfies \ref{QC.2}
 with $b_G^*\qcs{E}$ playing the role of $\gqcs{L}$.
 Moreover, $\phi_\qcs{E}$ is compatible with $\mu_\qcs{E}$ in the sense of \ref{QC.3}.
 This construction defines the functor $B_G : (\qcs{E},\mu_\qcs{E}) \mapsto (b_G^*\qcs{E},b_{G\times G}^*\mu_\qcs{E}, \phi_\qcs{E})$
 and also shows that it is full and faithful.
\end{proof}

We will identify $\bQC(G)$ with its image under $B_G$ and say that a quasicharacter sheaf $\qcs{L} \in \QC(G)$ \emph{descends to $G$} if it is isomorphic to some $B_G(\qcs{E}, \mu_\qcs{E})$.
%We will see in Corollary~\ref{cor:bounded-and-finite} that bounded quasicharacter sheaves are exactly quasicharacter sheaves with bounded Trace of Frobenius.\todo{Check this, later.}

\subsection{Discrete isogenies}\label{sec:discrete_isogenies}

%Here we describe a class of quasicharacter sheaves on $G$ that will play a role in Section~\ref{sec:restriction}.

A finite, etale, surjective morphism $H\to G$ of smooth group schemes over $\Fq$ for which the action of $\Gal(\bFq/\Fq)$ on the kernel is trivial is called a {\it discrete isogeny}.

\begin{proposition}\label{prop:finite}
Let $f: H \to G$ be a discrete isogeny; let $A$ be the kernel of $f$.
Let $V$ be a $1$-dimensional representation of $A$ 
equipped with an isomorphism $V\to V\otimes V$.
Let $\psi : A \to \EEx$ be the character of $V$.
Then $(f_! V_H)_\psi$ (the $\psi$-isotypic component of $f_!V_H$) is an object in $\bQC(G)$.
\end{proposition}

\begin{proof}
Let $f$, $A$, $V$ and $\psi$ be as above; set $\qcs{E} = (f_! V_H)_\psi$.
It is clear that $\qcs{E}$ is an $\ell$-adic local system on $G$ of rank one.
We must show that comes equipped with an isomorphism $\mu_\qcs{E} : m^* \qcs{E} \to \qcs{E}\boxtimes\qcs{E}$.
To do this we use etale descent to see that pullback along $f$ gives an equivalence between $\ell$-adic local systems on $G$ and $A$-equivariant local systems on $H$. 
In particular, $f^*\qcs{E}$ is the $A$-equivariant constant sheaf $V$ on $H$ with character $\psi$.
Since $f$ is a morphism of group schemes, the functor $f^*$ defines $\mu_\qcs{E} : m^*\qcs{E} \to \qcs{E}\boxtimes\qcs{E}$ from the isomorphism $m^*\psi \iso \psi \boxtimes\psi$ determined by $V\to V\otimes V$.
\end{proof}

We remark that, since $V$ is $1$-dimensional, the choice of $V \to V\otimes V$ is exactly the choice of an isomorphism $V\iso \EE$.

\subsection{Quasicharacter sheaves on connected commutative algebraic groups}\label{sec:connected}

In general, $\bQC(G)$ is an essentially
proper subcategory of $\QC(G)$. 
However, if $G$ is connected and of finite type, the categories are equivalent, as we now show.

\begin{lemma}\label{lem:bounded_connected}
If $G$ is a connected commutative algebraic group over $\Fq$ then $B_G : \bQC(G) \to \QC(G)$ is an equivalence of categories.
\end{lemma}

\begin{proof}
Choose any $\Fq$-rational point $g$ on $G$ and let $\bg$ be the geometric point on $G$ lying above $g$.
Recall that the \emph{Weil group} of $G$, which we will denote by $\W(G,\bg)$, is a subgroup of the \'etale
fundamental group defined by the following diagram:
\[
 \begin{tikzcd}
 1 \rar & \ar[equal]{d} \pi_1(\bG, \bg) \rar & \W(G,\bg) \rar \dar[hook] & \Weil{} \rar \dar[hook] & 1 \\
 1 \rar &  \pi_1(\bG, \bg) \rar & \pi_1(G,\bg) \rar & \Gal(\bFq/\Fq) \rar & 1.
 \end{tikzcd}
\]
The $\Fq$-rational point $g$ under the geometric point $\bg$ determines a splitting
$\Weil{}\to \W(G,\bg)$ of $\W(G,\bg)\to \Weil{}$.
%
  Since $G$ is connected, the geometric point $\bg$ determines
  an equivalence between the category of $\ell$-adic Weil local systems on $G$ and
  $\ell$-adic representations of $\W(G,\bg)$ \cite{deligne:80a}*{1.1.12}.
  
  Now let $(\gqcs{L},\mu,\phi)$ be a quasicharacter sheaf on $G$
  and let $\rho : \W(G, \bg) \to \EEx$ be the character determined by $(\gqcs{L},\phi)$.
  Composing with the splitting $\Weil{} \to \W(G,\bg)$ yields an $\ell$-adic character
  $\rho_g : \Weil{} \to \EEx$, which is the same as the Trace of Frobenius defined in Section~\ref{sec:Frob}, for every $\Fq$ rational point $g$ on $G$:
  $
  \rho_g(\Frob{}) =  \trFrob{\qcs{L}}(g).
  $
%
  On the other hand, we have already seen that $\trFrob{\qcs{L}} : G(\Fq) \to \EEx$
  is a group homomorphism. Since $G$ is an algebraic group over $\Fq$, it is a
  variety over $\Fq$ and thus $G(\Fq)$ is finite.
  Therefore $\trFrob{\qcs{L}}(g) = \rho_g(\Frob{})$ is a root of unity
  for every $g\in G(\Fq)$.  Since $\Weil{}$ is generated by
  $\Frob{}$ and $\rho_g : \Weil{} \to \EEx$ is
  a character, it follows that the image of $\rho_g$ is a finite group.
  Thus, $\rho_g$ extends to an $\ell$-adic character of $\Gal(\bFq/\Fq)$,
  which we will also denote $\rho_g$.
%
  We may now lift the $\ell$-adic character $\rho_g : \Gal(\bFq/\Fq) \to \EEx$
  to an $\ell$-adic character $\pi_1(G,\bg) \to \EEx$ using the canonical topological group homomorphism
  $\pi_1(G,\bg) \to \Gal(\bFq/\Fq)$. 
 % 
  The $\Fq$ rational point $g$ also
  determines an equivalence between the category of $\ell$-adic
  representations of $\pi_1(G,\bg)$ and $\ell$-adic local systems on $G$. Let
  $\qcs{L}_0$ be a local system on $G$ in the isomorphism class
  determined by this $\ell$-adic character of $\pi_1(G,\bg)$.
  Then $b_G^*\qcs{E} \iso \gqcs{L}$.
  
  Since $b_G^*$ is full and faithful
  \citelist{\cite{deligne-katz:SGA7.2}*{Expos\'e XIII} \cite{beilinson-bernstein-deligne:81a}*{Prop. 5.2.1}},
  $
  b_{G\times G}^* : \Hom(m^*\qcs{E},\qcs{E}\boxtimes\qcs{E}) \to \Hom({\bar m}^*\gqcs{L},\gqcs{L}\boxtimes\gqcs{L})
  $
  is a bijection
  (hom taken in the categories on constructible $\ell$-adic sheaves on
  $G\times G$ and ${\bar G}\times {\bar G}$ respectively,
  in which $\ell$-adic local systems sit as full subcategories).
  Let $\mu_\qcs{E} : m^*\qcs{E} \to \qcs{E}\boxtimes\qcs{E}$ be the isomorphism matching
  $\mu : {\bar m}^*\gqcs{L} \to \gqcs{L}\boxtimes\gqcs{L}$,
  the latter appearing in the definition of $\qcs{L}$.
  Then, as in Section~\ref{sec:bounded}, $(\qcs{E},\mu_\qcs{E})$ is an object in $\bQC(G)$
  and $\qcs{L} \ceq (\gqcs{L},\mu,\phi)$ is isomorphic to $(b_G^*\qcs{E},b_{G\times G}^*\mu_\qcs{E})$ in $\QC(G)$.
  Thus, the full and faithful functor $B_G : \bQC(G) \to \QC(G)$ from Section~\ref{sec:bounded}
  is also essentially surjective, hence an equivalence.
\end{proof}

\begin{proposition}\label{prop:connected}
 If $G$ is a connected, commutative algebraic group over $\Fq$ then:
 \begin{enumerate}
 \item $\TrFrob{G} : \QCiso{G} \to G(\Fq)^*$ is an isomorphism of groups;
 \item every quasicharacter sheaf on $G$ is isomorphic to one defined by a discrete isogeny;%as in Proposition~\ref{prop:finite};
 \item $\Aut(\qcs{L}) = 1$, for all quasicharacter sheaves $\qcs{L}$ on $G$;
  \item for all quasicharacter sheaves $\qcs{L}$, $\qcs{L}'$ on $G$ and for every $\rho \in \Hom(\qcs{L},\qcs{L}')$, either $\rho$ is trivial or an isomorphism.
 \end{enumerate}
 \end{proposition}

\begin{proof}
In Lemma~\ref{lem:bounded_connected} we saw that every quasicharacter sheaf $\qcs{L}$ on $G$ descends to $G$; let $\qcs{E}$ be an object in $\bQC(G)$ for which $B_G(\qcs{E}) \iso \qcs{L}$.
 Since the functor $B_G : \bQC(G) \to \QC(G)$ is full and faithful, $\Aut(\qcs{L}) = \Aut(\qcs{E})$.
From here, Deligne's function--sheaf dictionary for connected commutative algebraic groups over finite fields \citelist{\cite{deligne:SGA4.5}*{Sommes trig.}, \cite{laumon:87a}*{1.1.3}}  gives us all we need, as we briefly recall.
The key observation is that, by etale descent, pullback by the Lang isogeny $\Lang : G\to G$ defines an equivalence of categories from $\bQC(G)$ to the category of $1$-dimensional $\ell$-adic representations $V$ of $G(\Fq)$ equipped with an isomorphism $V \to V\otimes V$ such that the trace of $\Lang^*\qcs{E}$ is $\trFrob{\qcs{E}}^{-1}$ for every $\qcs{E}$ in $\bQC(G)$. 
Using the equivalence given by $\Lang^*$, if $\Lang^*\qcs{E} = V$ with character $\psi$ and isomorphism $V\to V\otimes V$ then 
$\qcs{E} \iso (\Lang_! V)_\psi$, the $\psi$-isotypic component of the push-forward $\Lang_* V$ ($\Lang$ is proper, so $\Lang_* = \Lang_!$) of the constant sheaf $V$ on $G$ equipped with an isomorphism $\mu_\qcs{E} : m^* \qcs{E} \to \qcs{E} \boxtimes\qcs{E}$ determined by $V\to V\otimes V$. 
Moreover, $\Aut(\qcs{E})$ is the group of automorphisms of $\rho : V\to V$ for which 
\[
\begin{tikzcd}
\arrow{d}{} V \arrow{r}{\rho} & V\arrow{d}{}\\
V\otimes V \arrow{r}{\rho\otimes \rho} & V\otimes V
\end{tikzcd}
\]
commutes. 
Since the only such isomorphism $\rho$ is $\id_V$, it follows that $\Aut(\qcs{E}) = 1$, completing the proof.
For the last part of the proposition, argue as in the analogous part of Proposition~\ref{prop:autornaught_etale}.
\end{proof}

We have just seen that, for a connected commutative algebraic group $G$ over $\Fq$, the category of quasicharacters $\qcs{L}$ on $G$ is equivalent to the category of characters $\psi$ of $G(\Fq)$.
We have also just seen if the character of $\Lang^*\qcs{L}$ is $\psi$ then the canonical isomorphism $m^*\psi \iso \psi \boxtimes \psi$ determines the isomorphism $\mu : \qcs{L} \to \qcs{L}\boxtimes\qcs{L}$ which is part of the data of the quasicharacter sheaf $\qcs{L}$. That leads to a perspective on the function--sheaf dictionary common in the literature in which one considers $1$-dimensional local systems $\qcs{L}$ on $G$ for which \emph{there exists} an isomorphism $m^*\qcs{L} \iso \qcs{L} \boxtimes\qcs{L}$ \cite{kamgarpour:09a}*{Introduction}, or sometimes, $1$-dimensional local systems $\gqcs{L}$ on $\bG$ for which \emph{there exists} an isomorphism $\Frob{G}^*\gqcs{L} \iso \gqcs{L}$ and an isomorphism $\bm^*\gqcs{L} \iso \gqcs{L} \boxtimes\gqcs{L}$.

%In the introduction to this paper we noted that, when working with connected commutative algebraic groups over finite fields, Deligne's dictionary can be described using Weil sheaves $\qcs{L}$ for which there exists an isomorphism $m^* \qcs{L} \iso \qcs{L} \boxtimes\qcs{L}$, without keeping track of the isomorphism.

Although the category of quasicharacter sheaves on commutative smooth group schemes $G$ over finite fields does specialize to that common notion when $G$ is connected and of finite type, that notion is not appropriate if one wishes to extend the dictionary to commutative smooth group schemes over finite fields. 
In particular, as we have already seen in Section~\ref{sec:etale}, for a given quasicharacter sheaf $\qcs{L} = (\gqcs{L},\mu,\phi)$ there may be a different isomorphism $\mu' : \bm^*\gqcs{L} \to \gqcs{L}\boxtimes\gqcs{L}$ for which $\qcs{L}'=(\gqcs{L},\mu',\phi)$ is also a quasicharacter sheaf on $G$, not isomorphic to $\qcs{L}$. 
Indeed, Proposition~\ref{prop:etale-iso} shows that $\Hh^0(\Weil{},\Hh^2(\bG,\EEx))$ measures the possibilities for such $\mu'$ when $G$ is etale.
We will see later in this section that, for any smooth commutative group scheme $G$, the possibilities for such $\mu'$ are measured by $\Hh^0(\Weil{},\Hh^2(\pi_0(\bG),\EEx))$.

\section{The function--sheaf dictionary for smooth, commutative group schemes}\label{sec:main}


\subsection{Restriction to the identity component} \label{sec:restriction}

Consider the short exact sequence
defining the component group scheme for $G$:
\begin{equation}\label{eq:pi0}
\begin{tikzcd}
0 \rar & G^0 \arrow{r}{\iota_0} & G \arrow{r}{\pi_0} & \pi_0(G) \rar & 0.
\end{tikzcd}
\end{equation}
Since $\pi_0(G)$ is a etale commutative group scheme, and this smooth,
Proposition~\ref{prop:pullback} implies that \eqref{eq:pi0} defines the sequence of functors
\begin{equation}\label{eq:pi1}
\begin{tikzcd}
\QC(0) \rar & \QC(\pi_0(G)) \arrow{r}{\pi_0^*} & \QC(G) \arrow{r}{\iota_0^*} & \QC(G^0) \rar & \QC(0)
\end{tikzcd}
\end{equation}
and therefore, after passing to isomorphism classes, the sequence of abelian groups
\begin{equation}\label{eq:pi2}
\begin{tikzcd}
0 \rar &
\QCiso{\pi_0(G)} \arrow{r}{\pi_0^*} & \QCiso{G} \arrow{r}{\iota_0^*} & \QCiso{G^0} \rar & 0.
\end{tikzcd}
\end{equation}
 Note that we found the groups $\QCiso{G^0}$
and $\QCiso{\pi_0(G)}$
in Sections~\ref{sec:connected} and \ref{sec:etale}, respectively.
In this section we show that \eqref{eq:pi2} is right exact.

%We say that a morphism $f : H\to G$ of commutative group $\Fq$-schemes is a {\it discrete isogeny} to $G$ if it is a finite, surjective \'etale morphism and
the action of $\Gal(\bFq/\Fq)$ on the \'etale group scheme $\ker f$ is trivial.

\begin{lemma}\label{lemma:ext}
Every discrete isogeny to $G^0$ extends to a discrete
isogeny to $G$ inducing an isomorphism on component groups.
\end{lemma}

\begin{proof}
Let $\pi: B \to G^0$ be a discrete isogeny and set $A \ceq \ker \pi$.
  We will find a discrete isogeny $f: H\to G$
  such that that $H^0 = B$, $f^0 =\pi$ and
  $\pi_0(f) : \pi_0(H)\to \pi_0(G)$ is an isomorphism of component
  groups.  Namely, we will fit $\pi$ into the following diagram,
  \begin{equation}\label{extension-diagram}
  \begin{tikzcd}
  A \arrow[equal]{r} \dar & A \dar \\
  B \rar \dar[swap]{\pi} & H \rar \dar[swap]{f} & \pi_0(H) \arrow{d}[below,rotate=90]{\sim}[swap]{\pi_0(f)} \\
  G^0 \rar & G \rar & \pi_0(G),
  \end{tikzcd}
  \end{equation}
  where all rows and columns are exact and all maps are defined over
  $\Fq$.  We will do so by passing back and forth between group
  schemes over $\Fq$ and their $\bFq$-points.

  Extensions of $G^0(\bFq)$ by $A(\bFq)$, such as $B(\bFq)$,
  correspond to classes in $\Ext^1_{\ZZ[\Weil{}]}(G^0(\bFq), A(\bFq))$.
  Similarly, extensions of $G(\bFq)$ by $A(\bFq)$ correspond to
  classes in $\Ext^1_{\ZZ[\Weil{}]}(G(\bFq), A(\bFq))$.  The map
  $G^0(\bFq) \to G(\bFq)$ induces the map
  \[
  \Ext^1_{\ZZ[\Weil{}]}(G(\bFq), A(\bFq)) \to \Ext^1_{\ZZ[\Weil{}]}(G^0(\bFq), A(\bFq))
  \]
  fitting into the long exact sequence derived from applying
  the functor $\Hom(\mbox{---}, A(\bFq))$ to $G^0(\bFq) \to G(\bFq) \to \pi_0(G)(\bFq)$:
  \[
  \Ext^1_{\ZZ[\Weil{}]}(G(\bFq), A(\bFq)) \to \Ext^1_{\ZZ[\Weil{}]}(G^0(\bFq), A(\bFq)) \to \Ext^2_{\ZZ[\Weil{}]}(\pi_0(G)(\bFq), A(\bFq)).
  \]
  Since $\Weil{} \cong \ZZ$ has cohomological dimension $1$ \cite{brown:CohomologyGrps}*{Ex. 4.3},
  $\Ext^2_{\ZZ[\Weil{}]}(\pi_0(G)(\bFq), A(\bFq))$ vanishes \cite{cartan-eilenberg:HomologicalAlgebra}*{Thm. 2.6}.

  We therefore have the existence of diagram \eqref{extension-diagram}
  at the level of $\bFq$-points.  This expresses $H(\bFq)$ as a
  disjoint union of translates of $B(\bFq)$; by transport of structure
  we may take $H$ to be a group scheme over $\bFq$.  Similarly, the
  restriction of $f$ to each component of $H$ is a morphism of
  schemes, and thus $f$ is as well.  Finally, the whole diagram
  descends to a diagram of $\Fq$-schemes since the $\bFq$-points of
  the objects come equipped with continuous $\Gamma$-actions and the
  morphisms are $\Gamma$-equivariant.
\end{proof}

In order to use the results of Section~\ref{sec:connected}, we need to know that
identity component of $G$ is actually an algebraic group.

\begin{lemma} \label{lem:G0alg-grp}
If $G$ is a commutative smooth group scheme over $\Fq$ then $G^0$ is a connected algebraic group.
\end{lemma}
\begin{proof}
 Since $G$ is a smooth group scheme over $\Fq$, its
 identity component $G^0$ of $G$ is a connected smooth,
 group scheme of finite type over $\Fq$, reduced over some finite extension of $\Fq$
 \cite{vdGeer-Moonen:AbelianVarieties}*{3.17}.
 Since $\Fq$ is a finite field and hence perfect, $G^0$ is actually reduced over $\Fq$
 \cite{EGAIV2}*{Prop 6.4.1}.  Since every group scheme over a field is separated
 \cite{vdGeer-Moonen:AbelianVarieties}*{3.12},
 it follows that $G^0$ is a connected algebraic group.
\end{proof}

\begin{proposition}\label{prop:restriction}
%For every quasicharacter sheaf $\qcs{L}^0$ on $G^0$ there is some finite quasicharacter sheaf
%$\qcs{L}$ on $G$ such that $\qcs{L}\vert_{G^0} \iso \qcs{L}^0$.
%As a consequence, t
The restriction functor $\iota_0^* : \QC(G)\to \QC(G^0)$ is essentially surjective.
\end{proposition}

\begin{proof}
  By Lemma~\ref{lem:G0alg-grp} and Proposition~\ref{prop:connected}, every
  quasicharacter sheaf on $G^0$ is isomorphic to $(\pi_! \EE)_\psi$ for some discrete isogeny $\pi : B \to G^0$ and character $\psi : \ker \pi \to \EEx$.
  So to prove the proposition it suffices to show that $(\pi_! \EE)_\psi$ extends to a quasicharacter sheaf on $G$.
%
 %Let $(\pi,\psi)$ be a finite quasicharacter sheaf on $G^0$.
 By Lemma~\ref{lemma:ext}, there is an extension of the
 discrete isogeny $\pi : B \to G^0$ to a discrete isogeny $f : H \to G$
 such that $\pi_0(f) : \pi_0(H)\to \pi_0(G)$ is an isomorphism.
 Then $(f_! \EE)_\psi$ is a quasicharacter sheaf on $G$ and
 $(f_! \EE)_\psi\vert_{G^0} \iso (\pi_! \EE)_\psi$.
\end{proof}

\subsection{The component group sequence} \label{sec:component}

\begin{lemma}\label{lem:extension}
The group homomorphism $\pi_0^*: \QCiso{\pi_0(G)} \to \QCiso{G}$ is injective.
\end{lemma}
\begin{proof}
Let $\qcs{L}$ be a quasicharacter sheaf on $\pi_0(G)$ and let $\rho : \pi_0^*\qcs{L} \to (\EE)_{G}$ be an isomorphism in $\QC(G)$. For each $x\in \pi_0(\bG)$, the restriction $\pi_0^*\gqcs{L}\vert_{\bG^x}$ is the constant sheaf $(\gqcs{L}_x)_{\bG^x}$ so the isomorphism $\rho_{\bG^x} : (\gqcs{L}_x)_{\bG^x} \to (\EE)_{\bG^x}$ determines an isomorphism $\rho_x : \gqcs{L}_x \to (\EE)_x$. The collection $\{ \rho_x \tq x\in \pi_0(\bG) \}$ determines an isomorphism $\qcs{L} \to (\EE)_{\pi_0(G)}$  in $\QC(\pi_0(G))$.
\end{proof}


\begin{proposition}\label{prop:middleexact}
 The sequence
 \[
  \begin{tikzcd}
  0 \rar & \QCiso{\pi_0(G)} \arrow{r}{\pi_0^*} & \QCiso{G} \arrow{r}{\iota_0^*} & \QCiso{G^0} \rar & 0.
  \end{tikzcd}
 \]
 is exact.
\end{proposition}

\begin{proof}
The sequence is exact at $\QCiso{G^0}$ by Proposition~\ref{prop:restriction}
and exact at $\QCiso{\pi_0(G)}$ by Lemma~\ref{lem:extension}.
Here we show that it is also exact at $\QCiso{G}$.
First note that $\iota_0^* \circ \pi_0^*$ is trivial by Proposition~\ref{prop:pullback}.
So it suffices to show that if $\qcs{L} = (\gqcs{L},\mu,\phi)$ is a quasicharacter sheaf on $G$
with $\qcs{L}\vert_{G^0} = (\EE)_{G^0}$ then $\qcs{L}$ is in the essential image of $\pi_0^*$.

For each $x\in \pi_0(\bG)$, set $\bG^x \ceq \pi_0^{-1}(x)$.
Let $g, g'$ be geometric points in the same
geometric connected component $\bG^x$.
Set $a = g^{-1}g'$ and note that $a$ is a geometric point in $\bG^0$.
Let $\mu_{g,a} : \gqcs{L}_{ga} \to \gqcs{L}_g \otimes \gqcs{L}_a$
be the isomorphism of vector spaces obtained by restriction of
$\mu : m^*\gqcs{L} \to \gqcs{L} \boxtimes \gqcs{L}$ to the
geometric point $(g,a)$ on $\bG^x \times \bG^0$.
Since $\qcs{L}\vert_{G^0} = (\EE)_{G^0}$,
the stalk of $\gqcs{L}$ at $a$ is $\EE$.
In this way the pair of geometric points $g, g' \in \bG^x$
determines an isomorphism $\varphi_{g,g'} \ceq \mu_{g,a}^{-1}$
from $\gqcs{L}_{g}$ to $\gqcs{L}_{g'}$.

The isomorphisms $\varphi_{g,g'}: \gqcs{L}_{g} \to \gqcs{L}_{g'}$ are canonical
in the following sense: if $g,g'\in \bG^x$ and $h,h'\in \bG^y$
then it follows from \ref{QC.2} and \ref{QC.3}
that
 \begin{equation}\label{eq:qc}
  \begin{tikzcd}[column sep=55]
   \gqcs{L}_{gh} \arrow{r}{\varphi_{gh,g'h'}} \arrow[swap]{d}{\mu_{g,h}}
  & \gqcs{L}_{g'h'} \arrow{d}{\mu_{g',h'}}
  &\arrow[draw=none]{d}[pos=.4,description]{\text{\normalsize{and}}}
  &  \gqcs{L}_{\Frob{}(g)} \arrow{r}{\varphi_{\Frob{}(g),\Frob{}(g')}} \arrow[swap]{d}{\phi_{g}} & \gqcs{L}_{\Frob{}(g')} \arrow{d}{\phi_{g'}} \\
  \gqcs{L}_{g} \otimes \gqcs{L}_{h} \arrow{r}{\varphi_{g,g'}\otimes \varphi_{h,h'}}
  & \gqcs{L}_{g'} \otimes \gqcs{L}_{h'}
  & {}
  & \gqcs{L}_{g} \arrow{r}{\varphi_{g,g'}} & \gqcs{L}_{g'}
  \end{tikzcd}
 \end{equation}
both commute.

For each $x\in \pi_0(\bG)$, pick $g(x)\in \bG^x$
and set $\gqcs{E}_x \ceq \gqcs{L}_{g(x)}$.
Let $\phi_x : \gqcs{E}_{\Frob{}(x)} \to \gqcs{E}_x$
be the isomorphism of $\EE$-vector spaces obtained by composing
$\varphi_{g(\Frob{}(x)),\Frob{}(g(x))} : \gqcs{L}_{g(\Frob{}(x))} \to \gqcs{L}_{\Frob{}(g(x))}$
with $\phi_{g(x)} : \gqcs{L}_{\Frob{}(g(x))} \to \gqcs{L}_{g(x)}$.
For each pair $x,y\in \pi_0(\bG)$
let $\mu_{x,y} : \gqcs{E}_{x+y}\to \gqcs{E}_x\otimes \gqcs{E}_y$
be the isomorphism of $\EE$-vector spaces obtained by composing
$\varphi_{g(x+y),g(x)g(y)} : \gqcs{L}_{g(x+y)} \to \gqcs{L}_{g(x)g(y)}$
with $\mu_{g(x),g(y)} : \gqcs{L}_{g(x)g(y)} \to \gqcs{L}_{g(x)}\otimes \gqcs{L}_{g(y)}$.
Using \eqref{eq:qc}, it follows that \ref{qc.1}, \ref{qc.2} and \ref{qc.3} are satisfied for
$\qcs{E} \ceq (\gqcs{E}_x, \mu_{x,y}, \phi_x)$, thus defining a quasicharacter sheaf on $\pi_0(G)$.

The pullback $\pi_0^*(\qcs{E})$ of $\qcs{E}$ along $\pi_0 : G \to \pi_0(G)$ is constant
on geometric connected components, with stalks given by
$(\pi_0^* \qcs{E})_g = \qcs{E}_{x}$ for all $g\in \bG^x$.  Thus both $\pi_0^*\qcs{E}$ and $\qcs{L}$
are constant on geometric connected components of $G$.
The choices above define isomorphisms
$\gqcs{L}\vert_{\bG^x} \to  (\gqcs{E}_{x})_{\bG^x}$ for each $x\in \pi_0(\bG)$.
The resulting isomorphism $\gqcs{L} \to \pi_0^* \gqcs{E}$ satisfies \ref{QC.4},
thus defining an isomorphism $\qcs{L} \to \pi_0^* \qcs{E}$ in $\QC(G)$.
\end{proof}

\subsection{The dictionary}
\label{sec:snake}

We saw in Proposition~\ref{prop:functorialG} that Trace of Frobenius
$\TrFrob{G} : \QCiso{G} \to G(\Fq)^*$ is a functorial group homomorphism.
In this section we improve that result.

\begin{theorem}\label{thm:snake}
  If $G$ is a smooth, commutative group scheme over $\Fq$ then
  \[
  \TrFrob{G} : \QCiso{G} \to G(\Fq)^*
  \]
is surjective with kernel canonically isomorphic to $\Hh^0(\Weil{},\Hh^2(\pi_0({\bar G}),\EEx))$.
\end{theorem}

\begin{proof}
  Recall the short exact sequence \eqref{eq:pi0}
  defining the component group scheme for $G$:
  \[
  \begin{tikzcd}
    1 \rar & G^0 \rar & G \rar & \pi_0(G) \rar & 0.
  \end{tikzcd}
  \]
  Let
  \[
  \begin{tikzcd}[row sep=20]
    0 \rar & \ker \TrFrob{\pi_0(G)} \arrow[dashed]{r} \dar & \arrow{d} \ker \TrFrob{G} \arrow[dashed]{r} & \ker \TrFrob{G^0} =0 \arrow[dotted, out=-10, in=170]{dddll} \dar & \\
    0 \rar & \QCiso{\pi_0(G)} \rar \dar{\TrFrob{\pi_0(G)}}
    & \QCiso{G} \rar \dar{\TrFrob{G}} & \QCiso{G^0} \rar \dar{\TrFrob{G^0}} & 0\\
    0 \rar & \pi_0(G)(\Fq)^* \rar \dar
    & \arrow{d} G(\Fq)^* \rar & G^0(\Fq)^* \rar \dar & 0\\
    & \coker \TrFrob{\pi_0(G)} =0 \arrow[dashed]{r} & \coker \TrFrob{G} \arrow[dashed]{r} &  \coker \TrFrob{G^0} =0 &
  \end{tikzcd}
  \]
  be the commutative diagram of abelian groups obtained by applying
  Proposition~\ref{prop:pullback} to \eqref{eq:pi0}.
 %
  The sequence of abelian groups
  \begin{equation}\label{eq:pi0k}
  \begin{tikzcd}
    1 \rar & G^0(\Fq) \rar & G(\Fq) \rar & \pi_0(G)(\Fq) \rar & 0,
  \end{tikzcd}
  \end{equation}
  is exact since $\Hh^1(\Fq,G^0) =0$ by Lemma~\ref{lem:G0alg-grp} and Lang's theorem on connected algebraic groups over finite fields \cite{lang:56a}.
  Since $\EEx$ is divisible, $\Hom_\text{Ab}(\ - \ ,\EEx)$ is exact and thus the dual sequence of
  character groups is also exact.
%
  The upper row is exact by Proposition~\ref{prop:middleexact}.
  Now Lemma~\ref{lem:G0alg-grp} and Proposition~\ref{prop:connected}
  imply that $\ker \TrFrob{G^0} =0$ and $\coker \TrFrob{G^0}=0$,
  while Proposition~\ref{prop:etale-iso} gives $\ker \TrFrob{\pi_0(G)} \iso \Hh^0(\Weil{},\Hh^2(\pi_0({\bar G}),\EEx))$
  and $\coker \TrFrob{\pi_0(G)}=0$.
%
It follows from the snake lemma that $\coker \TrFrob{G} =0$
and $\ker \TrFrob{\pi_0(G)} \to \ker \TrFrob{G}$ is an isomorphism.
\end{proof}

\todo{Insert comments on $\Hh^0(\Weil{},\Hh^2(\pi_0({\bar G}),\EEx))$. 
It is trivial if $G$ is an algebraic group with cyclic component group.
Lusztig}


\subsection{Morphisms of quasicharacters}

\begin{theorem}\label{thm:autornaught}
Let $G$ be a smooth commutative group scheme over $\Fq$.
For all quasicharacter sheaves $\qcs{L}$ and $\qcs{L}'$ on $G$,
every $\rho \in \Hom(\qcs{L},\qcs{L}')$ is either trivial or an isomorphism.
Moreover, $\Aut(\qcs{L}) \iso \Hom(\pi_0(\bG)_{\Weil{}},\EEx)$, canonically.
\end{theorem}
\begin{proof} 
For the first part of the proposition, argue as in the analogous part of Proposition~\ref{prop:autornaught_etale}.
For the second, fix $\qcs{L} = (\gqcs{L},\mu,\phi)$ and consider the homomorphism $\Aut(\qcs{L}) \to \Hom(\bG_{\Weil{}},\EEx)$ defined in Proposition~\ref{prop:autornaught_etale}.
This group homomorphism is clearly injective: if $\rho_x = \id_{\qcs{L}_x}$ for every $x\in \bG$ then $\rho = \id_{\qcs{L}}$.
Note that the image of $\Aut(\qcs{L}) \to \Hom(\bG_{\Weil{}},\EEx)$ is contained in $\Hom_\text{cts}(\bG_{\Weil{}},\EEx)$, where $\bG_{\Weil{}}$ is given the topology of the base of the espace Ã©talÃ© attached to $\gqcs{L}$.
Since $\ell$ is invertible in $\Fq$, it follows that $\Hom_\text{cts}(\bG_{\Weil{}},\EEx) = \Hom(\pi_0(\bG_{\Weil{}}),\EEx)$. 
Note that $\pi_0(\bG_{\Weil{}})=\pi_0(\bG)_{\Weil{}}$. 
To see that $\Aut(\qcs{L}) \to \Hom(\pi_0(\bG)_{\Weil{}},\EEx)$ is surjective, begin with $\theta\in\Hom(\pi_0(\bG)_{\Weil{}},\EEx)$ and, for each $[x] \in \pi_0(\bG)_{\Weil{}}$ define $\bar\rho^y: \gqcs{L}^y \to \gqcs{L}^y$ by scalar multiplication by $\theta([x])\in \EEx$ for each $y\in [x]$.
This defines an isomorphism $\bar\rho : \gqcs{L}\to \gqcs{L}$ of local systems on $\bG$ compatible with $\mu$ and $\phi$, and thus an isomorphism $\rho :\qcs{L}\to \qcs{L}$ with maps to $\theta$ under $\Aut(\qcs{L}) \to \Hom(\pi_0(\bG)_{\Weil{}},\EEx)$.
\end{proof}

\subsection{Base change}\label{sec:basechange}

When using quasicharacter sheaves to study characters, it is useful to understand
how quasicharacter sheaves behave under change of fields.
Let $k'$ be a finite extension of $k$. Then $k \hookrightarrow k'$ induces a group homomorphism
$i_{k'/k} : G(k) \hookrightarrow G(k')$ and thus a homomorphism
\begin{align*}
i_{k'/k}^* : G(k')^* &\to G(k)^* \\
\chi &\mapsto \chi\circ i_{k'/k}.
\end{align*}
We can interpret this operation on characters in terms of quasicharacter sheaves:

\begin{proposition} \label{prop:csbe}
Set $G_{k'} \ceq G\times_\Spec{k} \Spec{k'}$ and let
\[
\QC(\Res_{k'/k}(G_{k'})) \xrightarrow{\iota^*} \QC(G)
\]
be the functor obtained by pullback along the canonical closed immersion of $k$-schemes
$\iota : G \hookrightarrow \Res_{k'/k}(G_{k'})$
\cite{bosch-lutkebohmert-reynaud:NeronModels}*{\S 7.6}.
The following diagram commutes:
\[
\begin{tikzcd}
\QCiso{\Res_{k'/k}(G_{k'})} \arrow[two heads]{r}{\iota^*} \dar[swap]{\TrFrob{\Res_{k'/k}(G_{k'})}} & \QCiso{G} \dar{\TrFrob{G}} \\
G(k')^* \arrow[two heads]{r}{i_{k'/k}^*} & G(k)^*.
\end{tikzcd}
\]
\end{proposition}
\begin{proof}
This result follows immediately from Proposition~\ref{prop:pullback} together with the identifications
\[
\Res_{k'/k}(G_{k'})(k) \cong G_{k'}(k') \cong G(k')
\]
from the definitions of Weil restriction and base change.
\end{proof}

In the opposite direction, let $\Nm : G(k') \to G(k)$ be the norm map and consider the group homomorphism:
\begin{align*}
\Nm^* : G(k)^* &\to G(k')^* \\
\chi &\mapsto \chi\circ \Nm.
\end{align*}
We can also interpret this operation on characters in terms of quasicharacter sheaves.

If $\qcs{L} \ceq (\gqcs{L}, \mu, \phi)$ is a quasicharacter sheaf on $G$, we define
a quasicharacter sheaf $\qcs{L}' \ceq (\gqcs{L}, \mu, \phi_{k'})$ on the base change
$G_{k'}$ of $G$ to $k'$ by setting
\[
\phi_{k'} \ceq \phi \circ \Frob{G}^*(\phi) \circ \cdots \circ (\Frob{G}^{n-1})^*(\phi).
\]
The commutativity of the diagram (QC.3) for $\phi_{k'}$
follows from the fact that $\Frob{G_{k'}} = \Frob{G}^n$.
Note that we may also think about the construction of $\phi_{k'}$ from $\phi$
as taking the action $\varphi$ of $\Weil{k}$ on $\gqcs{L}$
defined in Section~\ref{sec:category} and restricting it to the subgroup $\Weil{k'}$.

\begin{proposition}\label{prop:basechange}
With notation above,
the rule $\nu_{k'/k}: (\gqcs{L}, \mu, \phi) \mapsto (\gqcs{L}, \mu, \phi_{k'})$
 defines a monoidal functor $\QC(G) \to \QC(G_{k'})$.
 Moreover, the following diagram commutes:
\[
\begin{tikzcd}[column sep=60]
\QCiso{G} \rar{\nu_{k'/k}} \dar{\TrFrob{G}} & \QCiso{G_{k'}} \dar{\TrFrob{G_{k'}}} \\
G(k)^*  \rar{\Nm^*} & G(k')^*.
\end{tikzcd}
\]
\end{proposition}

\begin{proof}
Let $\qcs{L} \ceq (\gqcs{L}, \mu, \phi) \in \QC(G)$ and write $F$ for $\Frob{G}$.  For any $x \in G(k')$,
we may compute the value of $t_{G_{k'}}(\nu_{k'/k}\qcs{L})(x)= t_{\nu_{k'/k}\qcs{L}}(x)$ as the trace of $\phi_{k'}$ on $\gqcs{L}_x$,
and the value of $\Nm^*(\TrFrob{G}(\qcs{L}))(x)$ as the trace of $\phi$ on $\gqcs{L}_{\Nm(x)}$.
Applying \ref{QC.3} to the stalk of $\gqcs{L}^{\boxtimes n}$ at the point $(x, \Frob{}(x), \ldots, \Frob{}^{n-1}(x))$ yields a diagram
\[
\begin{tikzcd}
\gqcs{L}_{\Nm(x)} \rar \dar{\phi_{\Nm(x)}} & \gqcs{L}_{F(x)} \otimes \gqcs{L}_{F^2(x)} \otimes \cdots \otimes \gqcs{L}_x
\dar{\phi_x \otimes (F^*\phi)_x \otimes \cdots \otimes ((F^{n-1})^*\phi)_x} \\
\gqcs{L}_{\Nm(x)} \rar & \gqcs{L}_x \otimes \gqcs{L}_{F(x)} \otimes \cdots \otimes \gqcs{L}_{F^{n-1}(x)}.
\end{tikzcd}
\]
Choose a basis vector $v$ for $\gqcs{L}_{\Nm(x)}$ and write the image of $v$ under the
bottom map as $v_0 \otimes v_1 \otimes \cdots \otimes v_{n-1}$
for $v_i \in \gqcs{L}_{\Frob{}^i(x)}$.  By \ref{QC.2}, $v$ maps to
$v_1 \otimes v_2 \otimes \cdots \otimes v_0$ along the top of the diagram.
Let $\alpha_i \in \EEx$ represent $((F^i)^*\phi)_x$ with respect to these bases and let $\alpha$ be
the trace of $\phi_{\Nm(x)}$.  We may now equate the trace $\alpha$ of $\phi$ on $\gqcs{L}_{\Nm(x)}$
with the product $\alpha_0 \cdots \alpha_{n-1}$, which is the trace of $\phi_{k'}$ on $\gqcs{L}_x$.
\end{proof}

Finally, let $G'$ be a smooth commutative group scheme over $k'$;
we explain how to geometrize the canonical isomorphism between characters of $G'(k')$ and of $(\Res_{k'/k}G')(k)$.
We may decompose the base change $(\Res_{k'/k}G')_{k'}$ of $\Res_{k'/k}G'$ to $k'$
into a product of copies of $G'$, indexed by elements of $\Gal(k'/k)$:
\[
(\Res_{k'/k}G')_{k'} \cong \prod_{\Gal(k'/k)} G'.
\]
Since products and coproducts agree for group schemes we have a natural inclusion of $k'$-schemes
\[
G' \hookrightarrow (\Res_{k'/k}G')_{k'}
\]
mapping $G'$ into the summand corresponding to $1 \in \Gal(k'/k)$.  Composing $\nu_{k'/k}$
from Proposition~\ref{prop:basechange} with pullback along this map yields a functor
\[
\rho : \QC(\Res_{k'/k}G') \to \QC(G').
\]

\begin{proposition}
Let $k'/k$ be a finite extension and let $G'$ be a smooth commutative group scheme over $k'$.
The following diagram of isomorphisms commutes, where the bottom map is the identity:
\[
\begin{tikzcd}
\QCiso{\Res_{k'/k} G'} \dar{\TrFrob{\Res_{k'/k} G'}} \rar{\rho} & \QCiso{G'} \dar{\TrFrob{G'}}\\
G'(k')^* \rar & G'(k')^*
\end{tikzcd}
\]
\end{proposition}
\begin{proof}
By Proposition~\ref{prop:pullback} the pullback part of the definition of $\rho$ corresponds to the map
\[
(\Res_{k'/k}G')(k') \to G'(k')^*
\]
induced by $g \mapsto (g, 1, \ldots, 1)$.  Since the action of $\Gal(k'/k)$ on
\[
(\Res_{k'/k}G')_{k'} \cong \prod_{\Gal(k'/k)} G'
\]
is given by permuting coordinates, composition with the norm map yields the identity on $G'(k')$.
\end{proof}

\todo{Can we improve on this result by proving that $\rho$
is an equivalence of categories?}


\section{Applications}\label{sec:applications}% to algebraic tori and Abelian varieties over \texorpdfstring{$p$}{p}-adic fields}

Let $K$ be a local field (in the sense of Serre) with residue field $\Fq$. 
In this section we consider connected smooth commutative algebraic groups over $K$ that admit a NÃ©ron model, by which we means a perhaps lft NÃ©ron model.
By \cite{bosch-lutkebohmert-reynaud:NeronModels}*{\S 10.2, Thm 2}, these are precisely the connected smooth commutative algebraic groups over $K$ that contain no subgroup of type $\mathbb{G}_\text{a}$.
We remark that these connected commutative algebraic groups over $K$ form an additive category in a natural way, as a full subcategory of connected commutative algebraic groups over $K$, and that this category includes algebraic tori over $K$ and Abelian varieties over $K$.

Let $R$ be the ring of integers of $K$.
Write $\m$ for the maximal ideal of $R$ and set $R_n = R/\m^{n+1}$, for every non-negative integer $n$.
Let $X_K$ be a connected smooth commutative algebraic groups over $K$ that admit a NÃ©ron model, $X$.
A {\it quasicharacter of $X_K(K)$} is a group homomorphism $X_K(K) \to \EEx$ that factors through $X_K(X) \to X(R_n)$, for some non-negative integer $n$;
the group of quasicharacters of $X_K(K)$ will be denoted by $\Hom_\text{qc}(X_K(K),\EEx)$ and the subgroup of those that factor through $X(R_n)$ will be denoted by $\Hom_n(X_K(K),\EEx)$.
%
In this section we explain how to geometrize and categorify quasicharacters of $X_K(K)$ using quasicharacter sheaves.

\subsection{Review of the Greenberg transform}

Let $K$, $R$ and $R_n$ be as above.
Set $S = \Spec{R}$.
For every non-negative integer $n$,  and $S_n = \Spec{R_n}$;  
note that $S_0 = \Spec{\Fq}$ is the special fibre of $S$.

We will need the Greenberg functor, which is
a functor from the category of schemes 
over an Artinian local ring with perfect residue field
to the category of schemes over the residue field;
See \cite{bertrapelle-gonzales:Greenberg} for the definition and fundamental properties of the Greenberg functor as we use it; other important references include
\citelist{
\cite{greenberg:61}, \cite{greenberg:63a},
\cite{demazure-gabriel:GroupesAlgebriques}*{V, \S 4, no. 1},
\cite{bosch-lutkebohmert-reynaud:NeronModels}*{Ch. 9, \S 6},
\cite{nicaise-sebag:motivicSerre}*{\S 2.2}
}.
This functor respects open immersions, closed immersions, \'etale morphisms, smooth morphisms and geometric components.

For any $n\in \NN_0$, we will write
\[
\Gr^R_n : \partop{\text{Schemes}}{\text{lft over $R$}} \to \partop{\text{Schemes}}{\text{lft over $\Fq$}}
\]
for the functor produced by composing pullback along $S_n \to S$ with the Greenberg functor. 
This functor respects open immersions, closed immersions, \'etale morphisms, smooth morphisms and geometric components, and
\[
\Gr^R_n(X)(\Fq) \iso X(R_n),
\]
canonically, for any $X$ lft over $R$.

For any $n\leq m$,  the surjective ring homomorphism $R_{m} \to R_n$ determines a
natural transformation $P^R_{n\leq m} : \Gr^R_{m} \to \Gr^R_n$ between additive functors.
Crucially, $P^R_{n\leq m}(X): \Gr^R_{m}(X)\to \Gr^R_n(X)$ is an affine morphism of $\Fq$-schemes, for every $R$-scheme $X$ and every $n\leq m$ \cite{bertrapelle-gonzales:Greenberg}*{Prop 4.3}.
This observation is key to the proof that, for any $X$ lft over $S$, the projective limit 
\[
\Gr_R(X) \ceq \varprojlim_{n\in \NN_0} \Gr^R_n(X)
\]
taken with respect to the surjective morphisms $P^R_{n\leq m}(X) : \Gr^R_{m}(X) \to \Gr^R_n(X)$,
exists in the category of group schemes over $\Fq$.
This leads to the definition of what we shall call the {\it Greenberg transform}:
\[
\Gr_R : \partop{\text{Schemes}}{\text{lft over $R$}} \to \partop{\text{Schemes}}{\text{lft over $\Fq$}}.
\]
By construction, the $\Fq$-scheme $\Gr_R(X)$ comes equipped with morphisms 
\[
P^R_n(X) : \Gr^R(X) \to \Gr^R_n(X),\qquad \forall n\in \NN_0.
\]
The Greenberg transform respects open immersions, closed immersions, \'etale morphisms, smooth morphisms and geometric components, and
\[
\Gr_R(X)(\Fq) \iso X(R),
\]
canonically, for any $X$ lft over $R$.

\subsection{Quasicharacter sheaves on the Greenberg transform of a NÃ©ron model}
 
Let $G$ be a commutative group scheme over $\Fq$.
Consider the category $\mathcal{C}(G)$ of triples
$\qcs{F}\ceq (\gqcs{F},\mu_\qcs{F},\phi_\qcs{F})$ where
\begin{enumerate}
\labitem{(C.0)}{C.0} $\gqcs{F}$ is a rank one $\ell$-adic local system on $\bG\ceq G \times_\Spec{\Fq} \Spec{\bFq}$,
\labitem{(C.1)}{C.1} $\mu_\qcs{F}: \bm^* \gqcs{F} \to \gqcs{F}\boxtimes\gqcs{F}$ is an isomorphism $\ell$-adic sheaves, where $\bm : \bG \times \bG \to \bG$ is multiplication $m$ for $G$ extended to $\bG$.
\labitem{(C.2)}{C.2} $\phi_\qcs{F} : \Frob{G}^* \gqcs{F} \to \gqcs{F}$ is an isomorphism of constructible $\ell$-adic sheaves, where $\Frob{G}^* : \bG  \to \bG$ is Frobenius,
\end{enumerate}
subject to the conditions as in \ref{QC.1} and \ref{QC.2},
with morphisms defined as in \ref{QC.3}.
This category $\mathcal{C}(G)$ is rigid monoidal, with tensor product defined as in Definition~\ref{def:QC}. Note that $\mathcal{C}(G) = \QC(G)$ if $G$ is also smooth.

The Greenberg transform $\Gr_R(X)$ of $X$ is commutative group scheme over $\Fq$ with component group scheme
\[
\pi_0(\Gr_R(X))= \pi_0(X) \times_S S_0
\]
and $\Fq$-rational points
\[
\Gr_R(X)(\Fq)\iso X_K(K),
\]
canonically.
For every $n\in \NN_0$,
$\Gr^R_n(X)$ is {\it smooth} commutative group scheme over $\Fq$
with component group scheme
$\pi_0(\Gr^R_n(X))= \pi_0(X) \times_S S_0$.
%
For every non-negative integer $n$, the morphism of $\Fq$-schemes $P^R_n(X) : \Gr_R(X) \to \Gr^R_n(N)$ induces a functor
\[
P^R_n(X)^* : \QC(\Gr^R_n(X)) \to \mathcal{C}(\Gr_R(X)),
\]
as in Proposition~\ref{prop:pullback}.
This functor is full and faithful, so we may view $\QC(\Gr^R_n(X))$ as a full subcategory of $\mathcal{C}(\Gr_R(X))$.

\begin{definition}
A {\it quasicharacter sheaf on $\Gr_R(X)$} is an object $\qcs{F}$ in $\mathcal{C}(\Gr_R(X))$ such that $\qcs{F} \iso P^R_n(X)^*\qcs{L}$ for some quasicharacter sheaf $\qcs{L}$ on $\Gr^R_n(X)$.
Quasicharacter sheaves on $\Gr_R(X)$ form a rigid monoidal category in the obvious way, denoted by $\QC(\Gr_R(X))$.
\end{definition}

%Note that we may informally regard $\QC(\Gr_R(X))$ a `union' of the full subcategories $\QC(\Gr^R_n(X))$ in $\mathcal{C}(\Gr_R(X))$.

\begin{theorem}\label{thm:QCXK}
Let $K$ and $R$ be as above.
The trace of Frobenius provides a natural transformation between the additive functors
\[
F_{\QC}: X_K \mapsto \QCiso{\Gr_R(X)}
\qquad\text{and}\qquad
F_{\text{qc}}: X_K \mapsto \Hom_{\text{qc}}(X_K(K),\EEx)
\]
where $X$ is a Neron model for $X_K$, as functors from the additive category of connected commutative algebraic groups over $K$ that admit Neron models to the category of abelian groups. 
Regarding this natural transformation:
\begin{enumerate}
\item[(1)] there is a canonical short exact sequence of abelian groups 
\[
0 \to \Hh^2(\pi_0(X)_{\bFq},\EEx)^{\Frob{}} \to \QCiso{\Gr_R(X)} \to \Hom_\text{qc}(X_K(K),\EEx) \to 0;
\] 
\item[(2)] for all quasicharacter sheaves $\qcs{F}$, $\qcs{F}'$ on $\Gr_R(X)$, and for every $\rho \in \Hom(\qcs{F},\qcs{F}')$, either $\rho$ is trivial or $\rho$ is an isomorphism;
\item[(3)] for all quasicharacter sheaves $\qcs{F}$ on $\Gr_R(X)$,
\[
\Aut(\qcs{F}) \iso \Hom((\pi_0(X)_{\Fq})_{\Weil{}},\EEx),
\]
canonically.
\end{enumerate}
\end{theorem}

\begin{proof}
To begin, fix $n\in \NN$.
The following statements follow directly from Theorems~\ref{thm:snake} and \ref{thm:autornaught} together with our observations about the component group of $\Gr^R_n(X)$.
\begin{enumerate}
\item[(1)] There is a canonical short exact sequence of abelian groups 
\[
0 \to \Hh^2(\pi_0(X)_{\bFq},\EEx)^{\Frob{}} \to \QCiso{\Gr^R_n(X)} \to \Hom(X(R_n),\EEx) \to 0.
\] 
\item[(2)] For all quasicharacter sheaves $\qcs{L}$, $\qcs{L}'$ on $\Gr^R_n(X)$ and for every $\rho \in \Hom(\qcs{L},\qcs{L}')$, either $\rho$ is trivial or $\rho$ is an isomorphism.
\item[(3)] For all quasicharacter sheaves $\qcs{L}$ on $\Gr^R_n(X)$,
\[
\Aut(\qcs{L}) \iso \Hom((\pi_0(X)_{\Fq})_{\Weil{}},\EEx),
\]
canonically.
\end{enumerate}
So Theorem~\ref{thm:QCXK} now follows from the fact that each $\QC(\Gr^R_n(X))$ is a full subcategory of $\QC(\Gr_R(X))$ and the observation that $\QC(\Gr_R(X))$ a `union' of the subcategories $\QC(\Gr^R_n(X))$ in $\mathcal{C}(\Gr_R(X))$.
\end{proof}

\subsection{Natural transformation}

We have just seen that if $X_K$ is a connected commutative algebraic group $X_K$ over a local field $K$ that admits a Neron model $X$ over $R$, then the category of   quasicharacter sheaves on the Greenberg transform of the Neron model $X$ provides a geometrization and categorification of quasicharacters of $X_K(K)$. 

It is known that all Abelian varieties over local fields and all algebraic tori over local fields admit Neron models. In those two cases, we can improve Theorem~\ref{thm:QCXK} slightly with the following addendum.

\begin{proposition}\label{prop:natural_transformation}
Let $K$ be a local field with ring of integers $R$ and residue field $\Fq$.
Let $\mathcal{N}/K$ be the additive category of Abelian varieties over $K$ or the  additive category of algebraic tori over $K$.
Then the trace of Frobenius provides a natural transformation between the additive functors
\begin{enumerate}
\item[$F_{\QC}$:] $X_K \mapsto \QCiso{\Gr_R(X)}$
\item[$F_{\text{qc}}$:] $X_K \mapsto \Hom_{\text{qc}}(X_K(K),\EEx)$
\end{enumerate}
from the additive category $\mathcal{N}/K$ to the category of abelian groups.
\end{proposition}


\subsection{Weil restriction and quasicharacters}\label{sec:wrK}

Let $K'/K$ be a finite Galois extension of local fields and
let $k'/k$ be the corresponding extension of residue fields.
Let $R$ and $R'$ be the rings of integers of $K$ and $K'$, respectively.
Let $X_K$ be a connected commutative algebraic group over $K$
that admits a NÃ©ron model $X$ over $R$.
Set $X_{K'} \ceq X_K \times_\Spec{K} \Spec{K'}$
and $X' \ceq X \times_\Spec{R} \Spec{R'}$.

\begin{proposition}\label{prop:wrK}
The canonical closed immersion 
\[
X_K \hookrightarrow \Res_{K'/K} X_{K'}
\]
of $K$-group schemes
induces a map of $\Fq$-group schemes 
\[
f : \Gr_R(X) \to \Res_{k'/k} \Gr_{R'}(X')
\] 
such that the functor
\[
f^* : \QC(\Gr_R(X)) \to \QC(\Res_{k'/k} \Gr_{R'}(X'))
\]
induces
\[
\begin{tikzcd}[column sep=60]
\Hom_{\text{qc}}(X_K(K'), \EEx) \arrow{r}{\chi \mapsto \chi\vert_{X_K(K)}} &\Hom_{\text{qc}}(X_K(K), \EEx).
\end{tikzcd}
\]
\end{proposition}

\begin{proof}
Adapting the argument in \cite{bosch-lutkebohmert-reynaud:NeronModels}*{\S 7.6, Prop 6} to include locally finite type NÃ©ron models,
one may show that $\Res_{R'/R}(X')$ is a NÃ©ron model for $\Res_{K'/K}(X_{K'})$.
By the NÃ©ron mapping property, the canonical closed immersion
\[
X_K\hookrightarrow \Res_{K'/K}(X_{K'})
\]
 extends uniquely to a morphism
\[
X\to \Res_{R'/R}(X')
\]
 of smooth $R$-group schemes.

Applying the functor $\Gr_{n}$ to this morphism
and using \cite{bertrapelle-gonzales:Greenberg}*{Thm 1.1} defines the morphism of smooth group schemes
\begin{equation}\label{men}
f_n: \Gr_{n-1}^R(X) \to \Res_{k'/k} \Gr_{en-1}^{R'}(X')
\end{equation}
Since 
\[
\left(\Res_{k'/k} \Gr_{en-1}^{R'}(X') \right)(\Fq) = \left(\Gr_{en-1}^{R'}(X')\right)(k'),
\]
the pullback functor 
\[
f_n^* : \QC(\Res_{k'/k} \Gr_{en-1}^{R'}(X'))\to \QC(\Gr_{n-1}^{R}(X))
\]
obtained by applying Proposition~\ref{prop:pullback} to \eqref{men} gives
\[
\Hom(X(R'_{en}),\EEx) \to \Hom(X(R_n),\EEx).
\]
Passing to the projective limit, the family of morphisms \eqref{men} determines a morphism of group schemes
\[
f: \Gr_R(X) \to \Res_{k'/k} \Gr_{R'}(X').
\]
which induces the functor
\[
f^* : \QC(\Res_{k'/k} \Gr_{R'}(X'))\to \QC(\Gr_{R}(X))
\]
inducing
\[
\Hom_{\text{qc}}(T(K'),\EEx) \to \Hom_{\text{qc}}(T(K),\EEx).
\]
Argue as in Proposition~\ref{prop:csbe} to see that this is indeed restriction of characters.
\end{proof}

\subsection{Transfer of quasicharacters}\label{sec:transfer}

Let $K$ and $K'$ be local fields with rings of integers $R$ and $R'$ and residue fields $k$ and $k'$, respectively. Set $S = \Spec{S}$ and $S_n = \Spec{R_n}$; likewise define $S' = \Spec{R'}$ and $S'_{n'} = \Spec{R'_{n'}}$.

Let $X_K$ and $X'_{K'}$ be connected commutative algebraic groups over $K$ and $K'$, respectively, that admit NÃ©ron models $X$ and $X'$ over $R$ and $R'$, respectively.
Suppose $m$ and $m'$ are non-negative integers such that 
\begin{equation}\label{eq:schematic_transfer}
R_m \iso R'_{m'}
\qquad
\text{and}
\qquad
X \times_{S} S_m \iso X' \times_{S'} S'_{m'}.
\end{equation}
as smooth group schemes over $R_m$. 
Then
$
\Gr^R_m(X) \iso \Gr^{R'}_{m'}(X')
$
as smooth group schemes over $\Fq$; accordingly, by Proposition~\ref{prop:pullback} the isomorphism above determines an equivalence of categories
\begin{equation}\label{eq:categorical_transfer}
\QC(\Gr^R_m(X)) \cong \QC(\Gr^{R'}_{m'}(X'))
\end{equation}
which induces a group isomorphism
$
\QCiso{\Gr^R_m(X)} \cong \QCiso{\Gr^{R'}_{m'}(X')}
$
and thence, by trace of Frobenius, an isomorphism
\begin{equation}\label{eq:transfer}
\Hom_m(X_K(K),\EEx) = \Hom(X(R_m),\EEx) \iso \Hom(X'(R'_{m'}),\EEx) = \Hom_{m'}(X'_{K'}(K'),\EEx).
\end{equation}
Recall that $\Hom_m(X_K(K),\EEx)$ is a subgroup of $\Hom_\text{qc}(X_K(K),\EEx)$ and $\Hom_{m'}(X'_{K'}(K'),\EEx)$ is a subgroup of $\Hom_\text{qc}(X_K(K),\EEx)$.
The isomorphism \eqref{eq:transfer} is an instance of {\it transfer} of certain quasicharacters between $X_K(K)$ and $X_{K'}(K')$. 
When it exists, we now recognize this transfer of quasicharacters as a consequence of the equivalence of categories of quasicharacter sheaves \eqref{eq:categorical_transfer}.

Such a relationship can exist between quasicharacters of algebraic tori over local fields, even when the characteristics of $K$ and $K'$ differ.
Suppose $T$ and $T'$ are tori over non-archimedian local fields $K$ and $K'$,
splitting over $L$ and $L'$ respectively.
Then $T$ and $T'$ are said to be \emph{$N$-congruent} \cite{chai-yu:01a}*{\S 2} if there are isomorphisms
 \begin{align*}
  \alpha : \OL/\pi_K^N \OL &\to \OO{L'}/\pi_{K'}^N \OO{L'} \\
  \beta : \Gal(L/K) &\to \Gal(L'/K') \\
  \phi : X^*(T) &\to X^*(T')
 \end{align*}
 satisfying the conditions
 \begin{enumerate}
  \item $\alpha$ induces an isomorphism $\OK/\pi_K^N \OK \to \OO{K'}/\pi_{K'}^N \OO{K'}$,
  \item $\alpha$ is $\Gal(L/K)$-equivariant relative to $\beta$, and
  \item $\phi$ is $\Gal(L/K)$-equivariant relative to $\beta$.
 \end{enumerate}
If $T$ and $T'$ are $N$-congruent then $\alpha$, $\beta$ and $\phi$ determine an isomorphism 
\begin{equation}\label{transfer}
  \Hom_N(T(K), \EEx) \iso \Hom_N(T'(K'),\EEx).
\end{equation}
Note that if $T$ and $T'$ are $N$-congruent, then they are $N'$ congruent for every
$N' \leq N$, the isomorphism \eqref{transfer} is level-preserving at integers less than $N$.
%
One of the main results of \cite{chai-yu:01a} gives an isomorphism of group schemes between the
$\underline{T} \times_S S_n$ and $\underline{T}' \times_{S'} {S'}_n$ assuming that $T$ and $T'$ are sufficiently congruent.
They define a quantity $h$ as the smallest integer so that $\pi^h$ lies in the
Jacobian ideal associated to a natural embedding of $T$ into an induced torus \cite{chai-yu:01a}*{\S 8.1}.
Then it follows from \cite{chai-yu:01a}*{Thm. 8.5} that if $N > 3h$ and $T$ and $T'$ are $N$-congruent
then there is a canonical isomorphism of smooth group schemes
 $
  \TT_{N-3h} \to \TT'_{N-3h}
 $
 determined by $\alpha, \beta$ and $\phi$.
Combining this with the paragraph above gives an instance of the geometrization and categorification of the transfer of characters.

\begin{proposition}\label{prop:transfer}
 With notation above, suppose that $T$ and $T'$ are $N$-congruent and $N > 3h$.  Set $m \ceq N-3h$.
 Then there is a canonical equivalence of categories
 \[
 \QC(\Gr^{R}_m(\underline{T})) \to \QC(\Gr^{R'}_m(\underline{T}'))
 \]
 determined by $\alpha, \beta$ and $\phi$ inducing an isomorphism
 \[
\Hom_m(T(K), \EEx) \to  \Hom_m(T'(K'), \EEx)
 \]
 through the trace of Frobenius,  compatible with \eqref{transfer}.% ($m < N$).
\end{proposition}


\bibliographystyle{amsalpha}
\bibliography{bibliography/Biblio}

\end{document}


\begin{table}[ht]
\caption{A big diagram}
\begin{center}
{\smaller\smaller\smaller
    \[
  \begin{tikzcd}[row sep=20, column sep=3]
&   &  0 \arrow{dd} && 0 \arrow{dd} && 0\arrow{dd} & \\
& &&  0 \arrow[crossing over]{dd} && 0 \arrow[crossing over]{dd} && 0\arrow{dd} & & \\
&   {}& \ker \TrFrob{C} \arrow[->>]{rr} \arrow[>->>]{dr} \arrow{dd} && \arrow{dd} \ker \TrFrob{B} \arrow{rr} \arrow[>->]{dr}  && \ker \TrFrob{A}=0 \arrow[>->>]{dr} \arrow{dd} \arrow{rr} && 0 & \\
& && \Hh^0(\Weil{},\Hh^2(C,\EEx)) \arrow[crossing over,->>]{rr} \arrow[crossing over]{dd} && \Hh^0(\Weil{},\Hh^2(B,\EEx)) \arrow[crossing over]{rr} \arrow[crossing over]{dd} && \Hh^0(\Weil{},\Hh^2(A,\EEx)) \arrow[crossing over]{dd}  &  &  \\
0  \arrow{rr} & & \QCiso{C} \arrow[>->>]{dr}\arrow{rr} \arrow{dd}%{\TrFrob{C}}
    && \QCiso{B} \arrow[>->]{dr} \arrow{rr} \arrow{dd}%{\TrFrob{B}}
    && \QCiso{A} \arrow[>->>]{dr} \arrow{dd}%{\TrFrob{A}}
    \arrow{rr}  &   & 0 & \\
& \Hh^1(E^\bullet_{A}) \arrow[crossing over]{rr}  && \Hh^2(E^\bullet_{C}) \arrow[crossing over]{rr} \arrow[crossing over]{dd} && \Hh^2(E^\bullet_{B}) \arrow[crossing over]{rr} \arrow[crossing over]{dd} && \Hh^2(E^\bullet_{A}) \arrow{rr} \arrow[crossing over]{dd} &  & \Hh^3(E^\bullet_{C}) \\
0  \arrow{rr} & & C(\Fq)^* \arrow[>->>]{dr} \arrow{rr} \arrow{dd}
    && \arrow{dd} B(\Fq)^* \arrow[>->>]{dr} \arrow{rr} && A(\Fq)^* \arrow[>->>]{dr}  \arrow{dd}
    \arrow{rr}&& 0 & \\
& %\Hh^2(\Weil{},\Hh^1({\bar A},\EEx)) \arrow{rr}
 && \Hh^1(\Weil{},\Hh^1(C,\EEx)) \arrow[crossing over]{dd} \arrow[crossing over]{rr}  && \Hh^1(\Weil{},\Hh^1(B,\EEx)) \arrow[crossing over]{dd} \arrow[crossing over]{rr} && \Hh^1(\Weil{},\Hh^1(A,\EEx)) \arrow[crossing over]{dd}  &  & %\Hh^0(\Weil{},\Hh^1({\bar C},\EEx))
 \\
& & 0  && 0  &&  0  && & \\
 &      &&  0 && 0 && 0 & & \\
  \end{tikzcd}
  \]
}
\end{center}
\label{diagram}
\end{table}


%sagemathcloud={"zoom_width":105}
