% !TEX encoding = UTF-8 Unicode
\documentclass[11pt]{amsart}
\title[Sheaf--function dictionary for local tori]{A sheaf--function dictionary for algebraic tori over local fields}
\usepackage[british]{babel}
\usepackage{datetime}
\date{\today}
\author{Clifton Cunningham}
\address{University of Calgary}
\email{cunning@math.ucalgary.ca}
\author{David Roe}
\address{Pacific Institute for the Mathematical Sciences at the University of Calgary}
\email{roed.math@gmail.com}
\usepackage[utf8]{inputenc}
\renewcommand{\baselinestretch}{1.2}
%\usepackage[notcite]{showkeys}
\usepackage{hyperref}
\usepackage{geometry}
\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{amssymb}
%\usepackage[shortalphabetic]{amsrefs}
\usepackage[alphabetic]{amsrefs}
\newcommand\SortNoop[1]{}
\DeclareRobustCommand{\VAN}[3]{#2}
%\usepackage{amsrefs}
\renewcommand\MR{\relax}
%\usepackage{xypic}
\usepackage{textcomp}
\usepackage{mathrsfs}
\usepackage{yfonts}
\newcommand{\mathswab}[1]{\operatorname{\textswab{#1}}}
\usepackage[T1]{fontenc}
\usepackage{tikz}
\usetikzlibrary{shapes,arrows,calc,matrix}
\usepackage{tikz-cd}
\usepackage{manfnt}
%\usepackage{makeidx}

%\include{definitions}
\theoremstyle{plain}
      \newtheorem{theorem}{Theorem}[section]
      \newtheorem{proposition}[theorem]{Proposition}
      \newtheorem{lemma}[theorem]{Lemma}
      \newtheorem{corollary}[theorem]{Corollary}
      
      \theoremstyle{definition}
      \newtheorem{definition}[theorem]{Definition}
      
      \theoremstyle{remark}
      \newtheorem{remark}[theorem]{Remark}

%% Global TikZ settings

\tikzset{every picture/.style={>=stealth},label/.style={font=\footnotesize}}

\newcommand{\gal}[1]{{\operatorname{Gal}\hskip-1pt\left( {\bar #1}/#1 \right)}}
\newcommand{\Spec}[1]{{\operatorname{Spec}\hskip-1pt( #1 )}}

\newcommand{\FF}{{\mathbb{F}}}
\newcommand{\ZZ}{{\mathbb{Z}}}
\newcommand{\NN}{{\mathbb{N}}}
\newcommand{\CC}{{\mathbb{C}}}
\newcommand{\QQ}{{\mathbb{Q}}}
\newcommand{\RR}{{\mathbb{R}}}
\newcommand{\EE}{\mathbb{\bar Q}_\ell}
\newcommand{\OK}{\mathcal{O}_K}
\newcommand{\pK}{\mathfrak{p}_K}
\newcommand{\OL}{\mathcal{O}_L}
\newcommand{\OO}[1]{\mathcal{O}_{#1}}
\newcommand{\Zp}{\mathbb{Z}_p}
\newcommand{\Qp}{\mathbb{Q}_p}
%\newcommand{\Fp}{\mathbb{F}_p}
\newcommand{\bFq}{\bar{k}}
\newcommand{\Fq}{k}
\newcommand{\Fqm}{k_m}
%\newcommand{\bFp}{{\mathbb{\bar F}_p}}

\newcommand{\EEx}{\EE^\times}

\DeclareMathOperator{\Gal}{Gal}
\DeclareMathOperator{\W}{W}
\newcommand{\Frob}[1]{\operatorname{F}_{#1}}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\ord}{ord}
\DeclareMathOperator{\coker}{coker}
\DeclareMathOperator{\Gr}{Gr}
\DeclareMathOperator{\Irrep}{Irrep}
\DeclareMathOperator{\Pic}{Pic}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\Ext}{Ext}
\DeclareMathOperator{\Hh}{H}
\DeclareMathOperator{\Res}{Res}
\DeclareMathOperator{\Nm}{Nm}
\DeclareMathOperator{\trace}{Tr}

\newcommand{\cdef}[1]{ {#1}\index{#1} } 
\newcommand{\sheafHom}{{\mathscr{H}\hskip-4pt{\it o}\hskip-2pt{\it m}}}
\newcommand{\abs}[1]{{\vert #1 \vert}}
\newcommand{\ceq}{{\, :=\, }}
\newcommand{\tq}{{\ \vert\ }}
\newcommand{\iso}{{\ \cong\ }}
\newcommand{\obj}{{\text{obj}\, }}
\newcommand{\Gm}[1]{\mathbb{G}_{\hskip-1pt\textbf{m},#1}}
\newcommand{\GN}[1]{\mathswab{#1}}
\newcommand{\bGN}[1]{{\bar{\mathswab{#1}}}}
\newcommand{\TT}{\underline{T}}
\newcommand{\TL}{\underline{T_L}}
\newcommand{\invlim}[1]{\lim\limits_{\overleftarrow{#1}}}
\newcommand{\dirlim}[1]{\lim\limits_{\overrightarrow{#1}}}
\newcommand{\limit}[1]{\mathop{\textsc{lim}}\limits_{#1}}
\newcommand{\colimit}[1]{\mathop{\textsc{colim}}\limits_{#1}}
\newcommand{\qcs}[1]{{\mathcal{#1}}}
\newcommand{\gqcs}[1]{{\mathcal{\bar #1}}}
\newcommand{\dualgcs}[1]{\gqcs{#1}^\dagger}
\newcommand{\dualcs}[1]{\qcs{#1}^\dagger}
\newcommand{\QC}{{\mathcal{Q\hskip-0.8pt C}}}
\newcommand{\QCb}{{\QC_0}}
\newcommand{\QCf}{{\QC_f}}
\newcommand{\QCiso}[1]{\QC(#1)_{/\textit{iso}}}
\newcommand{\QCbiso}[1]{\QCb(#1)_{/\text{iso}}}
\newcommand{\QCfiso}[1]{\QCf(#1)_{/\text{iso}}}
\newcommand{\Lgroup}[1]{{\,^L\hskip-1pt{#1}}}
\newcommand{\dualgroup}[1]{{\check{#1}}}
\newcommand{\Lang}{{\operatorname{Lang}}}
\newcommand{\image}{{\operatorname{im}}}
\newcommand{\Weil}[1]{\mathcal{W}_{#1}}
\newcommand{\Loc}{{\operatorname{Loc}}}
\newcommand{\trFrob}[1]{t_{#1}}

\makeatletter
\newcommand{\labitem}[2]{%
\def\@itemlabel{\textbf{#1}}
\item
\def\@currentlabel{#1}\label{#2}}
\makeatother

\renewcommand{\bf}{\bar{f}}
\newcommand{\bg}{\bar{g}}
\newcommand{\bm}{\bar{m}}
\newcommand{\bG}{\bar{G}}
\newcommand{\bH}{\bar{H}}
\newcommand{\tight}[3]{\hspace{-#1pt}{#2}\hspace{-#3pt}}
\newcommand{\GxG}{\text{$G \tight{1}{\times}{1} G$}}
\newcommand{\bGxG}{\text{$\bar{G} \tight{1}{\times}{1} \bar{G}$}}
\newcommand{\bfxf}{\text{$\bar{f} \tight{1}{\times}{1} \bar{f}$}}
\newcommand{\GxxG}{\text{$G \tight{1}{\times}{1} G$}}
\newcommand{\LxL}{\text{$\gqcs{L} \tight{0}{\boxtimes}{0} \gqcs{L}$}}
\newcommand{\ExE}{\text{$\qcs{E}\tight{0}{\boxtimes}{0}\qcs{E}$}}
\newcommand{\bExE}{\text{$\gqcs{E}\tight{0}{\boxtimes}{0}\gqcs{E}$}}
\newcommand{\AxA}{\text{$A \tight{1}{\times}{1} A$}}
\newcommand{\BxB}{\text{$B \tight{1}{\times}{1} B$}}
\newcommand{\GzxGz}{\text{$G^0 \tight{1}{\times}{1} G^0$}}

\newcommand\todo[1]{\ \vspace{5mm}\par \noindent\framebox{\begin{minipage}[c]{0.95 \textwidth} \tt #1\end{minipage}} \vspace{5mm} \par}
\newcommand\Clifton[1]{\marginpar{\smaller\smaller CC: #1}}
\newcommand\David[1]{\marginpar{\smaller\smaller DR: #1}}

\hyphenation{quasi-character}

\begin{document}


\begin{abstract}
  We introduce and study the category of quasicharacter sheaves on smooth,
  commutative group schemes $G$ locally of finite type over finite fields
  $\Fq$. Assuming that the geometric component group of $G$
  is finitely-generated, we show that the group of isomorphism classes
  of quasicharacter sheaves on $G$ is canonically isomorphic to the group
  of characters of $G(\Fq)$. We use this result to exhibit an
  isomorphism between quasicharacters of $T(K)$ and isomorphism
  classes of quasicharacter sheaves on the Greenberg transform of the NÃ©ron
  model of $T$, where $K$ is any non-archimdean local field and $T$ is
  any algebraic torus over $K$.
\end{abstract}

\maketitle

\section*{Introduction}

%\input{introduction}
%In his celebrated thesis, John Tate writes 
%\begin{quotation}
%    {\it Concerning the characters of $k^*$ [the
%    multiplicative group of a $\mathfrak{p}$-adic field], the
%    situation is different from that of $k^+$.  First of all, we are
%    interested in continuous multiplicative maps $\alpha \mapsto
%    c(\alpha)$ of $k^*$ into the complex numbers, not only in the
%    bounded ones, and shall call such a map a quasi-character,
%    reserving the word ``character'' for the conventional character of
%    absolute value $1$. Secondly, we shall find no model for the group
%    of quasi-characters, or even for the group of characters, though
%    such a model would be of the utmost importance.}
%  \cite{tate:67a}*{\S 2.3}
%\end{quotation}
%\noindent
What is a quasicharacter sheaf?
Let $G$ be a smooth, commutative group scheme locally of finite
type over a finite field $\Fq$; $G$ need not be reductive, connected, or of
finite type over $\Fq$. Fix a prime $\ell$ invertible in $\Fq$
and write $m : \GxG \to G$ for the multiplication morphism,
$\bG$ for the base change of $G$ to $\bFq$ and
$\Frob{G} : \bG \to \bG$ for the Frobenius automorphism.
A quasicharacter sheaf on $G$ is a triple $\qcs{L}\ceq
(\gqcs{L},\mu,\phi)$ where $\gqcs{L}$ is an $\ell$-adic local system on $\bG$ of rank-1 and $\mu: m^*
\gqcs{L} \to \LxL$ and $\phi : \Frob{G}^*\gqcs{L} \to \gqcs{L}$ are isomorphisms;
$\mu$ and $\phi$ are required to satisfy natural conditions explained below.

In Part 1 of this paper we study the category $\QC(G)$ of quasicharacter sheaves.
Since it is a rigid symmetric monoidal category
the set of isomorphism classes $\QCiso{G}$ forms a group.
Motivated by the sheaf--function dictionary for commutative, connected
algebraic groups \cite{deligne:SGA4.5},\David{more specific citation} we explore the trace of Frobenius morphism
\[
\QCiso{G} \to \Hom(G(\Fq), \EEx)
\]
and show that it is an isomorphism in Theorem~\ref{thm:snake}, assuming only
that the geometric component group of $G$ is finitely generated.

In Part 2 we use Theorem~\ref{thm:snake} to make a sheaf--function dictionary
for algebraic tori over local fields.  Let $K$ be a non-archimedian local field
with finite residue field $\Fq$; we place no restriction on the characteristic of $K$.
Write $\OK$ for the ring of integers of $K$ and $\pK$ for the maximal ideal in $\OK$.
Let $T$ be a torus defined over $K$.  The N\'eron model $\TT$ of $T$
is a smooth group scheme over $\OK$ with generic fiber $T$ and a canonical isomorphism
$\TT(\OK) \cong T(K)$.  For each positive integer $d$, let $\GN{T}_d$ be the
Greenberg transform of $\TT \times_{\Spec{\OK}} \Spec{\OK/\pK^d}$; the commutative
group scheme $\GN{T}_d$ plays the r\^{o}le of $G$.  Theorem~\ref{thm:application}
allows us to translate characters $T(K)$ of depth less than $d$ into quasicharacter sheaves on $\GN{T}_d$:
\[
\QCiso{\GN{T}_d} 
\iso
\Hom_{< d}(T(K),\EEx).
\]  
We refer to finite-depth characters of $T(K)$ as quasicharacters and
describe a group scheme $\GN{T}$ simultaneously geometrizing all such quasicharacters.

We have not yet fully explored the applications of such a geometrization, but want to highlight
some of the potential benefits of Theorem~\ref{thm:application}.  Characters on $T$ have limited
functoriality: they can be pulled back along maps to $T$, but it is less clear what to do with them
in the presence of maps from $T$ to other reductive groups.  Sheaves, on the other hand, come
equipped with a host of functors, including pushforward.  

DeBacker and Reeder have recently applied Deligne-Lusztig representations to the
local Langlands correspondence \cite{reeder-debacker:09a}.  
After developing Deligne-Luzstig representations, 
the next step Lusztig took in studying representations
of finite groups of Lie type was to introduce character sheaves for reductive groups over $\Fq$.
We hope that our quasicharacter sheaves can provide a stepping stone to a similar theory for
representations of $p$-adic groups.

The scope of the Langlands program has grown explosively in the past several decades, and
different parts of it apply to different kinds of representations.  In particular, the classic local Langlands
correspondence addresses complex (or $\ell$-adic) representations of real and $p$-adic groups, while
the geometric Langlands program aims at representations of groups in characteristic $p$.  The fact that
characteristic $p$ group schemes arise as the space underlying quasicharacter sheaves, regardless of
the characteristic of $K$, provides a potential bridge allowing the methods of the geometric Langlands
program to be applied to the classic context.

Finally, we are tantalized by the possibility of providing an alternate perspective on local class field theory
through quasicharacter sheaves.  The local Langlands correspondence for tori provides an isomorphism
\[
\Hh^1(\Weil{K}, \hat{T}_\ell) \cong \Hom(T(K), \EEx).
\]
A geometric description of the resulting isomorphism $\Hh^1(\Weil{K}, \hat{T}_\ell) \cong \QCiso{\GN{T}}$
would yield a different description of the Artin reciprocity map.

We want to situate the choice of term ``quasicharacter sheaf'' in a historical context.
Analogous sheaves on connected, commutative algebraic groups were first studied
by Deligne \cite{deligne:SGA4.5}, \David{more specific citation} and more recently Drinfeld has referred to such objects
as character sheaves.  Our quasicharacter sheaves evolved from this notion, and Theorem~\ref{thm:snake}
is a direct generalization of the sheaf--function dictionary to the case of commutative
group schemes which are not necessarily connected or finite type.  The other main use
of the term ``character sheaf'' traces back to Lusztig \cite{lusztig:85a}*{Def.~2.10}.  Most of his energy is devoted to
handling non-commutative groups; though he does define character sheaves for some
non-connected groups he restricts his attention to reductive groups with cyclic component group.
For extensions of $\ZZ/n\ZZ$ by a torus, it is not difficult to relate his Frobenius-stable character
sheaves to our quasicharacter sheaves.

We close the introduction with a more detailed description of the structure of this paper.
In Section~\ref{sec:category} we define quasicharacter sheaves and give an interpretation of
them as Weil sheaves with a Galois action.
Section~\ref{sec:Frob} introduces the trace of Frobenius homomorphism,
one direction of the sheaf--function dictionary.
We define pullbacks and products of quasicharacter sheaves in Section~\ref{sec:pullback}, and use
them to prove a functoriality result on the trace of Frobenius.
In Section~\ref{sec:basechange} we study how quasicharacter sheaves behave under base change
and Weil restriction.
Sections~\ref{sec:bounded} and \ref{sec:finite} describe bounded and finite quasicharacter sheaves,
two subcategories of $\QC(G)$.  These alternate descriptions of quasicharacter sheaves play a key
role in the proof of Proposition~\ref{prop:restriction}.
In section \ref{sec:connected} we show that bounded and finite quasicharacter sheaves are the same
as standard quasicharacter sheaves when $G$ is connected, and that trace of Frobenius is an isomorphism.
We shift to \'etale group schemes $G$ in Section~\ref{sec:etale} and give a more concrete interpretation
of quasicharacter sheaves in this case.  Using a notion of global sections for quasicharacter sheaves,
we give an isomorphism between $\QCiso{G}$ and $\Hh^1(\Weil{\Fq}, \Hom(G(\bFq), \EEx))$.
Section~\ref{sec:etalecohom} proves a result in Galois cohomology that shows that trace of Frobenius is
an isomorphism for \'etale group schemes.
In Section~\ref{sec:restriction} we show that for non-connected $G$, restriction to the identity component
induces an essentially surjective functor of quasicharacter sheaves.
Section~\ref{sec:snake} closes out Part \ref{part1} with the proof of the main theorem, that trace of Frobenius
is an isomorphism for $G$ as long as the geometric component group is finitely generated.

In Section~\ref{sec:GN} we introduce N\'eron models of tori and the Greenberg transform, which produce
group schemes over $\Fq$ from algebraic tori $T$ over $K$.
Section~\ref{sec:bdchar} then uses Theorem~\ref{thm:snake} to give a geometrization of characters of $T$
of bounded depth.
We give a reinterpretation of this result in Section~\ref{sec:quasichar}, using a limit process to simultaneously
geometrize all quasicharacters of $T$.  Sections~\ref{sec:bdchar} and \ref{sec:quasichar} also include
functoriality results that we hope to use in a future discussion of class field theory.
Finally, we close the paper in Section~\ref{sec:transfer} by discussing a transfer principle, which allows
a geometric transfer of characters between characteristic $p$ tori to characteristic $0$ tori.

\subsection*{Acknowledgements}

We would like to thank Masoud Kamgarpour, Pramod Achar, and Hadi Salmasian
for allowing us to hijack much of our Research in Teams meeting at BIRS into a discussion of
quasicharacter sheaves.  Their knowledge and help have been invaluable.

We also gratefully acknowledge the financial support of the Pacific Institute for the Mathematical Sciences
and of the National Science and Engineering Research Council,
as well the hospitality of the Banff International Research Station during our weeklong stay in May 2012.

\tableofcontents
\David{Search for = which should be \ceq}
\David{Search for terms defined after they are used}
\David{Commas between adjectives, consistent ordering}

\part{Smooth commutative group schemes over finite fields} \label{part1}

Throughout this paper, $G$ is a smooth, commutative group scheme locally of finite type
over a finite field $\Fq$, and $m : \GxG\to G$ is its multiplication morphism.

We fix an algebraic closure $\bFq$ of $\Fq$ and write $\bG$ for the
smooth commutative group scheme $G \times_{\Spec{\Fq}} \Spec{\bFq}$ over $\bFq$
obtained by base change from $k$. The multiplication morphism for $\bG$ will be denoted by $\bm$. 

Let $\Frob{\Fq}$ denote the geometric Frobenius element in $\Gal(\bFq/\Fq)$ as
well as the corresponding automorphism of $\Spec{\bFq}$. The Weil group
$\Weil{\Fq}\subset \Gal(\bFq/\Fq)$ is the subgroup generated by $\Frob{\Fq}$.
Let $\Frob{G} \ceq \id_{G} \times \Frob{\Fq}$ be the Frobenius automorphism of $\bG$. 

For any group $A$, we will denote by $A^*$ the dual group $\Hom_\text{grp}(A, \EEx)$.

\section{Quasicharacter sheaves}\label{sec:category}

\begin{definition}\label{def:QC}
A \emph{quasicharacter sheaf on $G$} is a triple
$\qcs{L}\ceq (\gqcs{L},\mu,\phi)$ where:
\begin{enumerate}
\labitem{(CS.0)}{CS.0} $\gqcs{L}$ is an $\ell$-adic local system on $\bG$
(a constructible $\ell$-adic sheaf on $\bG$, locally constant on each connected component) of rank-1; 
\labitem{(CS.1)}{CS.1} $\mu: \bm^* \gqcs{L} \to \LxL$
  is an isomorphism of sheaves on $\bGxG$ such that the following diagram commutes, 
  where $m_3 \ceq m\circ (m\tight{1}{\times}{2}\id) = m\circ (\id\tight{2}{\times}{1} m)$;
%
  \[
  \begin{tikzcd}[row sep=30]
  \bm_3^*\gqcs{L} \arrow{rr}{(\bm \tight{1}{\times}{2} \id)^*\mu} \arrow[swap]{d}{(\id \tight{2}{\times}{1} \bm)^*\mu}
    &&  \bm^*\gqcs{L} \boxtimes \gqcs{L} \dar{\mu \tight{0}{\boxtimes}{1} \id} \\
    \gqcs{L} \boxtimes \bm^* \gqcs{L} \arrow{rr}{\id \boxtimes \mu}
    &&  \gqcs{L} \tight{0}{\boxtimes}{0} \LxL
  \end{tikzcd}
  \]
%
\labitem{(CS.2)}{CS.2} $\phi : \Frob{G}^* \gqcs{L} \to \gqcs{L}$ is an
  isomorphism of constructible $\ell$-adic sheaves on $\bG$ compatible with $\mu$ in the sense that the following diagram commutes.
%
  \[
  \begin{tikzcd}[row sep=20]
  \Frob{\GxxG}^* \bm^* \gqcs{L} \arrow{rr}{\Frob{\GxxG}^*\mu}
    && \Frob{\GxxG}^*(\LxL)\\
    \arrow[equal]{u} \bm^*  \Frob{G}^* \gqcs{L} \arrow[swap]{d}{\bm^* \phi}
    && \Frob{G}^*\gqcs{L}\boxtimes \Frob{G}^*\gqcs{L} \dar{\phi\boxtimes \phi} \arrow[equal]{u} \\
    \bm^*\gqcs{L} \arrow{rr}{\mu}
    && \LxL
  \end{tikzcd}
  \]
\end{enumerate}
\end{definition}

Morphisms in the category of quasicharacter sheaves on $G$, denoted by $\QC(G)$, are defined in the natural way:
\begin{enumerate}
\labitem{(CS.3)}{CS.3} if $\qcs{L} = (\gqcs{L},\mu,\phi)$ and
  $\qcs{L'} = (\gqcs{L'},\mu',\phi')$ are quasicharacter sheaves on $G$ then
  a morphism $\qcs{L} \to \qcs{L}'$ is a map $\alpha : \gqcs{L} \to \gqcs{L'}$
  of constructible $\ell$-adic sheaves on $\bG$ such that the following diagrams both commute.
  \[
  \begin{tikzcd}[column sep=40]
  \Frob{G}^* \gqcs{L} \rar{\Frob{G}^* \alpha} \arrow[swap]{d}{\phi} & \Frob{G}^* \gqcs{L'} \dar{\phi'}
  & %\arrow[draw=none]{d}[pos=.4,description]{\text{\normalsize{and}}} 
  & \arrow[swap]{d}{\mu} m^* \gqcs{L} \rar{m^* \alpha} & m^* \gqcs{L'} \dar{\mu'} \\
  \gqcs{L} \rar{\alpha} & \gqcs{L'}
  & {} & \LxL \rar{\tight{1}{\alpha\boxtimes \alpha}{1}} & \gqcs{L'} \tight{0}{\boxtimes}{0} \gqcs{L'}
  \end{tikzcd}
  \]
\end{enumerate}

The rule $(\gqcs{L},\mu,\phi) \mapsto (\gqcs{L},\phi)$ defines a forgetful functor from quasicharacter
sheaves on $G$ to ($\ell$-adic) Weil sheaves on $G$ \cite{deligne:80a}*{Def.~1.1.10 (i)}.

As mentioned after \cite{deligne:80a}*{Def.~1.1.10}, a Weil sheaf $(\gqcs{L},\phi)$ on $G$
may be interpreted as a constructible $\ell$-adic sheaf $\gqcs{L}$ on $\bG$ together with
an action of the Weil group $\Weil{\Fq}$ on $\gqcs{L}$ compatible with the action of
$\Gal(\bFq/\Fq)$ on $\bG$. We now review this point of view for later use in
Section~\ref{sec:basechange}.  If $w = \Frob{\Fq}^n$ we write $w_G$ for $\Frob{G}^n$.
For each such $w$ we define an isomorphism $\varphi(w) : w_G^* \gqcs{L}\to \gqcs{L}$ by
\[
\varphi(w) \ceq  \phi \circ \Frob{G}^*(\phi) \circ \cdots \circ (\Frob{G}^{n-1})^*(\phi);
\]
these satisfy $\varphi(uv) = \varphi(v) \circ v_G^* \varphi(u)$ for $u,v\in \Weil{\Fq}$, and
we have $\phi = \varphi(\Frob{\Fq})$. 
If we further define $\varphi_1(w) \ceq (w_G)_*(\varphi(w)^{-1})$ then
$\varphi_1(w) : (w_G)_* \gqcs{L}\to \gqcs{L}$ is an isomorphism and
$\varphi_1(uv) = \varphi_1(u) \circ (u_G)_* \varphi_1(v)$ for $u,v\in \Weil{\Fq}$.
Thus the pair $(\gqcs{L},\varphi_1)$ almost satisfies the criteria for an action of $\Weil{\Fq}$
on $\gqcs{L}$ compatible with the action of $\Gal(\bFq/\Fq)$ in the sense of
\cite{deligne:SGA4.5}*{Expos\'e XIII,~1.1}, failing only because $\Weil{\Fq}$ is not profinite.
Our use of $\Weil{\Fq}$ rather than $\Gal(\bFq/\Fq)$ allows quasicharacter sheaves to
correspond to unbounded characters.
%\end{remark}

\section{Trace of Frobenius}\label{sec:Frob}

The category $\QC(G)$ of quasicharacter sheaves on $G$ is a rigid symmetric monoidal category
\cite{etingof:09a}*{\S~1.10} under the tensor product
$\qcs{L} \otimes \qcs{L'} \ceq (\gqcs{L}\otimes\gqcs{L'}, \mu\otimes\mu', \phi\otimes \phi')$,
with duals given by applying the sheaf hom functor 
$\sheafHom(\ - \ ,\EE)$.
The category of quasicharacter sheaves on $G$ is not abelian, so $\QC(G)$
is not a tensor category in the sense of \cite{deligne:02a}. \David{more specific citation}
This rigid monoidal category structure for $\QC(G)$ puts a group
structure on the set $\QCiso{G}$ of isomorphism classes in $\QC(G)$.
We now begin developing the tools to relate $\QCiso{G}$ to $\Hom(G(\Fq), \EEx)$.

\begin{definition}\label{def:trFrob}
Let $(\gqcs{L},\phi)$ be a Weil sheaf on $G$. Every $g\in G(\Fq)$
determines a point $\bg$ on $\bG$ fixed by $\Frob{G}$ and
therefore an automorphism $\phi_{\bg}$ of $\gqcs{L}_{\bg}$. The \emph{trace of Frobenius} of $(\gqcs{L},\phi)$ at $g\in G(\Fq)$ is 
\[
\trFrob{(\gqcs{L},\phi)}(g) \ceq \trace(\phi_{\bg}, \gqcs{L}_{\bg}).
\]
If $\qcs{L} = (\gqcs{L},\mu,\phi)$ is a quasicharacter sheaf
then we will abbreviate $\trFrob{(\gqcs{L},\phi)}$ to $\trFrob{\qcs{L}}$.
\end{definition}

The isomorphism $\mu : \bm^* \gqcs{L} \to \LxL$ together with property~\ref{CS.2} guarantee
that the function $\trFrob{\qcs{L}} : G(\Fq)\to \EEx$ is a group homomorphism.
It is also clear that $\trFrob{\qcs{L}\otimes \qcs{L'}} = \trFrob{\qcs{L}} \cdot \trFrob{\qcs{L'}}$
(pointwise multiplication of functions) and $\trFrob{\qcs{L}} = \trFrob{\qcs{L'}}$
if $\qcs{L} \iso \qcs{L'}$ in $\QC(G)$. In this way we obtain a group homomorphism
\[
\cdef{\trFrob{G}} : \QCiso{G} \longrightarrow G(\Fq)^*,
\qquad \text{defined by}\qquad \qcs{L} \mapsto \trFrob{\qcs{L}}.
\]
This isomorphism is functorial in the following sense:

\begin{proposition}\label{prop:functorialG}
Trace of Frobenius $\QCiso{G} \to G(\Fq)$ is a natural transformation 
between the two additive functors 
\begin{enumerate}
\item[$F_1$:] $G \mapsto \QCiso{G}$
\item[$F_2$:] $G \mapsto G(\Fq)^*$
\end{enumerate}
from the category of smooth commutative
group schemes locally of finite type over $\Fq$ to the category of abelian groups.
\end{proposition}

The proof of Proposition~\ref{prop:functorialG} requires the results from the next section.

\section{Pull-back and products}\label{sec:pullback}

\David{insert some commentary on this proposition: it will be very useful to us}

\begin{proposition}\label{prop:pullback}
  If $f : H\to G$ is a morphism of commutative group schemes locally of finite type over $\Fq$ then
  $(\gqcs{L},\mu,\phi) \mapsto (\bf^*\gqcs{L},(\bfxf)^*\mu,\bf^*F)$
  defines a monoidal functor $f^* : \QC(G) \to \QC(H)$ such that
  \[
  \begin{tikzcd}[row sep=20, column sep=30]
   \QCiso{G} \rar{f^*} \arrow[swap]{d}{\trFrob{G}} & \QCiso{H} \dar{\trFrob{H}} \\
   G(\Fq)^* \rar & H(\Fq)^*
  %\Hom_\text{grp}(G(\Fq),\EEx) \rar & \Hom_\text{grp}(H(\Fq),\EEx)
  \end{tikzcd}
  \]
  is a commutative diagram of groups, where the lower homomorphism is
  dual to $f : H(\Fq)\to G(\Fq)$.  Moreover, $(f\circ g)^* = g^* \circ f^*$.
\end{proposition}

\begin{proof}
  Let $\qcs{L}$ be a quasicharacter sheaf on $G$. We start by showing that
  $\bf^*\gqcs{L}$ is a local system of rank~$1$. Let $c_j :\bH^j \hookrightarrow \bH$ be any
  connected component and let $i$ be the image of $j$ under the group
  homomorphism $\pi_0(\bf) : \pi_0(\bH) \to \pi_0(\bG)$.
  Write $c_i : \bG^i \hookrightarrow \bG$ for
  the inclusion of $\bG^i$ and $\bf^j : \bH^j \to \bG^i$
  for the restriction of $f$ to $\bH^j$.  Since $\gqcs{L}$ is locally constant on the connected
  components of $\bG$, there is a finite \'etale covering
  $a_i : X_i \to \bG^i$ such that $a_i^* (\gqcs{L}\vert_{\bG^i})$
  is constant. Let $b_j : Y_j \to \bH^j$ be the
  pull-back of $a_i$ along $\bf^j$ and let $g_j : Y_j \to X_i$ be
  the map opposite $\bf^j$. Then $b_j$ is a finite \'etale covering
  of $\bH^j$ and
  \[
  b_j^* \left( (\bf^* \gqcs{L})\vert_{\bH^j}\right)
  = (\bf\circ c_j \circ b_j)^*\gqcs{L}
  = (c_i\circ a_i\circ g_j)^*\gqcs{L} = g_j^* a_i^* (\gqcs{L}\vert_{\bG^i}).
  \]

  Since $a_i^* (\gqcs{L}\vert_{\bG^i})$ is a constant sheaf, its pullback
  $b_j^* \left( (\bf^*\gqcs{L})\vert_{\bH^j}\right)$ along $g_j$ is also constant.
  Thus $\bf^*\gqcs{L}$ is locally constant on
  $\bH^j$. Since $(\bf^*\gqcs{L})_{\bg} = \gqcs{L}_{f(\bg)}$ for every
  geometric point ${\bg}$ on $\bG$, and since $\gqcs{L}$ has
  rank $1$ on connected components of $\bG$, it follows that
  $f^*\gqcs{L}$ also has rank $1$ on connected components of $\bG$.
  This completes the proof that $\bf^*\gqcs{L}$ satisfies condition \ref{CS.0}.

  To see that $(\bfxf)^* \mu$ satisfies
  condition \ref{CS.1}, apply the functor $(\bfxf)^*$
  to \ref{CS.1} for $\qcs{L}$ and use the canonical isomorphism
  $(\bfxf)^*(\LxL) \iso \bf^*\gqcs{L} \tight{-3}{\boxtimes}{-3} \bf^*\gqcs{L}$.
  To show that $f^*\qcs{L}$ satisfies condition
  \ref{CS.2}, apply the same functor to \ref{CS.2} for $\qcs{L}$.
  The fact that $f$ is a morphism of group schemes defined over $\Fq$ then
  yields isomorphisms $(\bfxf)^*\Frob{\GxxG}^* \iso \Frob{\GxxG}^* (\bfxf)^*$
  and $(\bfxf)^* \bm^*\iso \bm^* \bf^*$ between functors of constructible sheaves.
  
  Applying $\bf^*$ and $\bf^* \tight{1}{\times}{1}\bf^*$ to \ref{CS.3} allows the application
  of $f^*$ to morphisms of quasicharacter sheaves; arguing as above shows that $f^*$ is
  a functor from $\QC(G)$ to $\QC(H)$.  Since tensor products commute with pullback
  $f^* : \QC(G) \to \QC(H)$ is a monoidal functor.
%
  The diagram relating $f^* : \QC(G) \to \QC(H)$, $f^* : G(k)^* \to H(k)^*$ and trace of Frobenius
  commutes by \cite{laumon:87a}*{1.1.1.2}, where the ambient
  hypothesis that $X$ is of finite type over $\Fq$ can be replaced by
  the hypothesis that $X$ is locally of finite type over $\Fq$.
  
  Finally, the fact that $(f\circ g)^* = g^* \circ f^*$ follows from the analogous
  statements about the pullback functor on $\ell$-adic constructible sheaves.
\end{proof}

Consider the short exact sequence in the category of smooth group
schemes, locally of finite type over $\Fq$, defining the component
group scheme for $G$:
\begin{equation}\label{eq:pi0}
\begin{tikzcd}
0 \rar & G^0 \rar & G \rar & \pi_0(G) \rar & 0.
\end{tikzcd}
\end{equation}
Since $\pi_0(G)$ is an commutative group scheme, smooth and locally of finite type over $\Fq$, 
Proposition~\ref{prop:pullback} implies that \eqref{eq:pi0} defines a sequence of functors
\[
\begin{tikzcd}
\QC(0) \rar & \QC(\pi_0(G)) \rar & \QC(G) \rar & \QC(G^0) \rar & \QC(0)
\end{tikzcd}
\]
which induces, upon passage to isomorphism classes of objects, a sequence of group homomorphisms 
\[
\begin{tikzcd}
\QCiso{0} \rar & \QCiso{\pi_0(G)} \rar & \QCiso{G} \rar & \QCiso{G^0} \rar & \QCiso{0}.
\end{tikzcd}
\]
It is easy to see that $\QCiso{0}$ is trivial. In Sections~\ref{sec:connected} and  we will find $\QCiso{G^0}$
and $\QCiso{\pi_0(G)}$ under the hypothesis that $\pi_0(G)$ is geometrically finitely generated; 
the snake lemma will then allow us to show
\[
\QCiso{G} \iso G(\Fq)^*,%\Hom_\text{grp}(G(\Fq),\EE^\times),
\]
canonically.
%\section{Products} 
We end this section with a simple result on products of quasicharacter sheaves,
which is needed to show that the isomorphism above is functorial.

\begin{proposition}\label{prop:product}
The rule $\boxtimes : (\qcs{L}_1,\qcs{L}_2)\to \qcs{L}_1\boxtimes\qcs{L}_2$ defines an equivalence of categories 
\[
\QC(G_1)\times (G_2) \to \QC(G_1\times G_2)
\]
(categorical product on the left, product of group schemes over $\Fq$ on the right) and 
\[
\begin{tikzcd}[column sep=60]
\arrow{d}{\trFrob{G_1} \times \trFrob{G_2}} \QCiso{G_1}\times \QCiso{G_2} \arrow{r}{\boxtimes}
& \arrow{d}{\trFrob{G_1\times G_2}} \QCiso{G_1\times G_2}\\
(G_1)(\Fq)^*\times (G_2)(\Fq)^* \arrow{r}{(\chi_1,\chi_2)\mapsto \chi_1\otimes \chi_2}  & (G_1\times G_2)(\Fq)^*
\end{tikzcd}
\]
commutes.
\end{proposition}

\begin{proof}
The only non-trivial part is essential surjectivity. Set $G \ceq G_1\times G_2$.
Let $\qcs{L}$ be a quasicharacter sheaf on $G$. Define $f : G\to G\times G$
by $f(g_1,g_2) = (g_1,e_2,e_1,g_2)$. Observe that $m\circ f = \id_G$. 
Let $p_1$, $p_2$ be the projection morphisms pictured below:
\[
\begin{tikzcd}
G & \arrow[swap]{l}{p_1} G\times G \arrow{r}{p_2} & G.
\end{tikzcd}
\]
Then the isomorphism $\mu : m^* \gqcs{L} \to \gqcs{L}\boxtimes \gqcs{L}$ gives an isomorphism
\[
f^*\mu : f^* m^* \gqcs{L} \to f^*(\gqcs{L}\boxtimes \gqcs{L}) = f^*p_1^*\gqcs{L}\otimes f^* p_2^*\gqcs{L}.
\]
Let $r_1$ and $r_2$ be the projection morphisms pictured below, with sections $q_1$, $q_2$, also morphisms of group schemes:
\[
\begin{tikzcd}
G_1  \arrow[swap, bend right]{r}{q_1} &
\arrow[swap, bend right]{l}{r_1} G_1\times G_2 \arrow[bend left]{r}{r_2} &
\arrow[bend left]{l}{q_2} G_2.
\end{tikzcd}
\]
Then $p_1\circ f = r_1 \circ q_1$ and $f_2 = r_2\circ f$, 
so $f^*p_1^*\gqcs{L} = r_1^* q_1^* \gqcs{L}$ and $f^*p_2^*\gqcs{L} = r_2^* q_2^* \gqcs{L}$. 
Now $\qcs{L}_1 \ceq r_1^* \qcs{L}$ is a quasicharacter sheaf on $G_1$ 
and $\qcs{L}_2 \ceq r_2^* \qcs{L}$ is a quasicharacter sheaf on $G_2$, 
by Proposition~\ref{prop:pullback}. 
Then 
\[
f^*p_1^*\gqcs{L}\otimes f^* p_2^*\gqcs{L} = r_1^*\gqcs{L}_1\otimes r_2^* \gqcs{L}_2 = \gqcs{L}_1\boxtimes \gqcs{L}_2.
\]
In this way, $\mu$ determines an isomorphism
\[
f^*\mu : \gqcs{L} \to  \gqcs{L}_1\boxtimes \gqcs{L}_2.
\]
So $\boxtimes$ is essentially surjective.
\end{proof}

\begin{proof}[Proof of Proposition~\ref{prop:functorialG}]
The first part of Proposition~\ref{prop:pullback} shows that $F_1$ is a functor,
while the second part shows that Trace of Frobenius is a natural transformation
$t: F_1 \to F_2$. When further combined with Proposition~\ref{prop:product},
we see that $F_1$ is an additive functor and $t: F_1 \to F_2$ is a natural
transformation between additive functors.
\end{proof}

\section{Base change}\label{sec:basechange}

When using quasicharacter sheaves to study characters, it is useful to understand
how quasicharacter sheaves behave under change of fields.
Let $k'$ be a finite extension of $k$. Then $k\to k'$ induces a group homomorphism
$i_{k'/k} : G(k) \hookrightarrow G(k')$ which, in turn, gives
\[
i_{k'/k}^* : G(k')^* \to G(k)^* \qquad \text{defined by}\qquad \chi \mapsto \chi\circ i_{k'/k}.
\]
We can interpret this operation on characters in terms of quasicharacter sheaves, as follows.
%

\begin{proposition} \label{prop:csbe}
Set $G_{k'} = G\times_\Spec{k} \Spec{k'}$ and let
\[
\QC(\Res_{k'/k}(G_{k'})) \xrightarrow{\iota^*} \QC(G)
\]
be the functor obtained by pull-back along the canonical closed immersion of $k$-schemes
$\iota : G \hookrightarrow \Res_{k'/k}(G_{k'})$
\cite{bosch-lutkebohmert-reynaud:NeronModels}*{\S 7.6}. 
The following diagram commutes:
\[
\begin{tikzcd}
\QCiso{\Res_{k'/k}(G_{k'})} \arrow[two heads]{r}{\iota^*} \dar[swap]{\trFrob{\Res_{k'/k}(G_{k'})}} & \QCiso{G} \dar{\trFrob{G}} \\
G(k')^* \arrow[two heads]{r}{i_{k'/k}^*} & G(k)^*.
\end{tikzcd}
\]
\end{proposition}
\begin{proof}
This result follows immediately from Proposition~\ref{prop:pullback} together with the identifications
$\Res_{k'/k}(G_{k'})(k) \cong G_{k'}(k') \cong G(k')$ from the definitions of Weil restriction and base change.
\end{proof}

In the opposite direction, let $\Nm : G(k') \to G(k)$ be the norm map and consider the group homomorphism:
\[
\Nm^* : G(k)^* \to G(k')^* \qquad \text{defined by}\qquad \chi \mapsto \chi\circ \Nm.
\]
We can also interpret this operation on characters in terms of quasicharacter sheaves, as follows.

If $\qcs{L} = (\gqcs{L}, \mu, \phi)$ is a quasicharacter sheaf on $G$ we may define
a quasicharacter sheaf $\qcs{L}' = (\gqcs{L}, \mu, \phi_{k'})$ on the base change
$G_{k'}$ of $G$ to $k'$ by setting
\[
\phi_{k'} = \phi \circ \Frob{G}^*(\phi) \circ \cdots \circ (\Frob{G}^{n-1})^*(\phi).
\]
The commutativity of the diagram (CS.2) for $\phi_{k'}$ 
follows from the fact that $\Frob{G_{k'}} = \Frob{G}^n$.
Note that we may also think about the construction of $\phi_{k'}$ from $\phi$
as taking the action $\varphi$ of $\Weil{k}$ on $\gqcs{L}$ 
defined in Section~\ref{sec:category} and restricting it to the subgroup $\Weil{k'}$.

\begin{proposition}\label{prop:basechange}
 The rule $\nu_{k'/k}: (\gqcs{L}, \mu, \phi) \mapsto (\gqcs{L}, \mu, \phi_{k'})$ 
 defines a monoidal functor $\QC(G) \to \QC(G_{k'})$. 
 Moreover, the following diagram commutes, 
 where the top map is induced by $\QC(G) \to \QC(G_{k'})$ 
 and the bottom map is induced by the norm $G(k') \rightarrow G(k)$:
\[
\begin{tikzcd}[column sep=60]
\QCiso{G} \rar{\nu_{k'/k}} \dar{\trFrob{G}} & \QCiso{G_{k'}} \dar{\trFrob{G_{k'}}} \\
G(k)^*  \rar{\Nm^*} & G(k')^*.
\end{tikzcd}
\]
\end{proposition}
\begin{proof}
Let $\qcs{L} = (\gqcs{L}, \mu, \phi) \in \QC(G)$ and $x \in G(k')$ and write $\Frob{}$ for $\Frob{G}$.
The value $t_{G_{k'}}(\nu_{k'/k}(\qcs{L})(x)$ is given by the trace of $\phi_{k'}$ on $\gqcs{L}_x$,
while the value $\Nm^*(t_G(\qcs{L}))(x)$ is given by the trace of $\phi$ on $\gqcs{L}_{\Nm(x)}$.
Applying \ref{CS.2} to the stalk of $\gqcs{L}^{\boxtimes n}$ at $(x, \Frob{}(x), \ldots, \Frob{}^{n-1}(x))$ yields a diagram
\[
\begin{tikzcd}
\gqcs{L}_{\Nm(x)} \rar \dar{\phi_{\Nm(x)}} & \gqcs{L}_{\Frob{}(x)} \otimes \gqcs{L}_{\Frob{}^2(x)} \otimes \cdots \otimes \gqcs{L}_x
\dar{\phi_x \otimes (\Frob{}^*\phi)_x \otimes \cdots \otimes ((\Frob{}^{n-1})^*\phi)_x} \\
\gqcs{L}_{\Nm(x)} \rar & \gqcs{L}_x \otimes \gqcs{L}_{\Frob{}(x)} \otimes \cdots \otimes \gqcs{L}_{\Frob{}^{n-1}(x)}.
\end{tikzcd}
\]
Choose a basis vector $v$ for $\gqcs{L}_{\Nm(x)}$, mapping to $v_0 \otimes v_1 \otimes \cdots \otimes v_{n-1}$
along the bottom map, where $v_i \in \gqcs{L}_{\Frob{}^i(x)}$.  By \ref{CS.1}, $v$ maps to
$v_1 \otimes v_2 \otimes \cdots \otimes v_0$ along the top of the diagram.
Let $\alpha_i \in \EEx$ represent $((\Frob{}^i)^*\phi)_x$ with respect to these bases and let $\alpha$ be
the trace of $\phi_{\Nm(x)}$.  We may now equate the trace $\alpha$ of $\phi$ on $\gqcs{L}_{\Nm(x)}$
with the product $\alpha_0 \cdots \alpha_{n-1}$, which is the trace of $\phi_{k'}$ on $\gqcs{L}_x$.
\end{proof}

Finally, let $G'$ be a smooth commutative group scheme locally of finite type over $k'$;
we explain how to geometrize the canonical isomorphism between characters of $G'(k')$ and of $(\Res_{k'/k}G')(k)$.
The base change $(\Res_{k'/k}G')_{k'}$ of $\Res_{k'/k}G'$ to $k'$
decomposes into a product of copies of $G'$, indexed by elements of $\Gal(k'/k)$:
\[
(\Res_{k'/k}G')_{k'} \cong \prod_{\Gal(k'/k)} G'.
\]
Since products and coproducts agree for group schemes we have a natural inclusion of $k'$-schemes 
\[
G' \hookrightarrow (\Res_{k'/k}G')_{k'}
\]
mapping $G'$ into the summand corresponding to $1 \in \Gal(k'/k)$.  Composing pullback
along this map with $\nu_{k'/k}$ from Proposition~\ref{prop:basechange} yields a functor
\[
\QC(\Res_{k'/k}G') \to \QC(G').
\]

\begin{proposition}
The following diagram of isomorphisms commutes, where the bottom map is the identity:
\[
\begin{tikzcd}
\QCiso{\Res_{k'/k} G'} \dar{\trFrob{\Res_{k'/k} G'}} \rar & \QCiso{G'} \dar{\trFrob{G'}}\\
G'(k')^* \rar & G'(k')^*
\end{tikzcd}
\]
\end{proposition}
\begin{proof}
By Proposition~\ref{prop:pullback} the pullback part of the definition corresponds to the map $(\Res_{k'/k}G')(k') \to G'(k')^*$
induced by $g \mapsto (g, 1, \ldots, 1)$.  Since the action of $\Gal(k'/k)$ on $(\Res_{k'/k}G')_{k'} \cong \prod_{\Gal(k'/k)} G'$
is given by permuting coordinates, composition with the norm map yields the identity on $G'(k')$.
\end{proof}

\section{Bounded quasicharacter sheaves}\label{sec:bounded}

\begin{definition}
Let $\QCb(G)$ be the category of pairs $(\qcs{L}_0,\mu_0)$ 
where $\qcs{L}_0$ an $\ell$-adic local system on $G$ of rank-1, 
equipped with an isomorphism $\mu_0 : m^* \qcs{L}_0 \to \qcs{L}_0 \boxtimes \qcs{L}_0$ 
satisfying the analogue of Condition~\ref{CS.1} on $G$; 
morphisms in $\QCb(G)$ are defined as in (the second part of) Condition~\ref{CS.2}. 
This is the category of \emph{bounded quasicharacter sheaves} on $G$. 
\end{definition}

The category of bounded quasicharacter sheaves is a rigid monoidal category in the obvious way. 
%with duals given by $\qcs{L}_0^\vee \ceq \sheafHom(\qcs{L}_0,\EE)$.

\begin{proposition}
$\QCb(G)$ is (equivalent to) a full subcategory of $\QC(G)$.
\end{proposition}

\begin{proof}
 Let $b_G : {\bar G} \to G$ be the pull-back of $\Spec{\bFq} \to \Spec{\Fq}$ along $G\to \Spec{\Fq}$.
 Let $(\qcs{L}_0,\mu_0)$ be a bounded quasicharacter sheaf on $G$. 
 Then $\qcs{L}_0$ is, in particular, an $\ell$-adic constructible sheaf on $G$. 
 Then $b_G^* \qcs{L}_0$ comes equipped with an isomorphism 
 $\phi : \Frob{G}^* b_G^*\qcs{L}_0 \to b_G^* \qcs{L}_0$; 
 moreover, the functor $\qcs{L}_0 \mapsto (b_G^* \qcs{L}_0,\phi)$  
 from $\ell$-adic constructible sheaves on $G$ to $\ell$-adic constructible sheaves on $G$
 is full and faithful; see \cite{deligne-katz:SGA7.2}*{Expos\'e XIII} or even \cite{beilinson-bernstein-deligne:81a}*{Prop. 5.2.1}. 
 This functor preserves local constancy, so takes local systems to local systems. 
 Set $\mu = b_{G\times G}^*\mu_0$; clearly, this satisfies Condition~\ref{CS.2} 
 with $b_G^*\qcs{L}_0$ playing the role of $\gqcs{L}$.
 Moreover, $\phi$ is compatible with $\mu$ in the sense of Condition~\ref{CS.3}.
 It follows that functor $(\qcs{L}_0,\mu_0) \mapsto (b_G^*\qcs{L}_0,b_{G\times G}^* \mu_0, \phi)$,
 denoted by  $B_G^*: \QCb(G) \hookrightarrow \QC(G)$ below, is full and faithful.
\end{proof}

The full subcategory $\QCb(G)$ of bounded quasicharacter sheaves is an essentially
proper subcategory of $\QC(G)$, in general. Indeed, it follows from our main result
regarding quasicharacter sheaves, Theorem~\ref{thm:snake}, that the restriction of
$\trFrob{G} : \QCiso{G} \to G(\Fq)^*$ to the subgroup $\QCbiso{G}$ is an isomorphism
onto the subgroup of $\chi \in G(\Fq)^*$ such that the image of $\chi$ is bounded in $\EEx$;
see Section~\ref{sec:snake}.

\section{Finite quasicharacter sheaves}\label{sec:finite}

 %In this section we describe a full subcategory of $\QCb(G)$
 %which will illuminate some features of $\QCb(G)$ and also play a role in some arguments below.
 
To define the category of finite quasicharacter sheaves we must work a bit harder.
Consider the following category $C(G)$.
Let us say that $f : H\to G$ is a \emph{discrete isogeny} if it is a a finite, surjective
\'etale morphism and a morphism of commutative group $\Fq$-schemes, for which
the action of $\Gal(\bFq/\Fq)$ on the \'etale group scheme $f^{-1}{\bar e}$ is trivial.
An object in $C(G)$ is a pair $(f,\psi)$ where: 
$f : H\to G$ is a discrete isogeny 
and $\psi : \ker f\to \Aut(V)$ is a representation on a finite-dimensional $\EE$-vector space $V$;
a map $(f,\psi) \to (f',\psi')$ in $C(G)$ is a pair $(\alpha,T)$ 
where $\alpha$ is a morphism of schemes such that $f' = f\circ \alpha$
and $T : V\to V'$ is a linear transformation equivariant 
for the action of $\ker f'$ on $V'$ by $\psi'$ 
and the action of $\ker '$ on $V$ by $\psi \circ \alpha$.
\[
\begin{tikzcd}
V \arrow{d}{T} & \Aut(V) & \arrow[swap]{l}{\psi} \ker f \arrow[hook]{r} & H \arrow{r}{f} & \arrow[equal]{d} G\\
V' & \Aut(V) & \arrow[swap]{l}{\psi} \arrow[swap]{u}{\alpha\vert_{\ker f}} \ker f \arrow[hook]{r} & \arrow[swap]{u}{\alpha} H' \arrow{r}{f'} & G
\end{tikzcd}
\]
We say that $(\alpha,T)$ in $C(G)$ is a \emph{weak isomorphism} if $\alpha$ is surjective
and $T$ is an isomorphism of vector spaces.
Let \cdef{$C(G)[W^{-1}]$} be the localization of $C(G)$ at weak isomorphisms.

We put a tensor category structure on $C(G)$ 
and a rigid monoidal category structure on $C_1(G)$ as follows.
Let $(f,\psi)$ and $(f',\psi')$ be objects in $C(G)$. 
The category of isogenies to $G$ admits products: 
write $f\times_G f' : H\times_G H' \to G$ for the product of $f : H\to G$ and $f' : H'\to G$. 
Since $\ker(f\times_G f') \iso (\ker f)\times (\ker f')$, canonically,
the tensor product of the representations $\psi : \ker f\to \Aut(V)$ and $\psi' : \ker f'\to \Aut(V')$ 
is the representation $\psi \otimes\psi' :  \ker(f\times_G f') \to \Aut(V\otimes V')$. 
This allows us to set $(f,\psi)\otimes(f',\psi') \ceq (f\times_G f' ,\psi\otimes\psi')$. 
The same fact makes sense of $(f,\psi)\oplus(f',\psi')\ceq (f\times_G f' ,\psi\oplus\psi')$. 
The dual of $(f,\psi)$ is $(f,\psi)^\vee \ceq (f,\psi^\vee)$ 
where $\psi^\vee : \ker f \to \Aut(V^\vee)$ and $V^\vee = \Hom_\text{vec}(V,\EE)$. 
The verification that these operations make $C(G)$ a tensor category is straightforward.
Likewise, $C(G)[W^{-1}]$ is a tensor category.


\begin{lemma}\label{lemma:finite-pull-back}
If $g : G'\to G$ is a morphism of group schemes then $(f,\psi) \mapsto (f_g,\psi_g)$
defines a monomial functor $g^* : C(G)[W^{-1}] \to C(G')[W'^{-1}]$ where $f_g : H\times_G G'\to G'$
is a pull-back of $f$ along $g$ and $\psi_g : \ker f_g \to \Aut(V)$ is defined by the diagram below.
\[
\begin{tikzcd}
V & \Aut(V) & \arrow[swap]{l}{\psi} \ker f \arrow[hook]{r} & H \arrow{r}{f} &  G\\
  &  & \arrow[dashed]{ul}{\psi_g} \arrow[swap]{u}{(g_f)\vert_{\ker g_f}} \ker f_g \arrow[hook]{r}
  & \arrow[swap]{u}{g_f} H\times_G G' \arrow{r}{f_g} & \arrow{u}{g} G'.
\end{tikzcd}
\]
\end{lemma}

\begin{proof}
The key point is that pull-back along $g$ takes isogenies to isogenies,
and maps over $G$ to maps over $G'$, as pictured below.
\[
\begin{tikzcd}[row sep=10,column sep=10]
\ & V \arrow{dd}{T} && \Aut(V) && \arrow[swap]{ll}{\psi} \ker f \arrow[hook]{rr} && H \arrow{rr}{f} && \arrow[equal]{dd} G\\
 && && \arrow{ul} \ker f\times_G G' \arrow{ur} \arrow[hook]{rr} && H\times_G G' \arrow{ur} \arrow{rr} && G' \arrow{ur}{g} & \\
& V' && \Aut(V) && \arrow[swap,pos=0.7]{ll}{\psi'} \arrow[swap]{uu}{} \ker f'  \arrow[hook]{rr} && \arrow[swap]{uu} H' \arrow[pos=0.8]{rr}{f'} && G\\
 && && \arrow{ul} \ker f'\times_G G' \arrow{uu} \arrow{ur} \arrow[hook]{rr} && \arrow{uu} H'\times_G G' \arrow{ur} \arrow{rr} && \arrow[equals]{uu} G' \arrow[swap]{ur}{g} & 
\end{tikzcd}
\]
In this form we could treat $g^*$ as a functor $G(G')\to C(G)$,
where it not for the fact that pull-back is defined only up to isomorphism.
In the localized categories, this ambiguity disappears. 
\end{proof}

Let $C_1(G)$ be the rigid monoidal full subcategory of $C(G)$ consisting of objects
$(f,\psi)$ such that $\psi$ is a one-dimensional representation.

\begin{definition}
The category of \emph{finite quasicharacter sheaves} of $G$, denoted by $\QCf(G)$,
is the rigid symmetric monoidal category obtained by localizing $C_1(G)$ at weak isomorphisms.
\end{definition}


\begin{lemma}\label{lemma:finite-iso}
Each $(f,\psi)\in \QCf(G)$ determines a canonical isomorphism $m^*(f,\psi) \to (f,\psi)\boxtimes(f,\psi)$ in $\QCf(G\times G)$.
 \end{lemma}

\begin{proof}
As in Lemma~\ref{lemma:finite-pull-back}, we have $m^*(f,\psi) = (f_m,\psi_m)$
where $f_m$ and $\psi_m$ are pictured below, where $H_m = H\times_G(G\times G)$.
\[
\begin{tikzcd}[column sep=40]
V & \Aut(V) & \arrow[swap]{l}{\psi} A \arrow[hook]{r} & H \arrow{r}{f} &  G\\
  &  & \arrow[dashed]{ul}{\psi_g} \arrow[swap]{u}{(m_f)\vert_{\ker m_f}} \ker f_m \arrow[hook]{r}
  & \arrow[swap]{u}{m_f} H_m \arrow{r}{f_m} & \arrow{u}{m} G\times G.
\end{tikzcd}
\]
On the other hand, $(f,\psi) \boxtimes (f,\psi) = (f\times f, \psi\otimes \psi)$.
Since $f\circ m_H = m \circ (f\times f)$, by the universal property of pull-back,
there is a unique $\theta : H\times H \to H_m$ making the following commute.
\[
\begin{tikzcd}[row sep=20,column sep=10]
\ & V \arrow{dd}{T} && \Aut(V) && \arrow{dl} \arrow[swap]{ll}{\psi_g} A_m \arrow[hook]{rr}
&& \arrow[swap]{ld}{m_f} H_m \arrow{rr}{f_m} && \arrow[equal]{dd} \arrow{ld}{m} G\times G\\
 && && \arrow{ul}{\psi} A  \arrow[hook]{rr} && H  \arrow[swap, pos=0.8]{rr}{f} && G  & \\
& V\otimes V && \Aut(V)
&& \arrow[swap]{ll}{\psi \otimes \psi} \arrow[swap,pos=0.8]{uu}{\theta\vert_{A\times A}} A\times A \arrow[hook]{rr}
&& \arrow[swap,pos=0.8]{uu}{\theta} \arrow{ul}{m_H} H\times H \arrow{rr}{f\times f} && G\times G
\end{tikzcd}
\]
Choose a basis $\{ v_1 \}$ for $V$; then $\{ v_1\otimes v_1 \}$ is a basis for $V\otimes V$.
Define $T : V \to V\otimes V$ by $T(v_1) = v_1\otimes v_1$. Then the lower part of this
diagram defines a weak isomorphism $(\theta,T): m^*(f,\psi) \to (f,\psi)\boxtimes (f,\psi)$  in $C_1(G)$. 

While $\theta$ was canonical, $T$ was not, as it depended on the choice of a basis for $V$.
However, after passing from $C_1(G)$ to $\QCf(G)$, the resulting isomorphism
$\mu(f,\psi): m^*(f,\psi) \to (f,\psi)\boxtimes (f,\psi)$ is canonical in $\QCf(G)$.
\end{proof}


\begin{proposition}\label{prop:bounded}
 $\QCf(G)$ is (equivalent to) a full subcategory of $\QCb(G)$.
\end{proposition}

\begin{proof}
 To prove the proposition we exhibit a full and faithful monoidal functor $L_G : \QCf(G) \to \QCb(G)$.
 %
 We will do this by constructing a faithful monoidal functor $L : C_1(G) \to \QCb(G)$ 
 such that $L(\alpha,T)$ is an isomorphism precisely when $(\alpha,T)$ is a weak isomorphism. 
 Factoring along $C_1(G) \to \QCb(G)$ will produce the full and faithful monoidal functor we seek.

 Now we introduce a faithful functor $L : C(G) \to \Loc(G)$ to the category of local systems on $G$.
 For any object $(f,\psi)$ in $C(G)$, let $L(f,\psi)$ be the $\psi$-isotypic component of $f_* V_H$, 
 where $V_H$ refers to $V$ as a constant sheaf on $H$. 
 We may identify the stalk $(f_* V_H)_{\bar g}$ of $f_* V_H$ at a geometric point ${\bar g}$ on $G$ 
 with the $\EE$-vector space $\Hom_\text{set}(\abs{f^{-1}({\bar g})},V)$ 
 and the stalk $L(f,\psi)_{\bar g}$ of $L(f,\psi)$ at a geometric point ${\bar g}$ on $G$ 
 with the $\EE$-vector space consisting of those functions $s: \abs{f^{-1}({\bar s})} \to V$ such that 
 $s(a\cdot {\bar h}) = \psi(a)(s({\bar h}))$ for all $a\in \ker f$ and for all ${\bar h} \in f^{-1}({\bar g})$.
 Since $L(f,\psi)$ is trivialized by $f$, it is a local system on $G$.
 For any map $(\alpha,T)$ in $C(G)$, let $L(\alpha,T) : L(f,\psi) \to L(f',\psi')$ be the homomorphism of local systems defined 
 %at geometric points $L(\alpha,T)_{\bar g} : L(f,\psi)_{\bar g} \to L(f',\psi')_{\bar g}$ 
 by $s \mapsto s' \ceq T\circ s\circ \alpha$. 
 This defines a monoidal functor $L$ from $C(G)$ to $\Loc(G)$. 
 This functor commutes with pull-back along any morphism of group schemes.
  
 Now consider the localization $C(G)[W^{-1}]$ of $C(G)$ at weak isomorphisms.
 Morphisms in $C(G)[W^{-1}]$ are simple to describe because category $C(G)$ 
 admits a calculus of left fractions
 %\footnote{See {\tt http://ncatlab.org/nlab/show/calculus+of+fractions}.} 
 for weak isomorphisms:
% every isomorphism in $C(G)$ is a weak isomorphism; 
% push-outs exist in $C(G)$ and the push-out of a weak isomorphism is a weak isomorphism; 
% and weak isomorphisms enjoy the left-cancellation property. 
% It follows that
 a morphism in $C(G)[W^{-1}]$ is the equivalence class of 
  \begin{equation}\label{eq:morGCf}
   \begin{tikzcd}
   (f,\psi) \arrow{r}{(\alpha_1,T_1)} & (f_1,\psi_1) & \arrow[swap]{l}{(\beta_1,U_1)} (f',\psi')
   \end{tikzcd}
  \end{equation}
 where $(\alpha',T') : (f,\psi) \to (f',T')$ is any map in $C(G)$ 
 and $(\beta_1,U_1) : (f_1,\psi_1) \to (f',\psi')$ is a weak isomorphism.

 Observe that $L$ takes weak isomorphisms in $C(G)$ to isomorphisms in $\Loc(G)$. 
 To see this, suppose $(\beta,U) : (f,\psi)\to (f',\psi')$ is a weak isomorphism. 
 Since $U$ is an isomorphism, we may replace $V'$ with $V$ and $U$ with $\id_V$, without loss of generality. 
 Then the equivariance condition on $U$ becomes $\psi' = \psi\circ \beta$ on the finite \'etale group scheme $\ker f'$. 
 Since $f$ and $f'$ are finite \'etale, and $f' = f\circ \beta$, and $\beta$ is surjective,
 $\beta$ is an \'etale cover; therefore, $\beta$ admits a section $\beta' : H \to H'$.
 This provides the inverse to $L(\beta,U) : L(f,\psi) \to L(f',\psi')$.
 
 Conversely, if $L(\alpha,T)$ is an isomorphism of local systems, 
 then $T$ must be an isomorphism of vector spaces and $\beta$ must be surjective,
 whence $(\alpha,T)$ is a weak isomorphism: $W$ is saturated.
  
 Since $L : C(G) \to \Loc(G)$ takes weak isomorphisms to isomorphisms,
 it factors, uniquely, through the localisation functor $C(G) \to C(G)[W^{-1}]$ 
 to define a faithful functor $L_{W} : C(G)[W^{-1}] \to \Loc(G)$. 
 Since $W$ is saturated, the functor $L_{W} : C(G)[W^{-1}] \to \Loc(G)$ is full. 
   
 By Lemma~\ref{lemma:finite-iso}, each $(f,\psi) \in \QCf(G)$ determines 
 an isomorphism $\mu(f,\psi) : m^*(f,\psi) \to (f,\psi) \boxtimes (f,\psi)$ in $\QCf(G\times G)$, canonically.
 It follows immediately that the functor 
 \[
 L_G  \ceq  L_{W}\vert_{\QCf(G)} : \QCf(G) \to \QCb(G),
 \] 
 given on objects by $(f,\psi) \mapsto (L(f,\psi), L_{W}(\mu(f,\psi)))$,
 is a full and faithfull monoidal functor, completing the proof.
\end{proof}


The full subcategory $\QCf(G) \subset \QCb(G)$ of finite quasicharacter sheaves
is a proper subcategory, in general. Indeed, it follows from our main result regarding
quasicharacter sheaves, Theorem~\ref{thm:snake}, that the restriction of
$\trFrob{G} : \QCiso{G} \to G(\Fq)^*$ to the subgroup $\QCfiso{G}$ is an isomorphism
onto the subgroup of $\chi \in G(\Fq)^*$ such that the image of $\chi$ is finite in $\EEx$;
see Section~\ref{sec:snake}.
 
\section{Connected commutative algebraic groups} \label{sec:connected}

\begin{proposition}\label{prop:connected}
  If $G$ is a connected commutative algebraic group over $\Fq$ then 
  the full subcategories $\QCf(G) \hookrightarrow \QCb(G) \hookrightarrow \QC(G)$ 
  appearing in Section~\ref{sec:bounded} are equivalences 
  and
  \[
  \trFrob{G} : \QCiso{G} \to G(\Fq)^*
  \]
  is an isomorphism of groups.
\end{proposition}

\begin{proof}
  Observe that the forgetful functor $(\gqcs{L},\mu,\phi) \mapsto (\gqcs{L},\phi)$
  sends quasicharacter sheaves on $G$ to $\ell$-adic Weil sheaves on $G$ \cite{deligne:80a}*{1.1.10}.
  While is it not true that all Weil sheaves on $G$ descend to local systems on $G$, 
  we will see that those that appear in the image of this forgetful functor from quasicharacter sheaves do. 

  Let $g$ be any $\Fq$-rational point on $G$ 
  and let $\bg$ be the geometric point on $G$ lying above $g$ 
  (we fixed $\Fq \hookrightarrow \bFq$ long ago). 
  Since $G$ is connected, the geometric point $\bg$ determines
  an equivalence between the category of $\ell$-adic Weil local systems on $G$ and
  $\ell$-adic representations of $\W(G,\bg)$ \cite{deligne:80a}*{1.1.12}. 
  Now let $(\gqcs{L},\mu,\phi)$ be a quasicharacter sheaf on $G$ 
  and let $\rho : \W(G, \bg) \to \EEx$ be the character determined by $(\gqcs{L},\phi)$. 
  The $\Fq$-rational point $g$ under the geometric point $\bg$ determines a splitting
  $\Weil{\Fq}\to \W(G,\bg)$ of $\W(G,\bg)\to \Weil{\Fq}$. 
  In this way the Weil local system $(\gqcs{L},F)$ determines an $\ell$-adic character $\rho_g : \Weil{\Fq} \to \EEx$.
  %\[
  %\begin{tikzcd}
  %1 \rar & \pi_1(\bG, \bg) \rar &  \arrow{d}{\rho} \W(G,\bg) \rar
  %& \ar[swap,bend right, dotted]{l}{g} \arrow[dotted]{dl}{\rho_g} \Weil{\Fq} \rar & 1\\
  %&&\EEx&&
  %\end{tikzcd}
  %\]
  This character is given by the trace of Frobenius of $\qcs{L}$ at $g$, as defined in Section~\ref{sec:Frob}:
  \[
  \rho_g(\Frob{\Fq}) =  \trFrob{\qcs{L}}(g).
  \]
  
  On the other hand, we have already seen that $\trFrob{\qcs{L}} : G(\Fq) \to \EEx$
  is a group homomorphism. Since $G$ is an algebraic group over $\Fq$, it is a
  variety over $\Fq$, so finitely generated over $\Fq$, so $G(\Fq)$ is finite;
  it follows that $\trFrob{\qcs{L}}(g) = \rho_g(\Frob{\Fq})$ is a root of unity,
  for every $g\in G(\Fq)$.  Since $\Weil{\Fq}$ is generated by
  $\Frob{\Fq}$ and $\rho_g : \Weil{\Fq} \to \EEx$ is
  a character, it follows that the image of $\rho_g$ is a finite group.
  Thus, $\rho_g$ extends to an $\ell$-adic character of $\Gal(\bFq/\Fq)$, 
  denoted by the same symbol, below.
  \[
  \begin{tikzcd}
  1 \rar & \ar[equal]{d} \pi_1(\bG, \bg) \rar & \W(G,\bg) \rar \dar & \Weil{\Fq} \arrow[bend left]{rr}{\rho_g} \rar \dar & 1 & \EEx\\
  1 \rar &  \pi_1(\bG, \bg) \rar & \pi_1(G,\bg) \rar & \Gal(\bFq/\Fq) \arrow[dotted]{rru} \rar & 1 &
  \end{tikzcd}
  \]

  We may now lift the $\ell$-adic character $\rho_g : \Gal(\bFq/\Fq) \to \EEx$
  to an $\ell$-adic character $\pi_1(G,\bg) \to \EEx$ using the canonical topological group homomorphism
  $\pi_1(G,\bg) \to \Gal(\bFq/\Fq)$ determined by the structure map for $G$. But $\bg$ also
  determines an equivalence between the category of $\ell$-adic
  representations of $\pi_1(G,\bg)$ and $\ell$-adic local systems on $G$. Let
  $\qcs{L}_0$ be a local system on $G$ in the isomorphism class
  determined by this $\ell$-adic character of $\pi_1(G,\bg)$.
  Then $b_G^*\qcs{L}_0 \iso \gqcs{L}$.
  Since $b_G^*$ is full and faithful (again, see \cite{deligne-katz:SGA7.2}*{Expos\'e XIII}
  or even \cite{beilinson-bernstein-deligne:81a}*{Prop. 5.2.1}),
  $
  b_{G\times G}^* : \Hom(m^*\qcs{L}_0,\qcs{L}_0\boxtimes\qcs{L}_0) \to \Hom({\bar m}^*\gqcs{L},\gqcs{L}\boxtimes\gqcs{L})
  $ 
  is a bijection 
  (hom taken in the categories on constructible $\ell$-adic sheaves on 
  $G\times G$ and ${\bar G}\times {\bar G}$ respectively, 
  in which $\ell$-adic local systems sit as full subcategories). 
  Let $\mu_0 : m^*\qcs{L}_0 \to \qcs{L}_0\boxtimes\qcs{L}_0$ be the isomorphism matching 
  $\mu : {\bar m}^*\gqcs{L} \to \gqcs{L}\boxtimes\gqcs{L}$, 
  the latter appearing in the definition of $\qcs{L}$. 
  Then, as in Section~\ref{sec:bounded}, $(\qcs{L}_0,\mu_0)$ is an object in $\QCb(G)$ 
  and $\qcs{L} = (\gqcs{L},\mu,\phi)$ is isomorphic to $(b_G^*\qcs{L}_0,b_{G\times G}^*\mu_0)$ in $\QC(G)$.
  Thus, the full and faithful functor $B_G^* : \QCb(G) \to \QC(G)$ from Section~\ref{sec:bounded}
  is also essentially surjective, hence an equivalence.
  %(when $G$ is a connected, commutative algebraic group over $\Fq$).
  
  In Section~\ref{sec:finite} we saw that $\QCf(G)$ is a full subcategory of $\QCb(G)$;
  more precisely, we exhibited a full and faithful functor $L_G : \QCf(G) \to \QCb(G)$.
  We now show that this functor is essentially surjective 
  when $G$ is a connected, commutative algebraic group over $\Fq$.
  
  Let $(\qcs{L}_0,\mu_0)$ be a bounded quasicharacter sheaf on $G$. 
  Then $\qcs{L}\ceq B_G^*(\qcs{L}_0,\mu_0)$ is a quasicharacter sheaf on $G$.
  Recall the definition of the character $\trFrob{\qcs{L}} : G(\Fq) \to \EEx$ from Section~\ref{sec:Frob}. 
  Let $f : G\to G$ be the Lang isogeny.
  Recall that $\ker f = G(\Fq) = G^{\Frob{\Fq}}$; 
  in particular, the action of $\Gal(\bFq/\Fq)$ on $\ker f$ is trivial.
  Let $V = \EE$ and let $\psi : \ker f \to \Aut(V)$ be the representation given by 
  $\psi(g)(v) = \trFrob{\qcs{L}}(g) v$ for $v\in V$. 
  Then $(f,\psi)$ is a finite quasicharacter sheaf. 
  
  To show that $L_G(f,\psi) \iso (\qcs{L}_0,\mu_0)$ we simply apply the functions--sheaves dictionary
  as follows ({\it cf} \cite{laumon:87a}*{1.1.3} or, ultimately, \cite{deligne:SGA4.5}*{Sommes trigonomÃ©triques}).
  First, recall that $L_G(f,\psi) = (L(f,\psi), \mu(f,\psi))$.
  Let $k'/k$ be any degree-$n$ extension and let $\Nm : k'\to k$ be the norm map. 
  By \cite{laumon:87a}*{1.1.3.3}, 
  \[
  \trFrob{(G_{k'}\hookrightarrow G)^*L(f,\psi)} = \trFrob{\qcs{L}} \circ \Nm;
  \]
  on the other hand, 
  \[
  \trFrob{\qcs{L}} \circ \Nm = \trFrob{(G_{k'}\hookrightarrow G)^*\qcs{L}},
  \]
   by Proposition~\ref{prop:basechange}.
  %Using notation from \cite{laumon:87a}*{1.1}, this means $t_{\bullet L(f,\psi)} = t_{\bullet \qcs{L}_0}$.
  Using \cite{laumon:87a}*{Th\'eor\`eme~1.1.2}, it follows that  $L(f,\psi) \iso \qcs{L}_0$ in $\Loc(G)$.
  It is now clear that $(L(f,\psi),\mu(f,\psi)) \iso (\qcs{L}_0,\mu_0)$ in $\QCb(G)$.
  This completes the proof that $L_G : \QCf(G) \to \QC(G)$ is essentially surjective.
  Since we have already seen (in Section~\ref{sec:finite}) that $L_G$ is full and faithful, 
  it follows that $L_G$ is an equivalence.
  
  To finish the proof of Proposition~\ref{prop:connected}, it suffices to observe that the group homomorphism
  $
  \trFrob{G} : \QCiso{G} \to G(\Fq)^*
  $
  is surjective because each character $\chi \in G(\Fq)^*$ determines a finite quasicharacter
  sheaf $(\Lang,\chi^{-1})$ such that the trace of Frobenius of the quasicharacter sheaf
  $B_G^* (L_G(\Lang,\chi^{-1}))$ is $\chi$.
\end{proof}

As Proposition~\ref{prop:connected} shows, 
when $G$ is a connected algebraic group over $\Fq$, 
it is appropriate to replace quasicharacter sheaves on $G$ 
with the conceptually simpler category $\QCf(G)$ of finite quasicharacter sheaves on $G$. 
In this context, finite quasicharacter sheaves may also be apprehended as
\emph{certain} $\ell$-adic characters of fundamental group $\pi_1(G,{\bar e})$. 
As explained in \cite{kamgarpour:09a}*{\S~2}, 
the relevant characters of $\pi_1(G,{\bar e})$ are precisely those 
that factor through a particular quotient of $\pi_1(G,{\bar e})$ 
denoted there by $\Pi_\text{disc}(G)$.
%\[\pi_1(G,{\bar e}) \to \Pi_\text{et}(G) \to \Pi_\text{et}(G)_{\Gal(\bFq/\Fq)} = \Pi_\text{disc}(G)\]
From this it is apparent that the category of discrete isogenies to $G$ is a Galois category,
in the sense of \cite{grothendieck:SGA1}*{Expos\'e V, \S 4}. Moreover, since $\Pi_\text{disc}(G) \iso G(\Fq)$,
as shown in \cite{kamgarpour:09a}*{App'x B}, this provides an alternate proof of $\QCiso{G} \to G(\Fq)^*$.

In principle, something similar is possible in the more general 
context of this paper, where $G$ is a smooth group scheme 
locally of finite type over $\Fq$, to which we now return. 
In this generality, neither of the full subcategories $\QCf(G) \subset \QCb(G) \subset \QC(G)$ are equivalences;
see the end of Section~\ref{sec:snake}.
Nevertheless, every quasicharacter sheaf $(\gqcs{L},\mu,\phi)$ on $G$ 
determines a Weil sheaf $(\gqcs{L},\phi)$ on $G$. 
So, if we choose a geometric point ${\bar g}_x$ in each component $\bG^x$ of $G$, then this choice can be used to convert 
the Weil sheaf $(\gqcs{L},\phi)$ into an $\ell$-adic character of $\prod_{x\in \pi_0(\bG)}\W(\bG^x, {\bar g}_x)$. 
However, it proved cumbersome to manage various 
choices of families of base points and track the action 
of $\Gal(\bFq/\Fq)$ on this (generally) infinite product of 
Weil groups and difficult to identify the relevant quotient of this group.
Viewed in this light, Definition~\ref{def:QC} is comparatively simple.

\section{Commutative \'etale group schemes} \label{sec:etale}

%\input{etale-1}
%In this section we establish a fundamental property of character
% sheaves on commutative \'etale group schemes over $\Fq$ that are
% geometrically finitely generated.

\'Etale group schemes form a counterpoint to connected groups,
since the component group of a group scheme locally of finite type over $\Fq$
is an \'etale group scheme (locally of finite type) over $\Fq$
\cite{vdGeer-Moonen:AbelianVarieties}*{III, \S 4}.
The functor $G \mapsto G(\bFq)$ defines an equivalence of categories
between the category of \'etale group schemes over $\Fq$ and the category of groups equipped
with an action of $\Gal(\bFq/\Fq)$, continuous for the discrete topology on the group.
Under this equivalence, a quasicharacter sheaf on $G$ is given by the data of:
\begin{enumerate}
 \labitem{(cs.0)}{cs.0} an indexed set of one-dimensional
  $\EE$-vector spaces $\gqcs{L}_x$, as $x$ runs over
  $G(\bFq)$;

 \labitem{(cs.1)}{cs.1} an indexed set of isomorphisms
  $\mu_{x,y} : \gqcs{L}_{x+y} \mathop{\longrightarrow}\limits^{\iso} \gqcs{L}_{x} \otimes\gqcs{L}_{y}$,
  for all $x,y \in G(\bFq)$, such that
  \[
   \begin{tikzcd}[row sep=40]
    \gqcs{L}_{x+y+z} \arrow{rr}{\mu_{x+y,z}} \arrow[swap]{d}{\mu_{x,y+z}}
    && \gqcs{L}_{x+y}\otimes\gqcs{L}_{z} \dar{\mu_{x,y} \tight{0.5}{\otimes}{1} \id} \\
    \gqcs{L}_{x} \otimes\gqcs{L}_{y+z} \arrow{rr}{\id \otimes\mu_{y,z}}
    && \gqcs{L}_{x} \otimes\gqcs{L}_{y} \otimes\gqcs{L}_{z}
   \end{tikzcd}
  \]
  commutes, for all $x,y,z\in G(\bFq)$; and

 \labitem{(cs.2)}{cs.2} an indexed set of isomorphisms $\phi_{x} : \gqcs{L}_{\Frob{\Fq}(x)} \to \gqcs{L}_x$
  such that
  \[
   \begin{tikzcd}[row sep=40]
    \gqcs{L}_{\Frob{\Fq}(x)+\Frob{\Fq}(y)} \arrow[swap]{d}{\phi_{x+y}} \arrow{rr}{\mu_{\Frob{\Fq}(x),\Frob{\Fq}(y)}}
    && \gqcs{L}_{\Frob{\Fq}(x)}\otimes\gqcs{L}_{\Frob{\Fq}(y)} \dar{\phi_x \tight{0}{\otimes}{0} \phi_y} \\
    \gqcs{L}_{x+y} \arrow{rr}{\mu_{x,y}}
    && \gqcs{L}_x \otimes\gqcs{L}_y
   \end{tikzcd}
  \]
  commutes, for all $x,y\in G(\bFq)$.
\end{enumerate}
Under this equivalence, a morphism $\alpha : \qcs{L} \to \qcs{L'}$ of quasicharacter sheaves on $G$ is given by 
\begin{enumerate}
 \labitem{(cs.3)}{cs.3} an indexed set $\alpha_x : \gqcs{L}_x \to \gqcs{L'}_x$
  of linear transformations (of one-dimensional $\EE$-vector spaces),
  as $x$ runs over $G(\bFq)$, such that
  \[
   \begin{tikzcd}[column sep=40]
    \arrow[swap]{d}{\phi_x} \gqcs{L}_{\Frob{\Fq}(x)} \rar{\alpha_{\Frob{\Fq}(x)}} & \gqcs{L'}_{\Frob{\Fq}(x)} \dar{\phi_x'}
    &\arrow[draw=none]{d}[pos=.4,description]{\text{\normalsize{and}}}
    & \arrow[swap]{d}{\mu} \gqcs{L}_{x+y} \rar{\alpha_{x+y}} & \gqcs{L'}_{x+y} \dar{\mu'_{x+y}} \\
    \gqcs{L}_x \rar{\alpha_x} & \gqcs{L'}_x
    & {} & \gqcs{L}_x\otimes\gqcs{L}_y \rar{\alpha_x\otimes\alpha_y} & \gqcs{L'}_x \otimes\gqcs{L'}_y
   \end{tikzcd}
  \]
  both commute.
\end{enumerate}

\begin{lemma}\label{lemma:section}
 If $\qcs{L}$ is a quasicharacter sheaf on a commutative, \'etale group scheme $G$
 over $\Fq$ and if $G(\bFq)$ is finitely generated, then there is a global section
 $s = \{ s(x) \in \gqcs{L}_x \tq x \in G(\bFq) \}$ satisfying
 \begin{equation}\label{section}
 \end{equation}
\end{lemma}

\begin{proof}
  Since $G(\bFq)$ is a finitely-generated abelian group, it admits a decomposition
  \[
  G(\bFq) \iso \ZZ^r \oplus \bigoplus_{j=1}^t \ZZ / m_j \ZZ;
  \]
  let $x_1, \ldots, x_r, y_1, \ldots, y_t$ be a corresponding set of generators of $G(\bFq)$.
  We will define a section $s$ satisfying \eqref{section} by choosing values on these generators and extending to all
  of $G(\bFq)$ through \eqref{section}.
  
  There is a unique isomorphism $\gqcs{L}_0 \cong \EE$ under which $\mu_{0,0}$ corresponds
  to the multiplication map $\EE \otimes\EE \to \EE$.
  The condition $\mu_{0,0}(s(0)) = s(0) \otimes s(0)$ together with the non-triviality of $s$
  then forces $s(0) = 1$.
  
  The $\mu_{x,y}$ yield an isomorphism $\alpha_j : \gqcs{L}_{y_j}^{\otimes m_j} \to \gqcs{L}_0$.
  An initial nonzero choice of $s(y_j)$ need only be scaled by $\alpha_j(s(y_j))^{-1/m_j}$ in order to map to
  $1$ under this isomorphism.  Since compatibility under the $\alpha_j$ are the only constraints on the
  $s(x_j)$ and $s(y_j)$, global sections exist.
\end{proof}

The main result of Part~\ref{part1} of this paper, 
the sheaf--function dictionary for $G$ Theorem~\ref{thm:snake}, has a hypothesis: 
the smooth commutative group scheme locally of finite type must have the 
property that the geometric component group of $G$ is finitely generated as a group. 
The genesis of that hypothesis is Lemma~\ref{lemma:section},
as we use this hypothesis to show the existence of global sections of $\gqcs{L}$ satisfying \eqref{section} for $\mu$.
Remarkably, Lemma~\ref{lemma:section} is the only crux for this hypothesis;
that is, if $G$ is any smooth connected group scheme locally of finite type over $\Fq$
and if each quasicharacter sheaf on the \'etale group scheme $\pi_0(G)$ admits a global section 
satisfying \eqref{section}, then the conclusion of Theorem~\ref{thm:snake} holds for $G$,
so there is a sheaf--function dictionary for $G$.

\begin{proposition}\label{prop:etale}
  If $G$ is a commutative \'etale group scheme over $\Fq$ and
  $G(\bFq)$ is finitely generated then there is a canonical
  isomorphism
  \[
  \QCiso{G} \longrightarrow \Hh^1(\Weil{\Fq}, G(\bFq)^*),
  \qquad \text{given by}\qquad
  \qcs{L}_{/\text{iso}} \mapsto [\tau_\qcs{L}],
  \]
  where $\tau_\qcs{L}: \Weil{\Fq}\to G(\bFq)^*$ is a cocycle such that
  \[
  \forall x\in G(\Fq), \qquad \tau_\qcs{L}(\Frob{\Fq})(x) = \trFrob{\qcs{L}}(x).
  \]
\end{proposition}

\begin{proof}
  Suppose $\qcs{L}$ is a quasicharacter sheaf on $G$.  
  Using Lemma~\ref{lemma:section}, 
  we may choose a section $s = \{ s(x) \in \gqcs{L}_x \tq x \in G(\bFq) \}$ satisfying \eqref{section}.
  We will construct a group isomorphism between $\QCiso{G}$ and
  $\Hh^1(\Weil{\Fq}, G(\bFq)^*)$ using $s$, then prove independence from the choice of $s$.

  Starting from $\qcs{L}$, we define a cocyle $\tau_{\qcs{L}} \in Z^1(\Weil{\Fq},G(\bFq)^*)$ as follows.
  For $x \in G(\bFq)$, $\qcs{L}$ determines an isomorphism $\phi_x : \gqcs{L}_{\Frob{\Fq}(x)} \to \gqcs{L}_x$
  of one-dimensional $\EE$-vector spaces; define $\tau_\qcs{L}$ by
  \begin{equation}\label{t}
   \phi_{x}(s(\Frob{\Fq}(x))) = \tau_\qcs{L}(\Frob{\Fq})(x) s(x).
  \end{equation}
  Note that if $x$ is fixed by $\Frob{k}$ then $\tau_\qcs{L}(\Frob{\Fq})(x)$ is just $\trFrob{\qcs{L}}(x)$, so the restriction of
  $\tau_\qcs{L}(\Frob{k})$ to $G(k)$ is just $\trFrob{\qcs{L}}$.
  In general, conditions \ref{cs.0} and \ref{cs.2}, together with \eqref{section}, guarantee that
  the scalar $\tau_\qcs{L}(\Frob{k})(x)$ is non-zero.  Moreover, condition~\ref{cs.1} forces
  $\tau_\qcs{L}(\Frob{\Fq})(x+y) = \tau_\qcs{L}(\Frob{\Fq})(x) \ \tau_\qcs{L}(\Frob{\Fq})(y)$
  for all $x,y \in G(\bFq)$.  Now define $\tau_\qcs{L} : \Weil{\Fq} \to G(\bFq)^*$ recursively by
  \[
   \tau_\qcs{L}(\Frob{\Fq}^n) \ceq \tau_\qcs{L}(\Frob{\Fq})\cdot \,^{\Frob{\Fq}} \tau_\qcs{L}(\Frob{\Fq}^{n-1}),
  \]
  where $\Frob{\Fq}$ acts on $G(\bFq)^*$ through pre-composition and $\cdot$ refers
  to pointwise multiplication of functions.

  Although we used a global section $s$ in the definition of
  $\tau_\qcs{L}$, the class of $\tau_\qcs{L}$ does not depend on this
  choice. To see why, let $s_1$ and $s_2$ be two global sections of
  $\qcs{L}$ and let $\tau_1$ and $\tau_2$ be the cocycles defined by $s_1$ and $s_2$.
  For each $x \in G(\bFq)$ there is a unique scalar
  $a(x) \in \EEx$ such that $s_2(x) = a(x) s_1(x)$. Then \eqref{section} and
  condition~\ref{cs.1} together imply $a(x+y) = a(x)a(y)$, so
  $a\in G(\bFq)^*$.  The coboundary $\tau_0 : \Weil{\Fq} \to G(\bFq)^*$
  defined by $\tau_0(\Frob{\Fq}) = \,^{\Frob{\Fq}} a \cdot a^{-1}$ satisfies $\tau_2 = \tau_0 \tau_1$,
  so $\tau_2$ and $\tau_1$ are cohomologous. Thus
  \begin{equation}\label{cohomologous}
    \obj \QC(G) \longrightarrow \Hh^1(\Weil{\Fq},G(\bFq)^*),
    \qquad \text{defined by} \qquad \qcs{L} \mapsto [\tau_\qcs{L}],
  \end{equation}
  is independent of the choice of global sections made above.

  We now show that $[\tau_\qcs{L}]$ depends only on the isomorphism class of $\qcs{L}$.
  Let $\alpha : \qcs{L} \to \qcs{L'}$ be an isomorphism and
  let $\tau$ and $\tau'$ be any cocycles representing the classes in the
  image of $\qcs{L}$ and $\qcs{L'}$ under \eqref{cohomologous}; by construction,
  $\tau$ and $\tau'$ are defined by the choice of sections $s$ and $s'$ 
  according to Lemma~\ref{lemma:section}.
    Now, $\varphi_x(s(x))$ is a
  non-zero scalar multiple of $s'(x)$; define $a: G(\bFq) \to \EEx$
  by $\alpha_x(s(x)) = a(x) s'(x)$.
  By the second part of condition~\ref{cs.3},
  $a(x+y) = a(x)a(y)$, so $a \in G(\bFq)^*$. By the first part of
  condition~\ref{cs.3}, $\tau'(\Frob{\Fq}) = \tau(\Frob{\Fq}) \cdot (\,^{\Frob{\Fq}^{-1}}a \cdot a^{-1})$,
  \Clifton{Fix this.}
  so $\tau$ and $\tau'$ are cohomologous. This shows that
  \begin{equation}\label{pich1}
    \QCiso{G} \longrightarrow \Hh^1(\Weil{\Fq},G(\bFq)^*), \qquad \qcs{L}_{/\text{iso}} \mapsto [\tau_\qcs{L}]
  \end{equation}
  is well-defined.
  
    Suppose that $\qcs{L}$ and $\qcs{L}'$ are two quasicharacter sheaves on $G$.
  If $s$ is a global section for $\qcs{L}$ and $s'$ for $\qcs{L}'$ then $s \otimes s'$
  is a global section for $\qcs{L} \otimes\qcs{L}'$.  The three versions of \eqref{t}
  for $\qcs{L}, \qcs{L'}$ and $\qcs{L} \otimes\qcs{L}'$ imply that
  $\tau_{\qcs{L} \otimes\qcs{L}'}(\Frob{k}) = \tau_\qcs{L}(\Frob{k}) \tau_{\qcs{L}'}(\Frob{k})$,
  so \eqref{pich1} is a group homomorphism.
 
 
 To see that \eqref{pich1} is injective,
 suppose $[\tau_\qcs{L}] = [\tau_\qcs{L'}]$.
 Let $s$ (resp. $s'$) be a section appearing in the definition of $\tau_\qcs{L}$ (resp. $\tau_\qcs{L'}$);
 recall that $s$ (resp. $s'$) is compatible with $\mu$ (resp $\mu'$) 
 in the sense of Lemma~\ref{lemma:section}.
 Since $[\tau_\qcs{L}] = [\tau_\qcs{L'}]$, 
 it follows that $\tau_\qcs{L}$ and $\tau_{\qcs{L'}}$ are cohomologous, 
  so there is some $a\in G(\Fq)^*$ such that 
  $\tau'(\Frob{\Fq}) = \tau(\Frob{\Fq}) \cdot (\,^{\Frob{\Fq}}a \cdot a^{-1})$. 
  Define $\alpha : \qcs{L}\to \qcs{L'}$ by $\alpha_x(s(x)) = a(x) s'(x)$, for each $x\in G(\bFq)$.
  It is straightforward to check that $\alpha$ satisfies condition~\ref{cs.3}
  and that $\alpha^{-1} : \qcs{L'}\to \qcs{L}$, defined by $\alpha^{-1}_x(s'(x)) = a(x)^{-1} s(x)$, 
  is its inverse. Thus, $\qcs{L} \iso \qcs{L'}$ in $\QC(G)$. 
  This shows that \eqref{pich1} is injective.
  

 Finally, to show that \eqref{pich1} is surjective, pick $[\tau]\in \Hh^1(\Weil{\Fq}, G(\bFq)^*)$.
 For each $x\in G(\bFq)$, set $\gqcs{L}_x = \EE$.
 Define $\mu_{x,y} : \gqcs{L}_{x+y} \to \gqcs{L}_x\otimes \gqcs{L}_y$ by
 $\mu_{x,y}(1) = 1\otimes1$, for $x,y\in G(\bFq)$; 
 clearly, $\mu$ satisfies condition~\ref{cs.1}.
 Define $\phi_x : \gqcs{L}_{\Frob{\Fq}} \to \gqcs{L}_x$ by $\phi_x(1) = \tau(\Frob{\Fq})(x)$,
 for each $x\in G(\bFq)$. 
 Then $\phi$ satisfies condition~\ref{cs.2} because $\tau \in Z^1(\Weil{\Fq},G(\bFq)^*)$.
 In this way we have built a quasicharacter sheaf $\qcs{L} = (\gqcs{L},\mu,\phi)$ 
 from $\tau \in \Hh^1(\Weil{\Fq}, G(\bFq)^*)$ such that the image of $\qcs{L}_{/\text{iso}}$
 under \eqref{pich1} is the class $[\tau]$ in $\Hh^1(\Weil{\Fq}, G(\bFq)^*)$.
 This shows that \eqref{pich1} is surjective, 
 and completes the proof that it is an isomorphism of groups.
\end{proof}

\section{On the cohomology of the dual of an \'etale group scheme} \label{sec:etalecohom}

\Clifton{Now this section does mention quasicharacter sheaves.}
Although this section does not mention quasicharacter sheaves, 
we will need Proposition~\ref{prop:X} to prove our main result on quasicharacter sheaves, 
Theorem~\ref{thm:snake}.

\begin{proposition}\label{prop:X}
  Let $X$ be a finitely generated abelian group equipped with an
  action of $\Gal(\bFq/\Fq)$, continuous for the discrete topology on
  $X$.  Then
\[
    \Hh^1(\Fq, X^*) \xrightarrow{\rho} \Hh^0(\Fq, X)^*,
 \qquad \text{defined by}\qquad
   \rho([z])(x) = z(\Frob{\Fq})(x),
\]
  is an isomorphism of groups.
\end{proposition}
\begin{proof}
  We first prove that $\rho$ is surjective.  Suppose that
  $f \in \Hom(X^{\Frob{\Fq}}, \EEx).$ Since $\EEx$ is divisible
  as an abelian group it is injective as a $\ZZ$-module and thus
  $\Ext^1_{\ZZ}(X/X^{\Frob{\Fq}}, \EEx) = 0$.  Applying the functor
  $\Hom(\mbox{---}, \EEx)$ to
  \[
  \begin{tikzcd}
  0 \rar & X^{\Frob{\Fq}} \rar & X \rar & X/X^{\Frob{\Fq}} \rar & 0
  \end{tikzcd}
  \]
  and considering the associated long exact sequence gives the
  existence of an $\tilde{f} \in \Hom(X, \EEx)$ restricting to
  $f$.  Define a $1$-cocycle $z \in \Hh^1(\Fq, \Hom(X,\EEx))$ by
  mapping $\Frob{\Fq}$ to $\tilde{f}$.  Then $\rho([z]) = f$.

  Now suppose that $[z] \in \Hh^1(\Fq,\Hom(X,\EEx))$ with
  $\rho([z]) = 1$; write $\tilde{f}$ for $z(\Frob{\Fq})$.  The injectivity
  of $\rho$ is equivalent to the existence of a homomorphism $\psi
  \colon X \rightarrow \EEx$ with
  $$\tilde{f}(x) = \frac{\psi(\Frob{\Fq}(x))}{\psi(x)}$$
  for $x \in X$.  In fact, we may replace the construction of $\psi$
  for all $\ZZ[\Gal(\bFq/\Fq)]$-modules $X$ with the construction of
  analogous $\psi$s for a different class of modules.

  Since the action of $\Gal(\bFq/\Fq)$ is continuous, there is an $m$
  so that $\Frob{\Fq}^m$ acts trivially on $X$; write $\Fqm$ for the degree
  $m$ extension of $\Fq$ and $\Gamma_m$ for $\Gal(\Fqm/\Fq)$.  Since
  $T^m-1$ factors as a squarefree product of cyclotomic polynomials,
  the Chinese remainder theorem expresses $\ZZ[\Gamma_m]$ as a product
  of $\ZZ[\zeta_d]$ for $d$ dividing $m$.  Each $\ZZ[\zeta_d]$ is the
  maximal order in a number field and thus $\ZZ[\Gamma_m]$ is a
  product of Dedekind domains.  Therefore $X$ decomposes into a direct
  sum of cyclic $\ZZ[\Gamma_m]$-modules \cite{brandal:CommRingsFGModDecompose}, \David{more specific citation}
  each of the \David{Add a reference to this section}
  form $\ZZ[\Gamma_m] / I$ for some ideal $I \subset \ZZ[\Gamma_m]$.
  The ideal $I$ corresponds to a direct product of ideals $I_d$ in the
  $\ZZ[\zeta_d]$, and within each $\ZZ[\zeta_d]$ the Chinese remainder
  theorem allows a further decomposition of $\ZZ[\zeta_d] / I_d$ as a
  direct sum of $\ZZ[\zeta_d]$-modules of the form $\ZZ[\zeta_d]/P^s$.
  So if we can construct, for every cyclotomic ring $\ZZ[\zeta_d]$,
  prime ideal $P \subset \ZZ[\zeta_d]$ and positive integer $s$, a
  $\psi \colon \ZZ[\zeta_d]/P^s \rightarrow \EEx$ with
  \begin{equation} \label{eq:psi-condition}
    \tilde{f}(x) = \frac{\psi(\zeta_d \cdot x)}{\psi(x)},
  \end{equation}
  then the existence of the original $\psi$ follows because $X$ is a
  direct sum of such $\ZZ[\zeta_d]/P^s$.

  We now fix a $d$, $P$ and $s$, write $\zeta$ for $\zeta_d$ and
  choose a polynomial
  $$h(T) = a_rT^r + a_{r-1}T^{r-1} + \cdots + a_0$$
  so that $P^s = (p^s, h(\zeta_d))$.
  % Setting $\psi = 1$ will satisfy Equation \ref{eq:psi-condition}
  % when $d = 1$.
  An an abelian group, the quotient $\ZZ[\zeta] / P^s$ is generated by
  $\zeta^i$ for $0 \le i < \phi(d)$; we define
  \begin{equation} \label{eq:psi-def}
    \psi(\zeta^i) = \alpha \prod_{j=0}^{i-1} \tilde{f}(\zeta^j)
  \end{equation}
  for an $\alpha \in \EEx$ to be chosen later.  Since there are
  relations among the $\zeta^i$ we first need to check that $\psi$ is
  well-defined.

  The relations among the generators $\zeta^i$ are additively
  generated by $\zeta^ch(\zeta)$ as $c$ ranges from $0$ to
  $\phi(d)-r-1$.  If we set
  $$A_c = \sum_{i=0}^r a_i \sum_{j=0}^{i+c-1} \zeta^j$$
  then
  $$\psi(\zeta^ch(\zeta)) = \alpha^{h(1)} \tilde{f}(A_c).$$
  Now consider $(\zeta - 1)A_c$: the sums telescope and we get that
  $(\zeta-1)A_c = \zeta^ch(\zeta) - h(1).$ There are now two
  possibilities:
  \begin{enumerate}
  \item $d$ is a power of $p$; write $s = \phi(d)m + n$.  We may take
    $h(T)$ to be $p^m(T-1)^n$, in which case $\zeta^ch(\zeta) - h(1) \in P^s$,
    so $A_c$ is fixed under multiplication by $\zeta$ in
    $\ZZ[\zeta]/P^s$ and thus $\tilde{f}(A_c) = 1$.  In this case
    $\alpha^{h(1)} = 1$ regardless of $\alpha$.
  \item $d$ is not a power of $p$.  If two distinct primes divide $d$
    then $\zeta - 1$ is a unit; otherwise $\zeta - 1$ is a unit modulo
    $P^s$.  Let $\omega \in \ZZ[\zeta]$ satisfy
    $\omega(\zeta - 1) \equiv 1 \pmod{P^s}$ and set
    \begin{equation} \label{alpha-def}
      \alpha = \tilde{f}(\omega).
    \end{equation}
    Then $A_c + h(1)\omega$ is fixed under multiplication by $\zeta$
    and thus $\tilde{f}(A_c) = \tilde{f}(-h(1)\omega)$.
  \end{enumerate}
  In either case, $\psi(\zeta^ch(\zeta)) = 1$ for all $c$.  The only
  other relations imposed on the $\zeta^i$ are that they are all
  killed under multiplication by $p^s$.  Since $\tilde{f}$ is also a
  homomorphism $\ZZ[\zeta]/P^s \rightarrow \EEx$ the values of
  $\tilde{f}$ and thus of $\psi$ will be $p^s$-roots of unity.
  Therefore $\psi$ is well defined.

  We now check Equation~\eqref{eq:psi-condition} for
  $x = \zeta^{\phi(d)-1}$.  Write
  $\Phi_d(T) = T^{\phi(d)} - b_{\phi(d)-1}T^{\phi(d)-1} - \cdots - b_0$
  and set
  $$B = \sum_{i=0}^{\phi(d)-1} -\zeta^i + b_i \sum_{j=0}^{i-1} \zeta^j.$$
  We have

  \begin{align*}
    \frac{\psi(\zeta^{\phi(d)})}{\psi(\zeta^{\phi(d)-1})\tilde{f}(\zeta^{\phi(d)-1})}
    &= \frac{\psi(b_{\phi(d)-1}\zeta^{\phi(d)-1} + \cdots + b_0)}{\psi(\zeta^{\phi(d)-1})\tilde{f}(\zeta^{\phi(d)-1})} \\
    &= \alpha^{-\Phi_d(1)} \tilde{f}(B)
  \end{align*}
  As before we see that $(\zeta - 1)B = \Phi_d(1) - \Phi_d(\zeta) = \Phi_d(1)$.
  We consider the same cases as before:

  \begin{enumerate}
  \item $d$ is a power of $p$, in which case $\Phi_d(1) = p$.  Thus
    $(\zeta-1)B = p = u(\zeta-1)^{\phi(d)}$ for a unit $u \in \ZZ[\zeta]$
    and $B - u(\zeta-1)^{\phi(d)-1}$ is fixed by $\zeta$,
    so that $\tilde{f}(B) = \tilde{f}(u(\zeta - 1)^{\phi(d)-1})$.  The
    multiplicative order of $\tilde{f}(u(\zeta-1)^{\phi(d)-1})$ is at most
    $\lceil \frac{s - 1 - (\phi(d)-1)}{\phi(d)}\rceil = \lceil \frac{s}{\phi(d)} \rceil - 1$
    while the additive order of $1 \in \ZZ[\zeta]/P^s$ is $\lceil \frac{s}{\phi(d)} \rceil$.
    Thus we may choose $\alpha = \psi(1)$ with $\alpha^p = \tilde{f}(B)$.
  \item $d$ is not a power of $p$ and $\omega$ is the inverse of
    $\zeta-1$ modulo $P^s$.  Then $\tilde{f}(B) = \tilde{f}(\omega\Phi_d(1))$.
  \end{enumerate}
  In either case, $\alpha^{-\Phi_d(1)}\tilde{f}(B) = 1$ and thus
  $\psi$ satisfies Equation~\eqref{eq:psi-condition} for
  $x = \zeta^{\phi(d)-1}$.  The definition of $\psi$ in \ref{eq:psi-def}
  immediately implies that $\psi$ satisfies equation
  \ref{eq:psi-condition} for lesser powers of $\zeta$, and thus for
  all $x$ by linearity.  The existence of $\psi$ shows that $\rho$ is injective.
\end{proof}

\begin{corollary}
 If $G$ is a commutative, \'etale algebraic group over $\Fq$ and $G(\bFq)$ is finitely
 generated then
  \[
  \trFrob{G} : \QCiso{G} \to G(\Fq)^*
  \]
  is an isomorphism of groups.
\end{corollary}

\section{Restriction to the identity component} \label{sec:restriction}

%\input{restriction}
% !TEX encoding = UTF-8 Unicode
%\subsection*{Restriction to the identity component is surjective}

Let $G^0$ be the connected component of $G$ containing the identity.
By Proposition~\ref{prop:pullback}, pull-back along
$G^0\hookrightarrow G$ determines a monoidal functor
$\qcs{L}\mapsto \qcs{L}\vert_{G^0}$ from $\QC(G)$ to $\QC(G^0)$.  In
this section we show that this functor is essentially surjective. 

\begin{proposition}\label{prop:restriction}
  The restriction functor $\QC(G)\to \QC(G^0)$ is essentially surjective.
\end{proposition}

\begin{proof}
  The identity component $G^0$ of $G$ is a connected algebraic group over $\Fq$, 
  clopen in $G$ \cite{vdGeer-Moonen:AbelianVarieties}*{3.17}. 
  By Proposition~\ref{prop:connected}, every
  quasicharacter sheaf on $G^0$ is isomorphic to a 
  finite quasicharacter sheaf on $G^0$, 
  so to prove the proposition it suffices to show that every 
  finite quasicharacter sheaf on $G^0$ extends to a quasicharacter sheaf on $G$.
  
 Let $(\pi,\psi)$ be a finite quasicharacter sheaf on $G^0$.
 By Lemma~\ref{lemma:ext}, there is an extension of the 
 discrete isogeny $\pi : B \to G^0$ 
 (see Section~\ref{sec:finite} for the definition of a discrete isogeny) 
 to a discrete isogeny $f : H \to G^0$ 
 such that $\pi_0(f) : \pi_0(H)\to \pi_0(G)$ is an isomorphism.
 Then $(f,\psi)$ is a finite quasicharacter sheaf on $G$.
 Then $(f,\psi)\vert_{G^0} \iso (\pi,\psi)$,
 completing the proof that $\QC(G)\to \QC(G^0)$ is essentially surjective.
\end{proof}

\begin{lemma}\label{lemma:ext}
Every discrete isogeny (see Section~\ref{sec:finite}) to $G^0$ extends to a discrete
isogeny to $G$ such that the component group of the covering space is isomorphic
to the component group of $G$.
\end{lemma}

\begin{proof}
Let $\pi: B \to G^0$ be a discrete isogeny; set $A = \ker \pi$.
  We will find a discrete isogeny $f: H\to G$
  such that that $H^0 = B$, $f^0 =\pi$ and
  $\pi_0(f) : \pi_0(H)\to \pi_0(G)$ is an isomorphism of component
  groups.
  \begin{equation}\label{extension-diagram}
  \begin{tikzcd}
  A \arrow[equal]{r} \dar & A \dar \\
  B \rar \dar[swap]{\pi} & H \rar \dar[swap]{f} & \pi_0(H) \arrow{d}[below,rotate=90]{\sim}[swap]{\pi_0(f)} \\
  G^0 \rar & G \rar & \pi_0(G)
  \end{tikzcd}
  \end{equation}
  where all rows and columns are exact and all maps are defined over
  $\Fq$.  We will do so by passing back and forth between group
  schemes over $\Fq$ and their $\bFq$-points.  
  
  Extensions of
  $G^0(\bFq)$ by $A(\bFq)$, such as $A(\bFq) \to H^0(\bFq) \to G^0(\bFq)$,
  correspond to classes in $\Ext^1_{\ZZ[\Gamma]}(G^0(\bFq), A(\bFq))$.
  Similarly, extensions of $G(\bFq)$ by $A(\bFq)$ correspond to
  classes in $\Ext^1_{\ZZ[\Gamma]}(G(\bFq), A(\bFq))$.  The map
  $G^0(\bFq) \to G(\bFq)$ induces the map
  $\Ext^1_{\ZZ[\Gamma]}(G(\bFq), A(\bFq)) \to \Ext^1_{\ZZ[\Gamma]}(G^0(\bFq), A(\bFq))$,
  fitting into the long exact sequence derived from applying
  the functor $\Hom(\mbox{---}, A(\bFq))$ to $G^0(\bFq) \to G(\bFq) \to \pi_0(G)(\bFq)$:
  \[
  \Ext^1_{\ZZ[\Gamma]}(G(\bFq), A(\bFq)) \to \Ext^1_{\ZZ[\Gamma]}(G^0(\bFq), A(\bFq)) \to \Ext^2_{\ZZ[\Gamma]}(\pi_0(G)(\bFq), A(\bFq)).
  \]
  We now show that $\Ext^2_{\ZZ[\Gamma]}(\pi_0(G)(\bFq), A(\bFq)) = 0$.

  It suffices to show that $\pi_0(G)(\bFq)$ has a two-term resolution
  by injective $\ZZ[\Gamma]$-modules.  Since the action of $\Gamma$ on
  $\pi_0(G)(\bFq)$ is continuous, it factor through a finite quotient
  $\Gamma_m = \Gamma / H_m$.  Any product of Dedekind domains has
  cohomological dimension $1$ \David{Add a citation for this fact}, so $\pi_0(G)(\bFq)$ has a
  two term resolution by injective $\ZZ[\Gamma_m]$-modules.  Let $I$
  be one of these modules: we need to show that $I$ is injective as a
  $\ZZ[\Gamma]$-module.  Consider the universal diagram for injectivity:
  
  \[
  \begin{tikzcd}
  A \rar{a} \arrow[hook]{d} & I \\
  B
  \end{tikzcd}
  \]
  where $A$ and $B$ are arbitrary $\ZZ[\Gamma]$-modules.  Since $H_m$ acts trivially on $I$,
  $I_{H_m}A \ceq \langle (\gamma-1)a : \gamma \in H_m, a \in A \rangle \subseteq \ker(a).$
  Since $B / I_{H_m}B \cong B \otimes_A A / I_{H_m}A$, we get
  \[
  \begin{tikzcd}
  A \arrow[two heads]{r} \arrow[hook]{d} & A/I_{H_m}A \rar \arrow[hook]{d} & I \\
  B \arrow[two heads]{r} & B/I_{H_m}B \arrow[dashed]{ur} & {}
  \end{tikzcd}
  \]
  The dotted arrow exists since $I$ is injective as a
  $\ZZ[\Gamma_m]$-module, and the outer diagram shows that $I$ is
  injective as a $\ZZ[\Gamma]$-module.

  We therefore have the existence of diagram \eqref{extension-diagram}
  at the level of $\bFq$-points.  This expresses $H(\bFq)$ as a
  disjoint union of translates of $B(\bFq)$; by transport of structure
  we may take $H$ to be a group scheme over $\bFq$.  Similarly, the
  restriction of $f$ to each component of $H$ is a morphism of
  schemes, and thus $f$ is as well.  Finally, the whole diagram
  descends to a diagram of $\Fq$-schemes since the $\bFq$-points of
  the objects come equipped with continuous $\Gamma$-actions, and the
  morphisms are $\Gamma$-equivariant.
\end{proof}

\section{The sheaf--function dictionary for non-connected groups}
\label{sec:snake}

We saw, in Proposition~\ref{prop:functorialG}, that the trace of Frobenius
$\trFrob{G} : \QCiso{G} \to G(\Fq)^*$ is a functorial group homomorphism.
Our main result regarding quasicharacter sheaves, below, shows that
trace of Frobenius is an isomorphism in the case that we care about.

%\input{snake}
\begin{theorem}\label{thm:snake}
  If $G$ is a smooth commutative group scheme locally of finite type over
  $\Fq$ and if the abelian group $\pi_0(G)(\bFq)$ (the geometric
  component group) is finitely generated then the trace of Frobenius
  \[
  \trFrob{G} : \QCiso{G} \to G(\Fq)^*
  \]
  is an isomorphism of groups.
\end{theorem}

\begin{proof}
  Recall the short exact sequence \eqref{eq:pi0} in the category of smooth group
  schemes, locally of finite type over $\Fq$, defining the component
  group scheme for $G$:
  \[
  \begin{tikzcd}
    1 \rar & G^0 \rar & G \rar & \pi_0(G) \rar & 0.
  \end{tikzcd}
  \]
  Let
  \[
  \begin{tikzcd}[row sep=30]
    {}& \ker \trFrob{\pi_0(G)} \dar & \arrow[dashed]{d} \ker \trFrob{G} & \ker \trFrob{G^0} \dar & \\
    0 \rar & \QCiso{\pi_0(G)} \rar \dar{\trFrob{\pi_0(G)}}
    & \QCiso{G} \rar \dar{\trFrob{G}} & \QCiso{G^0} \rar \dar{\trFrob{G^0}} & 0\\
    0 \rar & \pi_0(G)(\Fq)^* \rar \dar
    & \arrow[dashed]{d} G(\Fq)^* \rar & G^0(\Fq)^* \rar \dar & 0\\
    & \coker \trFrob{\pi_0(G)} & \coker \trFrob{G} &  \coker \trFrob{G^0} &
  \end{tikzcd}
  \]
  be the commutative diagram of abelian groups obtained by applying
  Proposition~\ref{prop:pullback} to \eqref{eq:pi0}.  Since $G^0$ is a connected algebraic group
  \cite{vdGeer-Moonen:AbelianVarieties}*{3.17},
  Proposition~\ref{prop:connected} implies that $\ker \trFrob{G^0} =0$ and $\coker \trFrob{G^0}=0$.
  By Propositions~\ref{prop:etale} and \ref{prop:X}, $\ker \trFrob{\pi_0(G)}=0$
  and $\coker \trFrob{\pi_0(G)}=0$.

  The sequence of character groups is left-exact: by
  Proposition~\ref{prop:pullback}, it is dual to the exact sequence of
  abelian groups
  \begin{equation}\label{eq:pi0k}
  \begin{tikzcd}
    1 \rar & G^0(\Fq) \rar & G(\Fq) \rar & \pi_0(G)(\Fq) \rar & 0;
  \end{tikzcd}
  \end{equation}
  since $\Hom(\ - \ ,\EEx)$ is left-exact, the sequence of
  character groups is left exact.

  The sequence of groups of isomorphism classes of quasicharacter sheaves is right-exact: it is exact at
  $\QCiso{G^0}$ by Proposition~\ref{prop:restriction}; and
  it is exact at $\QCiso{G}$ because the left-square
  commutes (by Proposition~\ref{prop:pullback}), the bottom sequence
  is exact at $G(\Fq)^*$ and $\coker \trFrob{\pi_0(G)} =0$
  (by Propositions~\ref{prop:etale} and \ref{prop:X}) and
  \[
  \image(\QCiso{\pi_0(G)} \to \QCiso{G}) \subseteq \ker(\QCiso{G} \to \QCiso{G^0}),
  \]
  by the last part of Proposition~\ref{prop:pullback}. Specifically,
  suppose $\qcs{L}$ is a quasicharacter sheaf on $G$ that is trivial on
  $G^0$. Then $\trFrob{\qcs{L}}\vert_{G^0(\Fq)} = \trFrob{\qcs{L}^0} =0$,
  by Proposition~\ref{prop:pullback} again. Since the sequence of
  character groups is exact at $G(\Fq)^*$, there is
  some $\chi \in \pi_0(G)(\Fq)^*$ such that the
  pull-back of $\chi$ along $G(\Fq)\to \pi_0(G)(\Fq)$ is
  $\trFrob{\qcs{L}}$. By Propositions~\ref{prop:etale} and \ref{prop:X},
  there is a a quasicharacter sheaf $\qcs{L}_\chi$ on $\pi_0(G)$, unique up
  to isomorphism, such that $\trFrob{\qcs{L}_\chi} = \chi$. By
  Proposition~\ref{prop:pullback} again, $\qcs{L}$ is isomorphic to the
  image of $\qcs{L}_\chi$ under the monoidal functor $\QC(\pi_0(G)) \to \QC(G)$.

  It now follows immediately from the snake lemma that $\trFrob{G}$ is an
  isomorphism of groups.
\end{proof}

With Theorem~\ref{thm:snake} on hand, 
we can see why neither bounded quasicharacter sheaves 
nor finite quasicharacter sheaves are up to the task of 
geometrizing characters of $G(\Fq)$ in the generality we need.  
%
Consider the case when $G$ is the discrete \'etale group scheme $\ZZ$. 
Let $\chi : G(\Fq) \to \EEx$ be the character determined by $\chi(1) = \ell$ 
and let $\qcs{L}$ be a quasicharacter sheaf in the isomorphism class 
corresponding to the character $\chi : G(\Fq) \to \EEx$ under Theorem~\ref{thm:snake}. 
Then $\trFrob{\qcs{L}}(1) = \ell$. Suppose $\qcs{L}$ was a bounded quasicharacter sheaf. 
Then the restriction of $\qcs{L}$ to the connected component $1\in G$ 
would be a $\ell$-adic local system on $1$ of rank-1, 
thus an $\ell$-adic character $\rho_1 : \pi_1(1,{\bar 1}) \to \EEx$ with
$\rho_1(\Frob{\Fq}) = \ell$. But $\pi_1(1,{\bar 1}) = \Gal(\bFq/\Fq) \iso {\hat \ZZ}$ is compact, 
while $\rho_1(\pi_1(1,{\bar 1}))$ is not compact in $\EEx$ (it contains $\ell^\ZZ$). 
So the Weil sheaf $\gqcs{L}$ does not descend to a local system on $G$.
It follows that the quasicharacter sheaf $\qcs{L}$ is not a bounded quasicharacter sheaf.
%
We can play the same game with the character $\chi : G(\Fq) \to \EEx$ 
defined by $\chi(1) = 1+\ell$. In this case, the corresponding quasicharacter sheaf $\qcs{L}$ is bounded,
defined at $1$ by a pro-\'etale cover of $1$, but not finite, since $1+\ell$ is not a root of unity. 
%
These simple examples illustrate why the categories $\QCb(G)$ and $\QCf(G)$ are inadequate to geometrize characters of $G(\Fq)$.


\part{Application to characters of algebraic tori over local fields}

Recall that $\Fq$ is a finite field.
Let $K$ be a non-archimedean local field with residue field $\Fq$.
We place no restriction on the characteristic of $K$. 
We write $\OK$ for the ring of integers of $K$ and $\pK$ for the maximal ideal in $\OK$. 
%For any positive integer $d$, set $A_d\ceq \OK/\pK^d$.
Let $T$ be an algebraic torus over $K$.
We write $\Hom_{< d}(T(K),\EEx)$ for the group of characters of $T(K)$ depth less than $d$ 
and $\Hom_{<\infty}(T(K),\EEx)$ for the group of characters of $T(K)$ of arbitrary finite depth;
one might call these quasicharacters of $T(K)$, expanding on \cite{tate:67a}*{2.3}.

\section{Greenberg of N\'eron}
\label{sec:GN}

A N\'eron model for $T$, denoted here by $\TT$ 
and whose existence is given by \cite{bosch-lutkebohmert-reynaud:NeronModels}*{Ch 10.1, Thm 6},
is a separated, smooth, commutative group scheme locally of finite type over $\OK$ with generic fibre $T$,
that enjoys the N\'eron mapping property:
if $S$ is a smooth scheme over $\OK$ then every morphism $S_\eta \to T$
over $K$ extends uniquely to a morphism $S \to \TT$. 
Equivalently, the
N\'eron mapping property states that the function
$\Hom_{\OK} (S,\TT) \to \Hom_K(S_\eta,T)$, given by restriction to
generic fibres, is a bijection; 
in particular, taking $S = \Spec{\OK}$, this implies $\TT(\OK) = T(K)$.

We will also need the Greenberg functor, 
introduced in \cite{greenberg:61} and \cite{greenberg:63a}, 
as a functor from the category of schemes locally of finite type 
over an Artinian local ring with perfect residue field $k$ 
to the category of schemes locally of finite type over $k$. 
This functor respects open immersions, closed immersions, 
etale morphisms and smooth morphisms. 
Besides Greenberg's original papers, 
see \cite{bosch-lutkebohmert-reynaud:NeronModels}*{Ch. 9, \S 6} 
and the first few sections of \cite{stasinski:12a} 
for background on the Greenberg functor. 

For any positive integer $d$, let
\[
%\begin{tikzcd}
\Gr_d : \left( \text{Schemes} \atop \text{lft over $\OK$}\right) \to \left( \text{Schemes} \atop \text{lft over $\Fq$}\right)
%\end{tikzcd}
\]
be the functor produced by precomposing pull-back along $\OK \to \OK/\pK^d$ with the Greenberg functor.
The surjective ring homomorphism $\OK/\pK^{d+1} \to \OK/\pK^d$ determines a natural transformation $P_{d} : \Gr_{d+1} \to \Gr_d$. 
%\cite{bosch-lutkebohmert-reynaud:NeronModels}*{p. 276}.
Set $\GN{T}_d = \Gr_d(\TT)$ and $f_d = P_d(\TT)$.
%
The fundamental properties of $f_d : \GN{T}_{d+1} \to \GN{T}_d$ that we need are:
 \begin{enumerate}
   \labitem{(GN.0)}{dFq} $\GN{T}_d(\Fq) = \TT(\OK/\pK^d)$, canonically.
  \labitem{(GN.1)}{GNd} $\GN{T}_d$ is a smooth, commutative group scheme,
  locally of finite type over $\Fq$, and the component group of $\GN{T}_d$ is
  geometrically finitely generated. (In fact, $\pi_0(\GN{T}_d) = \pi_0(\TT) \times_{\Spec{\OK}} \Spec{\Fq}$,
  and the latter is finitely generated by \cite{xarles:93a}*{2.18}.)
  \labitem{(GN.2)}{truncation}
  The morphism $f_d : \GN{T}_{d+1} \to \GN{T}_d$ is a surjective morphism of group schemes.
  \end{enumerate}

We remark that $f_d : \GN{T}_{d+1} \to \GN{T}_d$ is not induced from a morphism of NÃ©ron models.

\section{Application to quasicharacters of bounded depth} \label{sec:bdchar}

\begin{theorem}\label{thm:application}
Let $d$ be a positive integer.
For every algebraic torus $T$ over $K$, the trace of Frobenius 
  \[
\trFrob{T,d}:  \QCiso{\GN{T}_d} \to \Hom_{< d}(T(K),\EEx)
  \]
is an isomomorphism. 
Moreover, the isomorphism $\trFrob{T,d}$ is functorial in the following sense:
$T \mapsto \trFrob{T,d}$ is a natural transformation between the following two additive functors
\begin{enumerate}
\item[$F_1$:] $T \mapsto \QCiso{\GN{T}_d}$
\item[$F_2$:] $T \mapsto \Hom_{<d}(T(K),\EEx)$
\end{enumerate}
from the additive category of algebraic tori over $K$ to the category of abelian groups.
\end{theorem}

\begin{proof}
  By \ref{GNd}, we may apply Theorem~\ref{thm:snake} to
  $\GN{T}_d$ which provides a canonical isomorphism
  $\QCiso{\GN{T}_d} \iso \GN{T}_d(\Fq)^*$.
  By \ref{dFq}, $\GN{T}_d(\Fq) = \TT(\OK/\pK^d)$.
  Then we recall that the filtration of $T(K)$ used to
  define depth has the property that $\TT(\OK/\pK^d) \cong T(K) / T(K)_d$
  \cite{yu:03a}*{Prop 5.2}, so characters of $\GN{T}_d(\Fq)$ 
  are in bijection with characters of $T(K)$ vanishing on $T(K)_d$. 
  This shows that $\trFrob{T,d}$ is an isomorphism.
  
  Next we show that this isomorphism is functorial.
The first part of Proposition~\ref{prop:pullback} shows that $F_1$ is a functor,
while the second part shows that Trace of Frobenius is a natural transformation
$t: F_1 \to F_2$. When further combined with Lemma~\ref{prop:product},
we see that $F_1$ is an additive functor and $t: F_1 \to F_2$ is a
natural transformation between additive functors.
\end{proof}


\section{A sheaf--function dictionary for tori over local fields} \label{sec:quasichar} 

By Proposition~\ref{prop:pullback}, the surjective morphism $f_d : \GN{T}_{d+1}\to \GN{T}_d$ of group schemes induces a functor
\[
f_d^* : \QC(\GN{T}_d) \to \QC(\GN{T}_{d+1}).
\]

\begin{proposition}
The functor $f_d^* : \QC(\GN{T}_d) \to \QC(\GN{T}_{d+1})$ is full and faithful.
\end{proposition}

\begin{proof}
It suffices to find a morphism of schemes $i_d : \GN{T}_{d}\hookrightarrow \GN{T}_{d+1}$ such that $f_d\circ i_d = \id_{\GN{T}_d}$. Base change along $\OK/\pK^{d+1} \to \OK/\pK^d$ determines a closed immersion $\TT_{d+1} \hookrightarrow \TT_d$, though not a morphism of group schemes. Applying the Greenberg functor produces a closed immersion of schemes $i_d : \GN{T}_{d} \hookrightarrow \GN{T}_{d+1}$. Although $i_d$ is not a morphism of group schemes, it is a section of $f_d : \GN{T}_{d+1}\to \GN{T}_d$.
\end{proof}

Let $\QC(\GN{T})$ be the category of ind-objects built from the categories $\QC(\GN{T}_d)$. 
An object $\qcs{F}\in \QC(\GN{T})$ is an equivalence class in the disjoint union of objects $\qcs{L}\in \GN{T}_d$, 
as $d$ ranges over the positive integers, 
under the relation that identifies $\qcs{L}\in \QC(\GN{T}_{d})$ with $f_d^*\qcs{L}\in \QC(\GN{T}_{d+1})$.
For each $\qcs{F}\in \QC(\GN{T})$ there is a unique least positive integer $d$ and a unique isomorphism class $\qcs{L}_{/\iso}\in \QCiso{\GN{T}_d}$ such that $\qcs{F} = [\qcs{L}]$; we refer to $d$ as the \emph{level} of $\qcs{F}$.
A map $\alpha : [\qcs{L}] \to [\qcs{L}']$ in $\QC(\GN{T})$ is



We refer to objects of $\QC(\GN{T})$ as \emph{quasicharacter sheaves for $T$}.

\begin{definition}
The \emph{Greenberg transform of the N\'eron model of $T$} is the pro-group scheme over $\Fq$ given by
\begin{equation}\label{projlim}
  \cdef{\GN{T}} \ceq \varprojlim_{d\in \ZZ_{>0}} \GN{T}_{d}.
\end{equation}
\end{definition}


\begin{corollary}\label{cor:application}
For every algebraic torus $T$ over $K$, the trace of Frobenius 
  \[
\trFrob{T}:  \QCiso{\GN{T}} \to \Hom_{<\infty}(T(K),\EEx)
  \]
is an isomomorphism. 
Moreover, the isomorphism $\trFrob{T}$ is functorial in the following sense: 
$T \mapsto \trFrob{T}$ is a natural transformation 
between the following two additive functors
\begin{enumerate}
\item[$F_1$:] $T \mapsto \QCiso{\GN{T}}$
\item[$F_2$:] $T \mapsto \Hom_{<\infty}(T(K),\EEx)$
\end{enumerate}
from the additive category of algebraic tori over $K$ to the category of abelian groups.
\end{corollary}

\begin{proof}
Show $\QCiso{\GN{T}} = \varinjlim_{d\in \ZZ_{>0}} \QCiso{\GN{T}_d}$, then invoke Theorem~\ref{thm:application}.
\end{proof}

\Clifton{Make comments here about the depth-preserving isomorphism  . .  .}

\section{Transfer of quasicharacter sheaves} \label{sec:transfer}

The techniques in this paper apply to all non-archimdean local fields $K$ with residue field $k$,
and to all algebraic tori $T$ over $K$, without placing any restrictions on the characteristic of $K$
or on the ramification of $T$. Because of this, it is natural to ask if we can compare
quasicharacter sheaves on $T$ and on $T'$ under conditions when there is a
natural comparison between characters of $T(K)$ and of $T'(K')$.
This comparison of has been made precise in \cite{chai-yu:01a}, \David{more specific citation?}
building on ideas of \cite{deligne:84a}. 

We recall the notion of $N$-congruent tori from  \cite{chai-yu:01a}*{\S 2}.
Suppose $T$ and $T'$ are tori over non-archimedian local fields $K$ and $K'$,
splitting over $L$ and $L'$ respectively.
Then $T$ and $T'$ are said to be \emph{$N$-congruent} if there are isomorphisms
 \begin{align*}
  \alpha : \OL/\pi_K^N \OL &\to \OO{L'}/\pi_{K'}^N \OO{L'} \\
  \beta : \Gal(L/K) &\to \Gal(L'/K') \\
  \phi : X^*(T) &\to X^*(T')
 \end{align*}
 satisfying the conditions
 \begin{enumerate}
  \item $\alpha$ induces an isomorphism $\OK/\pi_K^N \OK \to \OO{K'}/\pi_{K'}^N \OO{K'}$,
  \item $\alpha$ is $\Gal(L/K)$-equivariant relative to $\beta$, and
  %: $\alpha(\gamma x) = \beta(\gamma) \alpha(x)$ for $\gamma \in \Gal(L/K)$ and $x \in \OL/\pi_K^N \OL$,
  \item $\phi$ is $\Gal(L/K)$-equivariant relative to $\beta$.
 \end{enumerate}
If $T$ and $T'$ are $N$-congruent then $\alpha$, $\beta$ and $\phi$ determine an isomorphism
\begin{equation}\label{transfer}
  \Hom_{<N}(T(K), \EEx) \iso \Hom_{<N}(T'(K'),\EEx).
\end{equation}
Note that if $T$ and $T'$ are $N$-congruent, then they are $N'$ congruent for every
$N' \leq N$, the isomorphism \eqref{transfer} is depth-preserving at integers less than $N$.
In this section we ask if the isomorphism \eqref{transfer} comes from an equivalence of
categories of quasicharacter sheaves on $\GN{T}_d$ and those on $\GN{T}'_d$.

One of the main results of \cite{chai-yu:01a} gives an isomorphism of group schemes between
$\TT_d$ and $\TT'_d$ assuming that $T$ and $T'$ are sufficiently congruent.
They define a quantity $h$ as the smallest integer so that $\pi^h$ lies in the
Jacobian ideal associated to a natural embedding of $T$ into an induced torus \cite{chai-yu:01a}*{\S 8.1}.
Then it follows from \cite{chai-yu:01a}*{Thm. 8.5} that if $N > 3h$ and $T$ and $T'$ are $N$-congruent 
then there is a canonical isomorphism of smooth group schemes
 \[
  \TT_{N-3h} \to \TT'_{N-3h}
 \]
 determined by $\alpha, \beta$ and $\phi$.
Combining this with Theorem~\ref{thm:application} gives the geometrization and categorification of the transfer of characters.

\begin{corollary}\label{cor:transfer}
 With notation above, suppose that $T$ and $T'$ are $N$-congruent and $N > 3h$.  Set $d = N-3h$.
 Then there is a canonical equivalence of categories
 \[
  \QC(\GN{T}'_{d}) \to \QC(\GN{T}_{d})
 \]
 determined by $\alpha, \beta$ and $\phi$ inducing the isomorphism
 \[
  \Hom_{<d}(T'(K'), \EEx) \to \Hom_{<d}(T(K), \EEx)
 \]
 through the trace of Frobenius.
\end{corollary}

\section{Toward geometric reciprocity}

As indicated in the Introduction, we are tantalized 
by the idea that quasicharacter sheaves for $T$ 
may play a key role in a geometric, categorial version 
of the local Langlands correspondence for algebraic tori 
over non-archimedean local fields. 
As with the local Langlands correspondence for algebraic tori over local fields, 
it will be possible to reduce the essential points of the argument to the case $T= \Gm{K}$,
provided that the category of quasicharacter sheaves behaves properly with regard to
Weil restriction; see \cite{yu:09a}*{Thm 7.5 (2)}. 
The next proposition shows that the category of quasicharacter sheaves for 
algebraic tori does indeed behave properly with regard to Weil restriction.

\begin{proposition}
Let $K'/K$ be a finite Galois extension; 
let $k'/k$ be the corresponding finite Galois extension of residue fields.
Let $T$ be an algebraic torus over $K$ and 
set $T' = T \times_\Spec{K} \Spec{K'}$.  
The natural inclusion $T \hookrightarrow \Res_{K'/K} T'$ 
induces a map of $k$-schemes
\[
\GN{T} \hookrightarrow \Res_{k'/k} \GN{T}'
\]
and thus a functor on quasicharacter sheaves through pullback.
\[
\QC(\Res_{k'/k} \GN{T}') \to \QC(\GN{T}).
\]
Through trace of Frobenius, this functor induces the homomorphism
\[
\begin{tikzcd}[column sep=60]
\Hom_{<\infty}(T(K'), \EEx) \arrow{r}{\chi \mapsto \chi\vert_{T(K)}} &\Hom_{<\infty}(T(K), \EEx).
\end{tikzcd}
\] 
\end{proposition}

\begin{proof}
\Clifton{The proof will require the results in the base change section.}
There is a canonical isomorphism
\[
\Res_{k'/k} \Gr(\TL) \cong \Gr(\underline{\Res_{L/K}(T_L)}).
\]
\end{proof}


This paper has shown how quasicharacter sheaves 
on the Greenberg transform of the N\/eron model of $T$ 
determine admissible characters of $T(K)$, and vice versa, functorially.
When coupled with the reciprocity map $\text{rec}_T $ for $T$, 
which enjoys the same functorial properties, 
it follows that quasicharacter sheaves for $T$ 
determine Langlands parameters for $T$, and vice versa, functorially.
\[
\begin{tikzcd}
\ & \arrow[swap]{dl}{\trFrob{G}} \QCiso{\GN{T}} \arrow[dashed]{dr}  & \\
\Hom_{<\infty}(T(K),\EEx) \arrow{rr}{\text{rec}_T} && H^1(K,\hat{T}_\ell) \\
\end{tikzcd}
\]
We suspect that it is possible to extract Langlands parameters 
from quasicharacter sheaves directly and that the reciprocity map 
can then be be viewed as pairing characters and parameters coming
 from the same quasicharacter sheaf. 
 Results in this paper provide tools for reduction the problem to the case $T=\Gm{K}$. 
 In that case, our suspicions are all but confirmed 
 by the class field theory of Serre-Hazewinkel
 \citelist{\cite{serre:60a},\cite{serre:61a},\cite{demazure-gabriel:GroupesAlgebriques}*{Appendice}},
 especially as revisited in \cite{suzuki-yoshida:12a}*{\S~2}. 
 What remains to be done is a careful comparison of 
 quasicharacter sheaves for $\Gm{K}$ and certain local systems on
  the fpqc-site of the pro-quasi-algebraic varieties appearing in \cite{suzuki-yoshida:12a}. 

%\printindex

\DeclareRobustCommand{\VAN}[3]{#3}
\bibliography{Biblio}

\end{document}