% !TEX encoding = UTF-8 Unicode
\documentclass[11pt]{amsart}
\title[Geometrization of characters of tori]{Geometrization of characters of tori over non-Archimedean local fields}
\usepackage[british]{babel}
\usepackage{datetime}
\date{\today}
\author{Clifton Cunningham}
\address{University of Calgary}
\email{cunning@math.ucalgary.ca}
\author{David Roe}
\address{Pacific Institute for the Mathematical Sciences at the University of Calgary}
\email{roed.math@gmail.com}
\usepackage[utf8]{inputenc}
\renewcommand{\baselinestretch}{1.2}
\usepackage[notcite,color]{showkeys}
\usepackage{hyperref}
\usepackage{geometry}
\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{amssymb}
%\usepackage[shortalphabetic]{amsrefs}
\usepackage[alphabetic]{amsrefs}
\renewcommand\MR{\relax}
\usepackage{xypic}
\usepackage{textcomp}
\usepackage{mathrsfs}
\usepackage{yfonts}
\newcommand{\mathswab}[1]{\operatorname{\textswab{#1}}}
\usepackage[T1]{fontenc}
\usepackage{tikz}
\usetikzlibrary{shapes,arrows,calc,matrix}
\usepackage{tikz-cd}
\usepackage{manfnt}
%\usepackage{makeidx}

%\include{definitions}
\theoremstyle{plain}
      \newtheorem{theorem}{Theorem}[section]
      \newtheorem{proposition}[theorem]{Proposition}
      \newtheorem{lemma}[theorem]{Lemma}
      \newtheorem{corollary}[theorem]{Corollary}
      
      \theoremstyle{definition}
      \newtheorem{definition}[theorem]{Definition}
      
      \theoremstyle{remark}
      \newtheorem{remark}[theorem]{Remark}

%% Global TikZ settings

\tikzset{every picture/.style={>=stealth},label/.style={font=\footnotesize}}

\newcommand{\gal}[1]{{\operatorname{Gal}\hskip-1pt\left( {\bar #1}/#1 \right)}}
\newcommand{\Spec}[1]{{\operatorname{Spec}\hskip-1pt( #1 )}}

\newcommand{\FF}{{\mathbb{F}}}
\newcommand{\ZZ}{{\mathbb{Z}}}
\newcommand{\NN}{{\mathbb{N}}}
\newcommand{\CC}{{\mathbb{C}}}
\newcommand{\QQ}{{\mathbb{Q}}}
\newcommand{\RR}{{\mathbb{R}}}
\newcommand{\EE}{\mathbb{\bar Q}_\ell}
\newcommand{\OK}{\mathcal{O}_K}
\newcommand{\pK}{\mathfrak{p}_K}
\newcommand{\OL}{\mathcal{O}_L}
\newcommand{\OO}[1]{\mathcal{O}_{#1}}
\newcommand{\Zp}{\mathbb{Z}_p}
\newcommand{\Qp}{\mathbb{Q}_p}
%\newcommand{\Fp}{\mathbb{F}_p}
\newcommand{\bFq}{\bar{k}}
\newcommand{\Fq}{k}
\newcommand{\Fqm}{k_m}
%\newcommand{\bFp}{{\mathbb{\bar F}_p}}

\newcommand{\EEx}{\EE^\times}

\DeclareMathOperator{\Gal}{Gal}
\DeclareMathOperator{\W}{W}
\newcommand{\Frob}[1]{{\operatorname{F}_{#1}}}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\ord}{ord}
\DeclareMathOperator{\coker}{coker}
\DeclareMathOperator{\Gr}{Gr}
\DeclareMathOperator{\Irrep}{Irrep}
\DeclareMathOperator{\Pic}{Pic}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\Ext}{Ext}
\DeclareMathOperator{\Hh}{H}
\DeclareMathOperator{\Res}{Res}
\DeclareMathOperator{\Nm}{Nm}
\DeclareMathOperator{\trace}{Tr}

\newcommand{\cdef}[1]{{{\color{blue}#1}\index{#1}}} 
\newcommand{\sheafHom}{{\mathscr{H}\hskip-4pt{\it o}\hskip-2pt{\it m}}}
\newcommand{\abs}[1]{{\vert #1 \vert}}
\newcommand{\ceq}{{\, :=\, }}
\newcommand{\tq}{{\ \vert\ }}
\newcommand{\iso}{{\ \cong\ }}
\newcommand{\obj}{{\text{obj}\, }}
\newcommand{\Gm}[1]{\mathbb{G}_{\hskip-1pt\textbf{m},#1}}
\newcommand{\GN}[1]{\mathswab{#1}}
\newcommand{\bGN}[1]{{\bar{\mathswab{#1}}}}
\newcommand{\TT}{\underline{T}}
\newcommand{\TL}{\underline{T_L}}
\newcommand{\invlim}[1]{\lim\limits_{\overleftarrow{#1}}}
\newcommand{\dirlim}[1]{\lim\limits_{\overrightarrow{#1}}}
\newcommand{\limit}[1]{\mathop{\textsc{lim}}\limits_{#1}}
\newcommand{\colimit}[1]{\mathop{\textsc{colim}}\limits_{#1}}
\newcommand{\cs}[1]{{\mathcal{#1}}}
\newcommand{\gcs}[1]{{\mathcal{\bar #1}}}
\newcommand{\dualgcs}[1]{\gcs{#1}^\dagger}
\newcommand{\dualcs}[1]{\cs{#1}^\dagger}
\newcommand{\GC}{{\mathcal{G\hskip-0.8pt C}}}
\newcommand{\GCb}{{\GC_0}}
\newcommand{\GCf}{{\GC_f}}
\newcommand{\GCiso}[1]{\GC(#1)_{/\textit{iso}}}
\newcommand{\GCbiso}[1]{\GCb(#1)_{/\text{iso}}}
\newcommand{\GCfiso}[1]{\GCf(#1)_{/\text{iso}}}
\newcommand{\Lgroup}[1]{{\,^L\hskip-1pt{#1}}}
\newcommand{\dualgroup}[1]{{\check{#1}}}
\newcommand{\Lang}{{\operatorname{Lang}}}
\newcommand{\image}{{\operatorname{im}}}
\newcommand{\Weil}[1]{\mathcal{W}_{#1}}
\newcommand{\Loc}{{\operatorname{Loc}}}
\newcommand{\trFrob}[1]{t_{#1}}

\makeatletter
\newcommand{\labitem}[2]{%
\def\@itemlabel{\textbf{#1}}
\item
\def\@currentlabel{#1}\label{#2}}
\makeatother

\renewcommand{\bf}{\bar{f}}
\newcommand{\bg}{\bar{g}}
\newcommand{\bm}{\bar{m}}
\newcommand{\bG}{\bar{G}}
\newcommand{\bH}{\bar{H}}
\newcommand{\tight}[3]{\hspace{-#1pt}{#2}\hspace{-#3pt}}
\newcommand{\GxG}{\text{$G \tight{1}{\times}{1} G$}}
\newcommand{\bGxG}{\text{$\bar{G} \tight{1}{\times}{1} \bar{G}$}}
\newcommand{\bfxf}{\text{$\bar{f} \tight{1}{\times}{1} \bar{f}$}}
\newcommand{\GxxG}{\text{$G \tight{1}{\times}{1} G$}}
\newcommand{\LxL}{\text{$\gcs{L} \tight{0}{\boxtimes}{0} \gcs{L}$}}
\newcommand{\ExE}{\text{$\cs{E}\tight{0}{\boxtimes}{0}\cs{E}$}}
\newcommand{\bExE}{\text{$\gcs{E}\tight{0}{\boxtimes}{0}\gcs{E}$}}
\newcommand{\AxA}{\text{$A \tight{1}{\times}{1} A$}}
\newcommand{\BxB}{\text{$B \tight{1}{\times}{1} B$}}
\newcommand{\GzxGz}{\text{$G^0 \tight{1}{\times}{1} G^0$}}

\newcommand\todo[1]{\ \vspace{5mm}\par \noindent\framebox{\begin{minipage}[c]{0.95 \textwidth} \tt #1\end{minipage}} \vspace{5mm} \par}
\newcommand\Clifton[1]{\marginpar{\smaller\smaller CC: #1}}
\newcommand\David[1]{\marginpar{\smaller\smaller DR: #1}}

\begin{document}


\begin{abstract}
  We introduce and study the category of geometrized characters of smooth commutative
  group schemes $G$ locally of finite type over finite fields
  $\Fq$. Assuming that the geometric component group of $G$
  is finitely-generated, we show that the group of isomorphism classes
  of geometrized characters of $G$ is canonically isomorphic to the group
  of characters of $G(\Fq)$. We use this result to exhibit an
  isomorphism between admissible characters of $T(K)$ and isomorphism
  classes of geometrized characters of the Greenberg transform of the Néron
  model of $T$, where $K$ is any non-Archimdean local field and $T$ is
  any algebraic torus over $K$.
\end{abstract}

\maketitle

\section*{Introduction}

%\input{introduction}
%In his celebrated thesis, John Tate writes 
%\begin{quotation}
%    {\it Concerning the characters of $k^*$ [the
%    multiplicative group of a $\mathfrak{p}$-adic field], the
%    situation is different from that of $k^+$.  First of all, we are
%    interested in continuous multiplicative maps $\alpha \mapsto
%    c(\alpha)$ of $k^*$ into the complex numbers, not only in the
%    bounded ones, and shall call such a map a quasi-character,
%    reserving the word ``character'' for the conventional character of
%    absolute value $1$. Secondly, we shall find no model for the group
%    of quasi-characters, or even for the group of characters, though
%    such a model would be of the utmost importance.}
%  \cite{Tate:thesis}*{\S 2.3}
%\end{quotation}
%\noindent
What is a geometrized character?
Let $G$ be a smooth commutative group scheme locally of finite
type over $\Fq$; $G$ need not be reductive, connected, nor of
finite type over $\Fq$. Fix a prime $\ell$ that does not divide
$q$. A geometrized character of $G$ is a triple $\cs{L}\ceq
(\gcs{L},\mu,\phi)$ where $\gcs{L}$ is a constructible $\ell$-adic sheaf
$\gcs{L}$ on the \'etale site of $\bG \ceq G \times_{\Spec\Fq}
\Spec{\bFq}$, locally constant of rank-$1$ on every connected
component of $\bG$, equipped with an isomorphism $\mu: m^*
\gcs{L} \to \LxL$, where $m : \GxG \to G$ is
the group operation for $G$, and an isomorphism $F : \Frob{G}^*
\gcs{L} \to \gcs{L}$, where $\Frob{G}$ is the Frobenius automorphism
on $\bG$, satisfying natural compatibility conditions with $\mu$;
these compatibility conditions are explained below.

Geometrized characters of $G$ form a category, denoted by $\GC(G)$. In
fact, $\GC(G)$ is a rigid symmetric monoidal category, so isomorphism
classes of geometrized characters of $G$ form a group, denoted by
$\GCiso{G}$; this is the Picard group of the category of
geometrized characters of $G$. Our application of geometrized characters to
characters of algebraic tori over non-Archimedean local fields rests
on finding the Picard group of geometrized characters of $G$, 
for all smooth commutative group schemes $G$, locally of finite type over $\Fq$, 
for which the geometric component group is finitely generated.

We now say a few words about the group schemes 
that appear in our geometrization of admissible
characters of algebraic tori over local fields. Let $K$ be a
non-Archimedean local field with residual field $\Fq$; we place no
restrictions on the characteristic of $K$ -- in particular, it may be
$0$ or not. Write $\OK$ for ring of integers of $K$ and $\pK$ for the
maximal ideal in $\OK$.  Let $T$ be an algebraic torus defined over
$K$. Let $\TT$ be a N\'eron model for $T$; recall that this is a
smooth group scheme locally of finite type over $\OK$. For each
positive integer $d$, let $\GN{T}_d$ be the Greenberg transform of
$\TT \otimes \OK/\pK^d$; the commutative group scheme $\GN{T}_d$
plays the r\^{o}le of $G$, above.
 
The main result of this paper is a canonical isomorphism
\[
\GCiso{\GN{T}_d} 
\iso
\Hom_{< d}(T(K),\EEx)
\] 
between the Picard group of the category of geometrized characters on
$\GN{T}_d$ and the group of characters $T(K) \to \EEx$ of
depth at most $d$.  Since these isomorphisms are compatible with
respect to $d$, we also .....  \David{I'll do this when we're closer to being finished.}  
%In particular, by
%specializing to the case $T= \Gm{K}$ and by
%choosing an isomorphism $\EE \approx \CC$ (unnatural though it may
%be), we arrive at a model for the group of quasi-characters of
%$K^\times$: the monoidal category of geometrized characters of the
%Greenberg transform of the Neron model of
%$\Gm{K}$.

In this paper we show that the monoidal category of geometrized characters
on the Greenberg transform of the locally finite type Neron model of
$T$ provides an elegant, canonical model for the group of
(quasi-)characters of $T(K)$, where $K$ is any non-Archimedean local
field and $T$ is any algebraic torus over $K$.



\tableofcontents

\section{Notation}

Throughout this paper, $G$ is a commutative group scheme,
smooth and locally of finite type over a finite field $\Fq$, and $m : \GxG\to G$ is its multiplication morphism.

We fix an algebraic closure $\bFq$ of $\Fq$ and write $\bG$ for the
commutative group scheme $G \times_{\Spec{\Fq}} \Spec{\bFq}$ over $\bFq$ obtained by base change from $k$. The multiplication morphism for $\bG$ will be denoted by $\bm$. 

Let $\Frob{G}$ be the Frobenius automorphism of $\bG$.
Recall that $\Frob{G} = \id_{G}\times \Frob{\Spec{\bFq}}$ where
$\Frob{\Spec{\bFq}} = \Spec{\Frob{\Fq}}$ and $\Frob{\Fq}$  is the geometric Frobenius element in $\Gal(\bFq/\Fq)$.

For any group $A$, we will denote by $A^*$ the dual group $\Hom_\text{grp}(A, \EEx)$.

\section{The category of geometrized characters}\label{sec:category}

The category of geometrized characters of $G$, denoted by \cdef{$\GC(G)$},
is defined as follows.  A \cdef{geometrized character on $G$} is a triple
$\cs{L}\ceq (\gcs{L},\mu,\phi)$ where:
\begin{enumerate}
\labitem{(CS.0)}{CS.0} $\gcs{L}$ is a constructible $\ell$-adic sheaf on  (the \'etale site of) $\bG$, locally constant of rank-$1$ on each connected component of $\bG$;
\labitem{(CS.1)}{CS.1} $\mu: \bm^* \gcs{L} \to \LxL$
  is an isomorphism of sheaves on $\bGxG$ such that the following diagram commutes, 
  where $m_3 \ceq m\circ (m\tight{1}{\times}{2}\id) = m\circ (\id\tight{2}{\times}{1} m)$;
%
  \[
  \begin{tikzcd}[row sep=30]
  \bm_3^*\gcs{L} \arrow{rr}{(\bm \tight{1}{\times}{2} \id)^*\mu} \arrow[swap]{d}{(\id \tight{2}{\times}{1} \bm)^*\mu}
    &&  \bm^*\gcs{L} \boxtimes \gcs{L} \dar{\mu \tight{0}{\boxtimes}{1} \id} \\
    \gcs{L} \boxtimes \bm^* \gcs{L} \arrow{rr}{\id \boxtimes \mu}
    &&  \gcs{L} \tight{0}{\boxtimes}{0} \LxL\\
  \end{tikzcd}
  \]
  
%
\labitem{(CS.2)}{CS.2} $\phi : \Frob{G}^* \gcs{L} \to \gcs{L}$ is an
  isomorphism of constructible $\ell$-adic sheaves on $\bG$ compatible with $\mu$ in the sense that the following diagram commutes.
%
  \[
  \begin{tikzcd}[row sep=20]
  \Frob{\GxxG}^* \bm^* \gcs{L} \arrow{rr}{\Frob{\GxxG}^*\mu}
    && \Frob{\GxxG}^*(\LxL)\\
    \arrow[equal]{u} \bm^*  \Frob{G}^* \gcs{L} \arrow[swap]{d}{\bm^* \phi}
    && \Frob{G}^*\gcs{L}\boxtimes \Frob{G}^*\gcs{L} \dar{F\boxtimes \phi} \arrow[equal]{u} \\
    \bm^*\gcs{L} \arrow{rr}{\mu}
    && \LxL\\
  \end{tikzcd}
  \]
\end{enumerate}
Morphisms in $\GC(G)$ are defined in the natural way:
\begin{enumerate}
\labitem{(CS.3)}{CS.3} if $\cs{L} = (\gcs{L},\mu,\phi)$ and
  $\cs{L'} = (\gcs{L'},\mu',\phi')$ are geometrized characters of $G$ then
  $\Hom_{\GC(G)}(\cs{L},\cs{L'})$ is the set of morphisms $\alpha : \gcs{L} \to \gcs{L'}$
  of constructible $\ell$-adic sheaves on $\bG$ such that the following diagrams both commute.
  \[
  \begin{tikzcd}[column sep=40]
  \Frob{G}^* \gcs{L} \rar{\Frob{G}^* \alpha} \arrow[swap]{d}{\phi} & \Frob{G}^* \gcs{L'} \dar{\phi'}
  & %\arrow[draw=none]{d}[pos=.4,description]{\text{\normalsize{and}}} 
  & \arrow[swap]{d}{\mu} m^* \gcs{L} \rar{m^* \alpha} & m^* \gcs{L'} \dar{\mu'} \\
  \gcs{L} \rar{\alpha} & \gcs{L'}
  & {} & \LxL \rar{\tight{1}{\alpha\boxtimes \alpha}{1}} & \gcs{L'} \tight{0}{\boxtimes}{0} \gcs{L'}
  \end{tikzcd}
  \]
\end{enumerate}

%\begin{remark} \label{rem:CS-action}
The rule $(\gcs{L},\mu,\phi) \mapsto (\gcs{L},\phi)$ defines a forgetful functor from geometrized characters of $G$ to ($\ell$-adic) Weil sheaves on $G$ \cite{Deligne:Weil2}*{Def.~1.1.10 (i)}.

As mentioned after \cite{Deligne:Weil2}*{Def.~1.1.10}, a Weil sheaf $(\gcs{L},\phi)$ on $G$ may be interpreted as a constructible $\ell$-adic sheaf $\gcs{L}$ on $\bG$ together with an action of the Weil group $\Weil{\Fq}$ on $\gcs{L}$ compatible with the action of $\Gal(\bFq/\Fq)$ on $\bG$. Since we will need this point of view later, we review that interpretation here. Setting 
\[
\varphi(\Frob{\Fq}^n) \ceq  \phi \circ \Frob{G}^*(\phi) \circ \cdots \circ (\Frob{G}^{n-1})^*(\phi)
\]
defines, for every $w\in \Weil{\Fq}$, an isomorphism
$\varphi(w) : w_G^* \gcs{L}\to \gcs{L}$, such that
$\varphi(uv) = \varphi(v) \circ v_G^* \varphi(u)$ for all $u,v\in \Weil{\Fq}$.
Note that $\phi = \varphi(\Frob{\Fq})$. 
If we further define $\varphi_1(w) \ceq (w_G)_*(\varphi(w)^{-1})$ then
$\varphi_1(w) : (w_G)_* \gcs{L}\to \gcs{L}$ is an isomorphism and
$\varphi_1(uv) = \varphi_1(u) \circ (u_G)_* \varphi_1(v)$ for all $u,v\in \Weil{\Fq}$.
This means the pair $(\gcs{L},\varphi_1)$ is almost an action $\Weil{\Fq}$ on $\gcs{L}$ compatible with the action of $\Gal(\bFq/\Fq)$ in the sense of \cite{SGA4.5}*{Expos\'e XIII,~1.1}. The pair $(\gcs{L},\varphi_1)$ fails to fulfill the requirements of \cite{SGA4.5}*{Expos\'e XIII,~1.1} only because $\Weil{\Fq}$ is profinite. This fact goes to the heart of the notion of a Weil sheaf and is one of the essential aspects of our definition of $\GC(G)$. 
%\end{remark}

\section{The Picard group of geometrized characters}

%\begin{proposition}\label{tensor}
The category $\GC(G)$ of geometrized characters of $G$ is a rigid monoidal
category [insert reference] under
$\cs{L} \otimes \cs{L'} \ceq (\gcs{L}\otimes\gcs{L'}, \mu\otimes\mu', \phi\otimes \phi')$
with duals given by applying the functor 
\Clifton{Should this be $\sheafHom(\ - \ ,\EE)$?} $\sheafHom(\ - \ ,(\EE)_{\bG})$ (sheaf hom) to
conditions \ref{CS.0}, \ref{CS.1} and \ref{CS.2}.
%\end{proposition}
(The category of characters sheaves on $G$ is not abelian, so $\GC(G)$
is not a tensor category in the sense of \cite{Deligne:tensorielles}.)
%\begin{proof}\end{proof}
%
This rigid monoidal category structure for $\GC(G)$ puts a group
structure on the set $\GCiso{G}$ of isomorphism classes in
$\GC(G)$; we refer to this as the \cdef{Picard group of character
sheaves} on $G$.\footnote{See {\tt http://ncatlab.org/nlab/show/Picard+group}.}
The main result in this paper is the determination of the Picard group of geometrized characters of $G$, when the geometric component group of $G$ is finitely generated.


\section{Trace of Frobenius}\label{sec:Frob}

Let $\cs{L}$ be a geometrized character of $G$. Every $g\in G(\Fq)$
determines a point $\bg$ on $\bG$ fixed by $\Frob{G}$ and
therefore an automorphism $\phi_{\bg}$ of $\gcs{L}_{\bg}$. Note
that $\Aut_{\EE}(\gcs{L}_{\bg}) \iso \EEx$, canonically. The isomorphism $\mu : \bm^* \gcs{L} \to \LxL$
guarantees that the function $\trFrob{\cs{L}} : G(\Fq)\to \EEx$,
defined by $g \mapsto \phi_{\bg}$, is a group homomorphism;
we refer to $\trFrob{\cs{L}}$ as the \cdef{trace of Frobenius of $\cs{L}$}.
Although though no trace is involved in the definition, the notion extends 
to any constructible $\ell$-adic Weil sheaf $(\gcs{L},\phi)$ on $G$, in which context,
$\trFrob{(\gcs{L},\phi)} : G(\Fq)\to \EE$ is defined by $\trFrob{(\gcs{L},\phi)}(g) \ceq \trace \phi_{\bg}$.

It is clear that $\trFrob{\cs{L}\otimes \cs{L'}} = \trFrob{\cs{L}} \cdot \trFrob{\cs{L'}}$
(pointwise multiplication of functions) and that $\trFrob{\cs{L}} = \trFrob{\cs{L'}}$
if $\cs{L} \iso \cs{L'}$ in $\GC(G)$. In this way we obtain a group homomorphism
\[
\cdef{\trFrob{G}} : \GCiso{G} \longrightarrow G(\Fq)^*,%\Hom_\text{grp}(G(\Fq),\EEx),
\qquad \text{defined by}\qquad \cs{L} \mapsto \trFrob{\cs{L}},
\]
from the Picard group of geometrized characters of $G$ to the character group of $G(\Fq)$.

Our main result on the geometrization of admissible characters of
$p$-adic tori [insert internal reference here] follows from a general
fact established later in this paper: if the geometric component group
of $G$ is finitely-generated then the trace of Frobenius defines an
isomorphism from the Picard group of geometrized characters $G$ to the
group of characters of $G(\Fq)$ (here, as throughout the paper, $G$ is
a commutative group scheme, smooth and locally of finite type over $\Fq$).

\section{Pull-back of geometrized characters}\label{subsection:pullback}

\begin{proposition}\label{prop:pullback}
  If $f : H\to G$ is a morphism of commutative group schemes locally of finite type over $\Fq$ then
  $(\gcs{L},\mu,\phi) \mapsto (\bf^*\gcs{L},(\bfxf)^*\mu,\bf^*F)$
  defines a monoidal functor $f^* : \GC(G) \to \GC(H)$ such that
  \[
  \begin{tikzcd}[row sep=20, column sep=30]
   \GCiso{G} \rar{f^*} \arrow[swap]{d}{\trFrob{G}} & \GCiso{H} \dar{t_H} \\
   G(\Fq)^* \rar & H(\Fq)^*
  %\Hom_\text{grp}(G(\Fq),\EEx) \rar & \Hom_\text{grp}(H(\Fq),\EEx)
  \end{tikzcd}
  \]
  is a commutative diagram of groups, where the lower homomorphism is
  dual to $f : H(\Fq)\to G(\Fq)$.  Moreover, $(f\circ g)^* = g^* \circ f^*$.
\end{proposition}

\begin{proof}
  Let $\cs{L}$ be a geometrized character of $G$. We start by showing that
  $\bf^*\gcs{L}$ is locally constant on connected components of
  $\bH$. Let $c_j :\bH^j \hookrightarrow \bH$ be any
  connected component and let $i$ be the image of $j$ under the group
  homomorphism $\pi_0(\bG) \to \pi_0(\bH)$ obtained by
  applying the functor $\pi_0$ to $\bf$; see \cite{vdG&M}*{III, 3.28}, for example.
  \Clifton{I haven't found a better reference for this yet!}
  Write $c_i : \bG^i \hookrightarrow \bG$ for
  the inclusion of $\bG^i$ and $\bf^j : \bH^j \to \bG^i$
  for the restriction of $f$ to $\bH^j$.  Since $\cs{L}$
  is a geometrized character, $\gcs{L}$ is locally constant on the connect
  components of $\bG$; thus, there is a finite etale covering
  $a_i : X_i \to \bG^i$ such that $a_i^* (\gcs{L}\vert_{\bG^i})$
  is constant. Let $b_j : Y_j \to \bH^j$ be the
  pull-back of $a_i$ along $\bf^j$; let $g_j : Y_j \to X_i$ be
  the map opposite $\bf^j$. Then $b_j$ is a finite etale covering
  of $\bH^j$ and
  \[
  b_j^* \left( (\bf^* \gcs{L})\vert_{\bH^j}\right)
  = (\bf\circ c_j \circ b_j)^*\gcs{L}
  = (c_i\circ a_i\circ g_j)^*\gcs{L} = g_j^* a_i^* (\gcs{L}\vert_{\bG^i}).
  \]

  Since $a_i^* (\gcs{L}\vert_{\bG^i})$ is a constant sheaf and since the pull-back
  of a constant sheaf (along $g_j$, in this case) is a constant sheaf,
  it follows that $b_j^* \left( (\bf^*\gcs{L})\vert_{\bH^j}\right)$
  is a constant sheaf. Thus, $\bf^*\gcs{L}$ is locally constant on
  $\bH^j$. Since $(\bf^*\gcs{L})_{\bg} = \gcs{L}_{f(\bg)}$ for every
  geometric point ${\bg}$ on $\bG$, and since $\gcs{L}$ has
  rank $1$ on connected components of $\bG$, it follows that
  $f^*\gcs{L}$ also has rank $1$ on connected components of $\bG$.
  This completes the proof that $\bf^*\gcs{L}$ satisfies condition \ref{CS.0}.

  To see that $(\bfxf)^* \gcs{L}$ satisfies
  condition \ref{CS.1} simply apply the functor $(\bfxf)^*$
  to \ref{CS.1} for $\cs{L}$ and use the canonical isomorphism
  $(\bfxf)^*(\LxL) \iso \bf^*\gcs{L} \tight{-3}{\boxtimes}{-3} \bf^*\gcs{L}$
  (a few times). Likewise, to see that $\bf^*\gcs{L}$ satisfies condition
  \ref{CS.2}, apply the same functor to \ref{CS.2} for $\gcs{L}$.
  Then use the fact that $f$ is defined over $\Fq$, so
  $(\bfxf)^*\Frob{\GxxG}^* \iso \Frob{\GxxG}^* (\bfxf)^*$,
  and the fact that $f$ is a morphism of group schemes, so
  $(\bfxf)^* \bm^*\iso \bm^* \bf^*$
  (isomorphisms of functors on constructible sheaves).

  To see that $(\gcs{L},\mu,\phi) \mapsto (\bf^*\gcs{L},(\bfxf)^*\mu,\bf^*F)$
  defines a functor $f^* : \GC(G) \to \GC(H)$ one applies the functors $\bf^*$ and
  $\bf^*\tight{1}{\times}{1}\bf^*$ to \ref{CS.3} and argue as
  above. It follows from the fact that sheaf hom commutes with these
  functors that $f^* : \GC(G) \to \GC(H)$ is a monoidal functor.
%
  The fact that the functor $f^* : \GC(G) \to \GC(H)$ commutes with
  the trace of Frobenius, in the sense above, follows immediately from
  the definitions; see \cite{Laumon}*{1.1.1.2}, where the ambient
  hypothesis that $X$ is of finite type over $\Fq$ can be replaced by
  the hypothesis that $X$ is locally of finite type over $\Fq$.
  
  Finally, the fact that $(f\circ g)^* = g^* \circ f^*$ follows from the analogous
  statements about the pullbacks functor on $\ell$-adic constructible sheaves.
 % \David{Is this explanation of $(f\circ g)^* = g^* \circ f^*$ sufficient?}
\end{proof}

Consider the short exact sequence in the category of smooth group
schemes, locally of finite type over $\Fq$, defining the component
group scheme for $G$:
\begin{equation}\label{eq:pi-2}
\begin{tikzcd}
0 \rar & G^0 \rar & G \rar & \pi_0(G) \rar & 0.
\end{tikzcd}
\end{equation}
Since $\pi_0(G)$ is an Abelian group scheme, smooth (in fact, etale) and locally of finite type over $\Fq$, 
it follows from Proposition~\ref{prop:pullback} that \eqref{eq:pi-1} defines a sequence of functors
\[
\begin{tikzcd}
\GC(0) \rar & \GC(\pi_0(G)) \rar & \GC(G) \rar & \GC(G^0) \rar & \GC(0)
\end{tikzcd}
\]
which induces, upon passage to Picard groups, a sequence of group homomorphisms 
\begin{equation}\label{eq:pi-1}
\begin{tikzcd}
\GCiso{0} \rar & \GCiso{\pi_0(G)} \rar & \GCiso{G} \rar & \GCiso{G^0} \rar & \GCiso{0}.
\end{tikzcd}
\end{equation}
It is easy to see that $\GCiso{0}$ is trivial. In this paper we will find $\GCiso{G^0}$ and $\GCiso{\pi_0(G)}$ under the hypothesis that $\pi_0(G)$ is geometrically finitely generated; 
the snake lemma will then allow us to show
\[
\GCiso{G} \iso G(\Fq)^*,%\Hom_\text{grp}(G(\Fq),\EE^\times),
\]
canonically.

\section{Boxproduct} 

Let $ \GC(G_1) \boxtimes \GC(G_2)$

\begin{proposition}\label{prop:product}
The rule ... defines an equivalence of categories 
\[
\GC(G_1\times G_2) \to \GC(G_1) \boxtimes \GC(G_2)
\]
and 
\[
\begin{tikzcd}
\GCiso{G_1\times G_2} \arrow{r} & \GCiso{G_1} \times \GCiso{G_2}\\
(G_1\times G_2)(k)^* \arrow{r}  & G_1(k)^* \times G_2(K)^*
\end{tikzcd}
\]
commutes.
\end{proposition}

\section{Base change over the residue field}\label{sec:basechange}

When using geometrized characters to study characters, it is useful to understand
how geometrized characters behave under change of fields.
Let $k'$ be a finite extension of $k$. Then $k\to k'$ induces a group homomorphism $i_{k'/k} : G(k) \hookrightarrow G(k')$ which, in turn, gives
\[
i_{k'/k}^* : G(k')^* \to G(k)^* \qquad \text{defined by}\qquad \chi \mapsto \chi\circ i_{k'/k}.
\]
We can interpret this operation on characters in terms of geometrized characters, as follows.
%

\begin{proposition} \label{prop:csbe}
Set $G_{k'} = G\times_\Spec{k} \Spec{k'}$ and let
\[
\GC(\Res_{k'/k}(G_{k'})) \xrightarrow{\iota^*} \GC(G)
\]
be the functor obtained by pull-back along the canonical closed immersion of $k$-schemes  $\iota : G \hookrightarrow \Res_{k'/k}(G_{k'})$ \cite[\S 7.6]{BLR}. 
The following diagram commutes:
\[
\begin{tikzcd}
\GCiso{\Res_{k'/k}(G_{k'})} \arrow[two heads]{r}{\iota} \dar[swap]{t_{\Res_{k'/k}(G_{k'})}} & \GCiso{G} \dar{t_G} \\
G(k')^* \arrow[two heads]{r}{i_{k'/k}^*} & G(k)^*.
\end{tikzcd}
\]
\end{proposition}

In the opposite direction, let $\Nm_{k'/k} : G(k') \to G(k)$ be the norm map and consider the group homomorhism:
\Clifton{How is $\Nm$ defined?}
\[
\Nm_{k'/k}^* : G(k)^* \to G(k')^* \qquad \text{defined by}\qquad \chi \mapsto \chi\circ \Nm_{k'/k}.
\]
We can also interpret this operation on characters in terms of geometrized characters, as follows.

If $\cs{L} = (\gcs{L}, \mu, \phi)$ is a geometrized character of $G$ we may define
a geometrized character $\cs{L}' = (\gcs{L}, \mu, \phi_{k'})$ on 
$G_{k'}\ceq G\times_{\Spec{k}} \Spec{k'}$ by setting
\[
\phi_{k'} = \phi \circ \Frob{G}^*(\phi) \circ \cdots \circ (\Frob{G}^{n-1})^*(\phi).
\]
The commutativity of the diagram (CS.2) for $\phi_{k'}$ 
follows from the fact that $\Frob{G_{k'}} = \Frob{G}^n$.
Note that we may also think about the construction of $\phi_{k'}$ from $\phi$
as taking the action $\varphi$ of $\Weil{k}$ on $\gcs{L}$ 
defined in Section~\ref{sec:category} and restricting it to the subgroup $\Weil{k'}$.

\begin{proposition}\label{prop:basechange}
 The rule $\nu_{k'/k}: (\gcs{L}, \mu, \varphi) \mapsto (\gcs{L}, \mu, \varphi\vert_{\Weil{\Fq}})$ 
 defines a monoidal functor $\GC(G) \to \GC(G_{k'})$. 
 Moreover, the following diagram commutes, 
 where the top map is induced by $\GC(G) \to \GC(G_{k'})$ 
 and the bottom map is induced by the norm $G(k') \rightarrow G(k)$:
\[
\begin{tikzcd}[column sep=60]
\GCiso{G} \rar{\nu_{k'/k}} \dar{\trFrob{G}} & \GCiso{G_{k'}} \dar{\trFrob{G_{k'}}} \\
G(k)^*  \rar{\Nm_{k'/k}^*} & G(k')^*.
\end{tikzcd}
\]
\end{proposition}


Finally, we explain how to geometrize the canonical isomorphism between characters of $G'(k')$ and of $(\Res_{k'/k}G')(k)$.
The base change $(\Res_{k'/k}G')_{k'}$ of $\Res_{k'/k}G'$ to $k'$
decomposes into a product of copies of $G'$, indexed by elements of $\Gal(k'/k)$:
\[
(\Res_{k'/k}G')_{k'} \cong \prod_{\Gal(k'/k)} G'.
\]
The component corresponding to the identity element yields a natural inclusion 
\[
G' \hookrightarrow (\Res_{k'/k}G')_{k'}
\]
of $k'$-schemes.  The definition of base change yields a map of $k$-schemes
\[
(\Res_{k'/k}G')_{k'} \to \Res_{k'/k}G'.
\]
Consecutive pullback along these maps yields a functor
\[
\GC(G') \to \GC(\Res_{k'/k}G').
\]

\begin{proposition}
The following diagram commutes:
\[
\begin{tikzcd}
\GCiso{G'} \dar{t_{G'}} \rar & \GCiso{\Res_{k'/k} G'} \dar{t_{\Res_{k'/k} G'}} \\
 G'(k')^* \rar & (\Res_{k'/k}G')(k)^*
\end{tikzcd}
\]
\end{proposition}

\section{Bounded geometrized characters}\label{sec:bounded}

Let \cdef{$\GCb(G)$} be the category of pairs $(\cs{L}_0,\mu_0)$ 
where $\cs{L}_0$ is a constructible $\ell$-adic sheaf on $G$, 
which is a rank-$1$ local system on each connected component of $G$, 
equipped with an isomorphism $\mu_0 : m^* \cs{L}_0 \to \cs{L}_0 \boxtimes \cs{L}_0$ 
satisfying the analogue of Condition~\ref{CS.1} on $G$; 
morphisms in $\GCf(G)$ are defined as in (the second part of) Condition~\ref{CS.2}. 
This is the category of \cdef{bounded geometrized characters} on $G$. 
\Clifton{Should this be $\sheafHom(\cs{L}_0,\EE)$?}
This is a rigid monoidal category in the obvious way, 
with duals given by $\cs{L}_0^\vee \ceq \sheafHom(\cs{L}_0,(\EE)_{G})$.

\begin{proposition}
$\GCb(G)$ is (equivalent to) a full subcategory of $\GC(G)$.
\end{proposition}

\begin{proof}
 Let $b_G : {\bar G} \to G$ be the pull-back of $\Spec{\bFq} \to \Spec{\Fq}$ along $G\to \Spec{\Fq}$.
 Let $(\cs{L}_0,\mu_0)$ be a bounded geometrized character of $G$. 
 Then $\cs{L}_0$ is, in particular, an $\ell$-adic constructible sheaf on $G$. 
 Then $b_G^* \cs{L}_0$ comes equipped with an isomorphism 
 $\phi : \Frob{G}^* b_G^*\cs{L}_0 \to b_G^* \cs{L}_0$; 
 moreover, the functor $\cs{L}_0 \mapsto (b_G^* \cs{L}_0,\phi)$  
 from $\ell$-adic constructible sheaves on $G$ to $\ell$-adic constructible sheaves on $G$
 is full and faithful; see \cite{SGA7.2}*{Expos\'e XIII} or even \cite{BBD}*{Prop. 5.2.1}. 
 This functor preserves local constancy, so takes local systems to local systems. 
 Set $\mu = b_{G\times G}^*\mu_0$; clearly, this satisfies Condition~\ref{CS.2} 
 with $b_G^*\cs{L}_0$ playing the role of $\gcs{L}$.
 Moreover, $\phi$ is compatible with $\mu$ in the sense of Condition~\ref{CS.3}.
 It follows that functor $(\cs{L}_0,\mu_0) \mapsto (b_G^*\cs{L}_0,b_{G\times G}^* \mu_0, \phi)$, denoted by  $B_G^*: \GCb(G) \hookrightarrow \GC(G)$ below, is full and faithful.
\end{proof}

We will see that the full subcategory $\GC_0(G)$ of bounded geometrized characters is a proper subcategory of $\GC(G)$, in general. Indeed, it follows from our main result regarding geometrized characters, Theorem~\ref{thm:snake}, that the restriction of $\trFrob{G} : \GCiso{G} \to G(\Fq)^*$ to the subgroup $\GCbiso{G}$ is an isomorphism onto the subgroup of $\chi \in G(\Fq)^*$ such that the image of $\chi$ is bounded in $\EEx$, so if $G(\Fq)$ is not finite, then $\GC_0(G) \hookrightarrow\GC(G)$ is not essentially surjective.

\section{Finite geometrized characters}\label{sec:finite}

 %In this section we describe a full subcategory of $\GCb(G)$
 %which will illuminate some features of $\GCb(G)$ and also play a role in some arguments below.
 
To define the category of finite geometrized characters we must work a bit harder.
Consider the following category \cdef{$C(G)$}:
an object in $C(G)$ is a pair $(f,\psi)$ where: 
$f : H\to G$ is a \cdef{discrete isogeny} (a finite, surjective etale morphism and a morphism of commutative group $\Fq$-schemes, for which the action of $\Gal(\bFq/\Fq)$ on the etale group scheme $f^{-1}{\bar e}$ is trivial), 
and $\psi : \ker f\to \Aut(V)$ is a representation on a finite-dimensional $\EE$-vector space $V$;
a map $(f,\psi) \to (f',\psi')$ in $C(G)$ is a pair $(\alpha,T)$ 
where $\alpha$ is a morphism of schemes such that $f' = f\circ \alpha$
and $T : V\to V'$ is a linear transformation equivariant 
for the action of $\ker f'$ on $V'$ by $\psi'$ 
and the action of $\ker '$ on $V$ by $\psi \circ \alpha$.
\[
\begin{tikzcd}
V \arrow{d}{T} & \Aut(V) & \arrow[swap]{l}{\psi} \ker f \arrow[hook]{r} & H \arrow{r}{f} & \arrow[equal]{d} G\\
V' & \Aut(V) & \arrow[swap]{l}{\psi} \arrow[swap]{u}{\alpha\vert_{\ker f}} \ker f \arrow[hook]{r} & \arrow[swap]{u}{\alpha} H' \arrow{r}{f'} & G\\
\end{tikzcd}
\]
\Clifton{I suspect $\alpha$ is a covering, for free. Is that right? 
If $f' = f \circ \alpha$ and $f$ and $f'$ are etale covers, 
does it follow that $\alpha$ is also an etale cover? (Etale: Yes. Finite? Surjective?) 
If so, then I can simplify the definition of weak isomorphism accordingly.}
We say that $(\alpha,T)$ in $C(G)$ is a \cdef{weak isomorphism} if $\alpha$ is a covering and $T$ is an isomorphism of vector spaces.
Let \cdef{$C(G)[W^{-1}]$} be the localization of $C(G)$ at weak isomorphisms.

We put a tensor category structure on $C(G)$ 
and a rigid monoidal category structure on $C_1(G)$ as follows.
Let $(f,\psi)$ and $(f',\psi')$ be objects in $C(G)$. 
The category of isogenies to $G$ admits products: 
write $f\times_G f' : H\times_G H' \to G$ for the product of $f : H\to G$ and $f' : H'\to G$. 
Since $\ker(f\times_G f') \iso (\ker f)\times (\ker f')$, canonically,
the tensor product of the representations $\psi : \ker f\to \Aut(V)$ and $\psi' : \ker f'\to \Aut(V')$ 
is the representation $\psi \otimes\psi' :  \ker(f\times_G f') \to \Aut(V\otimes V')$. 
This allows us to set $(f,\psi)\otimes(f',\psi') \ceq (f\times_G f' ,\psi\otimes\psi')$. 
The same fact makes sense of $(f,\psi)\oplus(f',\psi')\ceq (f\times_G f' ,\psi\oplus\psi')$. 
The dual of $(f,\psi)$ is $(f,\psi)^\vee \ceq (f,\psi^\vee)$ 
where $\psi^\vee : \ker f \to \Aut(V^\vee)$ and $V^\vee = \Hom_\text{vec}(V,\EE)$. 
The verification that these operations make $C(G)$ a tensor category is straightforward.
Likewise, $C(G)[W^{-1}]$ is a tensor category.

Let \cdef{$C_1(G)$} be the rigid monoidal full subcategory of $C(G)$ consisting of objects $(f,\psi)$ such that $\psi$ is a one-dimensional representation and let \cdef{$\GCf(G)$} be the localisation of $C_1(G)$ at weak isomorphisms; this is the rigid symmetric monoidal category of \cdef{finite geometrized characters} of $G$.

\begin{proposition}\label{prop:bounded}
 $\GCf(G)$ is (equivalent to) a full subcategory of $\GCb(G)$.
\end{proposition}

\begin{proof}
 To prove the proposition we exhibit a full and faithful monoidal functor $L_G : \GCf(G) \to \GCb(G)$.
 %
 We will do this by constructing a faithful monoidal functor $L : C_1(G) \to \GCb(G)$ 
 such that $L(\alpha,T)$ is an isomorphism precisely when $(h,T)$ is a weak isomorphism. 
 Factoring along $C_1(G) \to \GCb(G)$ will produce the full and faithful monoidal functor we seek.

 Now we introduce a faithful functor $L : C(G) \to \Loc(G)$ to the category of local systems on $G$.
 For any object $(f,\psi)$ in $C(G)$, let $L(f,\psi)$ be the $\psi$-isotypic component of $f_* V_H$, 
 where $V_H$ refers to $V$ as a constant sheaf on $H$. 
 We may identify the stalk $(f_* V_H)_{\bar g}$ of $f_* V_H$ at a geometric point ${\bar g}$ on $G$ 
 with the $\EE$-vector space $\Hom_\text{set}(\abs{f^{-1}({\bar g})},V)$ 
 and the stalk $L(f,\psi)_{\bar g}$ of $L(f,\psi)$ at a geometric point ${\bar g}$ on $G$ 
 with the $\EE$-vector space consisting of those functions $s: \abs{f^{-1}({\bar s})} \to V$ such that 
 $s(a\cdot {\bar h}) = \psi(a)(s({\bar h}))$ for all $a\in \ker f$ and for all ${\bar h} \in f^{-1}({\bar g})$.
 Since $L(f,\psi)$ is trivialized by $f$, it is a local system on $G$.
 For any map $(\alpha,T)$ in $C(G)$, let $L(\alpha,T) : L(f,\psi) \to L(f',\psi')$ be the homomorphism of local systems defined 
 %at geometric points $L(\alpha,T)_{\bar g} : L(f,\psi)_{\bar g} \to L(f',\psi')_{\bar g}$ 
 by $s \mapsto s' \ceq T\circ s\circ \alpha$. 
 This defines a monoidal functor $L$ from $C(G)$ to $\Loc(G)$. 
 This functor commutes with pull-back along any morphism of group schemes.
  
 Now consider the localization $C(G)[W^{-1}]$ of $C(G)$ at weak isomorphisms.
 Morphisms in $C(G)[W^{-1}]$ are simple to describe because category $C(G)$ 
 admits a calculus of left fractions\footnote{See {\tt http://ncatlab.org/nlab/show/calculus+of+fractions}.} for weak isomorphisms: 
 every isomorphism in $C(G)$ is a weak isomorphism; 
 push-outs exist in $C(G)$ and the push-out of a weak isomorphism is a weak isomorphism; 
 and weak isomorphisms enjoy the left-cancellation property. 
 It follows that a morphism in $C(G)[W^{-1}]$ is the equivalence class of 
  \begin{equation}\label{eq:morGCf}
   \begin{tikzcd}
   (f,\psi) \arrow{r}{(\alpha_1,T_1)} & (f_1,\psi_1) & \arrow[swap]{l}{(\alpha'_1,T'_1)} (f',\psi')
   \end{tikzcd}
  \end{equation}
 where $(\alpha',T') : (f,\psi) \to (f',T')$ is any map in $C(G)$ 
 and $(\alpha'_1,T'_1) : (f_1,\psi_1) \to (f',\psi')$ is a weak isomorphism,
 and therefore given by a diagram of the form

 Observe that $L$ takes weak isomorphisms in $C(G)$ to isomorphisms in $\Loc(G)$. 
 To see this, let $(h,T) : (f,\psi)\to (f',\psi')$ be a weak isomorphism, 
 where $f:H\to G$ and $f':H'\to G$ as above. 
 Since $T$ is an isomorphism, we may replace $V'$ with $V$ and $T$ with $\id_V$, without loss of generality. 
 Then the equivariance condition on $T$ becomes $\psi' = \psi\circ h$ on the finite etale group scheme $\ker f'$. 
 Since $\alpha : H'\to H$ is an etale cover, it admits a section $\alpha' : H \to H'$, 
 which provides the inverse to $L(\alpha,T) : L(f,\psi) \to L(f',\psi')$, above. 
 It is also clear that if $L(\alpha,T)$ is an isomorphism of local systems, 
 then $T$ must be an isomorphism of vector spaces, 
 whence $(\alpha,T)$ is a weak isomorphism: $W$ is saturated.
  
 Since $L : C(G) \to \Loc(G)$ takes weak isomorphisms to isomorphisms,
 it factors (uniquely!) through the localisation functor $C(G) \to C(G)[W^{-1}]$ 
 to define a faithful functor $L_{W} : C(G)[W^{-1}] \to \Loc(G)$. 
 Since $W$ is saturated, the functor $L_{W} : C(G)[W^{-1}] \to \Loc(G)$ is full. 
   
 By Lemma~\ref{lemma:finite-iso}, each $(f,\psi) \in \GCf(G)$ determines 
 an isomorphism $\mu(f,\psi) : m^*(f,\psi) \to (f,\psi) \boxtimes (f,\psi)$ in $\GCf(G\times G)$, canonically.
 It follows immediately that the functor 
 \[
 L_G  \ceq  L_{W}\vert_{\GCf(G)} : \GCf(G) \to \GCb(G),
 \] 
 given on objects by $(f,\psi) \mapsto (L(f,\psi), L_{W}(\mu(f,\psi)))$,
 is a full and faithfull monoidal functor, completing the proof.
\end{proof}


\begin{lemma}\label{lemma:finite-pull-back}
If $g : G'\to G$ is a morphism of group schemes then $(f,\psi) \mapsto (f_g,\psi_g)$ defines a monomial functor $g^* : C(G)[W^{-1}] \to C(G')[W'^{-1}]$ where $f_g : H\times_G G'\to G'$ is a pull-back of $f$ along $g$ and $\psi_g : \ker f_g \to \Aut(V)$ is defined by the diagram below.
\[
\begin{tikzcd}
V & \Aut(V) & \arrow[swap]{l}{\psi} \ker f \arrow[hook]{r} & H \arrow{r}{f} &  G\\
  &  & \arrow[dashed]{ul}{\psi_g} \arrow[swap]{u}{(g_f)\vert_{\ker g_f}} \ker f_g \arrow[hook]{r} & \arrow[swap]{u}{g_f} H\times_G G' \arrow{r}{f_g} & \arrow{u}{g} G'.
\end{tikzcd}
\]
\end{lemma}

\begin{proof}
The key point is that pull-back along $g$ takes isogenies to isogenies, and maps over $G$ to maps over $G'$, as pictured below.
\[
\begin{tikzcd}[row sep=10,column sep=10]
\ & V \arrow{dd}{T} && \Aut(V) && \arrow[swap]{ll}{\psi} \ker f \arrow[hook]{rr} && H \arrow{rr}{f} && \arrow[equal]{dd} G\\
 && && \arrow{ul} \ker f\times_G G' \arrow{ur} \arrow[hook]{rr} && H\times_G G' \arrow{ur} \arrow{rr} && G' \arrow{ur}{g} & \\
& V' && \Aut(V) && \arrow[swap]{ll}{\psi'} \arrow[swap]{uu}{} \ker f'  \arrow[hook]{rr} && \arrow[swap]{uu} H' \arrow{rr}{f'} && G\\
 && && \arrow{ul} \ker f'\times_G G' \arrow{uu} \arrow{ur} \arrow[hook]{rr} && \arrow{uu} H'\times_G G' \arrow{ur} \arrow{rr} && \arrow[equals]{uu} G' \arrow{ur}{g} & \\
\end{tikzcd}
\]
In this form we could treat $g^*$ as a functor $G(G')\to C(G)$, where it not for the fact that pull-back is defined only up to isomorphism. In the localized categories, this ambiguity disappears. 
\end{proof}


\begin{lemma}\label{lemma:finite-iso}
Each $(f,\psi)\in \GCf(G)$ determines a canonical isomorphism $m^*(f,\psi) \to (f,\psi)\boxtimes(f,\psi)$ in $\GCf(G\times G)$.
 \end{lemma}

\begin{proof}
As in Lemma~\ref{lemma:finite-pull-back}, we have $m^*(f,\psi) = (f_m,\psi_m)$ where $f_m$ and $\psi_m$ are pictured below, where $H_m = H\times_G(G\times G)$.
\[
\begin{tikzcd}
V & \Aut(V) & \arrow[swap]{l}{\psi} A \arrow[hook]{r} & H \arrow{r}{f} &  G\\
  &  & \arrow[dashed]{ul}{\psi_g} \arrow[swap]{u}{(m_f)\vert_{\ker m_f}} \ker f_m \arrow[hook]{r} & \arrow[swap]{u}{m_f} H_m \arrow{r}{f_m} & \arrow{u}{m} G\times G.
\end{tikzcd}
\]
On the other hand, $(f,\psi) \boxtimes (f,\psi) = (f\times f, \psi\otimes \psi)$.
Since $f\circ m_H = m \circ (f\times f)$, by the universal property of pull-back, there is a unique $\theta : H\times H \to H_m$ making the following commute.
\[
\begin{tikzcd}
\ &  & \arrow{ld}{\psi} A \arrow[hook]{r} & H \arrow{r}{f} &  G\\
V \arrow{d}{U} & \Aut(V)  & \arrow{l}{\psi_g} \arrow{u} A_m \arrow[hook]{r} & \arrow[swap]{u}{m_f} H_m \arrow{r}{f_m} & \arrow{u}{m} G\times G\\
V\otimes V & \Aut(V\otimes V) & \arrow[swap]{l}{\psi\otimes\psi} \arrow[bend left]{uu}{m_H} \arrow[swap]{u}{\theta\vert_{A\times A}} A \times A \arrow[hook]{r}{} & \arrow[bend left]{uu}{m_H} \arrow[swap]{u}{\theta} H \times H \arrow{r}{f\times f} & \arrow[equal]{u} G\times G\\
\end{tikzcd}
\]
Choose a basis $\{ v_1 \}$ for $V$; then $\{ v_1\otimes v_1 \}$ is a basis for $V\otimes V$. Define $U : V \to V\otimes V$ by $U(v_1) = v_1\otimes v_1$. Then the lower part of this diagram defines a weak isomorphism $(\theta,U): m^*(f,\psi) \to (f,\psi)\boxtimes (f,\psi)$  in $C_1(G)$. 

While $\theta$ was canonical, $U$ was not, as it depended on the choice of a basis for $V$. However, after passing from $C_1(G)$ to $\GCf(G)$, the resulting isomorphism $\mu(f,\psi): m^*(f,\psi) \to (f,\psi)\boxtimes (f,\psi)$ is canonical in $\GCf(G)$.
\end{proof}



%\Clifton{I'll address this point in the next section: "Because $\Gal(\bFq/\Fq)$ acts trivially on $\Aut({\bar f})$, the local system ${\bar L}_G(f,\psi)\ceq b_G^* L(f,\psi)$ comes equipped with a canonical isomorphism $F : \Frob{G}^* {\bar L}_G(f,\psi) \to {\bar L}_G(f,\psi)$ of constructible sheaves on ${\bar G}$."}

We will see that the full subcategory $\GC_f(G) \subset \GC_0(G)$ of finite geometrized characters is a proper subcategory, in general. Indeed, it follows from our main result regarding geometrized characters, Theorem~\ref{thm:snake}, that the restriction of $\trFrob{G} : \GCiso{G} \to G(\Fq)^*$ to the subgroup $\GCfiso{G}$ is an isomorphism onto the subgroup of $\chi \in G(\Fq)^*$ such that the image of $\chi$ is finite in $\EEx$. 
 
\section{Connected commutative algebraic groups}

%\input{connected-1}
% !TEX encoding = UTF-8 Unicode
%In this section we review a fundamental property of character
%sheaves on geometrically connected, commutative algebraic groups over $\Fq$.

\begin{proposition}\label{prop:connected}
  If $G$ is a connected commutative algebraic group over $\Fq$ then 
  the full subcategories $\GCf(G) \hookrightarrow \GCb(G) \hookrightarrow \GC(G)$ 
  appearing in Section~\ref{sec:bounded} are equivalences 
  and
  \[
  \trFrob{G} : \GCiso{G} \to G(\Fq)^*
  \]
  is an isomorphism of groups.
\end{proposition}

\begin{proof}
 %Let $G$ be a geometrically connected algebraic group over $\Fq$.
  Observe that the forgetful functor $(\gcs{L},\mu,\phi) \mapsto (\gcs{L},\phi)$
  sends geometrized characters of $G$ to $\ell$-adic Weil sheaves on $G$ \cite{Deligne:Weil2}*{1.1.10}.
  While is it not true that all Weil sheaves on $G$ descend to local systems on $G$, 
  we will see that those that appear in the image of this forgetful functor from geometrized characters do. 

  Let $g$ be any $\Fq$-rational point on $G$ 
  and let $\bg$ be the geometric point on $G$ lying above $g$ 
  (we fixed $\Fq \hookrightarrow \bFq$ long ago). 
  Since $G$ is connected, the geometric point $\bg$ determines
  an equivalence between the category of $\ell$-adic Weil local systems on $G$ and
  $\ell$-adic representations of $\W(G,\bg)$ \cite{Deligne:Weil2}*{1.1.12}. 
  Now let $(\gcs{L},\mu,\phi)$ be a geometrized character of $G$ 
  and let $\rho : \W(G, \bg) \to \EEx$ be the character determined by $(\gcs{L},\phi)$. 
  The $\Fq$-rational point $g$ under the geometric point $\bg$ determines a splitting
  $\Weil{\Fq}\to \W(G,\bg)$ of $\W(G,\bg)\to \Weil{\Fq}$. 
  In this way the Weil local system $(\gcs{L},F)$ determines an $\ell$-adic character $\rho_g : \Weil{\Fq} \to \EEx$.
  %\[
  %\begin{tikzcd}
  %1 \rar & \pi_1(\bG, \bg) \rar &  \arrow{d}{\rho} \W(G,\bg) \rar
  %& \ar[swap,bend right, dotted]{l}{g} \arrow[dotted]{dl}{\rho_g} \Weil{\Fq} \rar & 1\\
  %&&\EEx&&
  %\end{tikzcd}
  %\]
  This character is given by the trace of Frobenius of $\cs{L}$ at $g$, as defined in Section~\ref{sec:Frob}:
  \[
  \rho_g(\Frob{\Fq}) =  \trFrob{\cs{L}}(g).
  \]
  
  On the other hand, we have already seen that $\trFrob{\cs{L}} : G(\Fq) \to \EEx$
  is a group homomorphism. Since $G$ is an algebraic group over $\Fq$, it is a
  variety over $\Fq$, so finitely generated over $\Fq$, so $G(\Fq)$ is finite;
  it follows that $\trFrob{\cs{L}}(g) = \rho_g(\Frob{\Fq})$ is a root of unity,
  for every $g\in G(\Fq)$.  Since $\Weil{\Fq}$ is generated by
  $\Frob{\Fq}$ and $\rho_g : \Weil{\Fq} \to \EEx$ is
  a character, it follows that the image of $\rho_g$ is a finite group.
  Thus, $\rho_g$ extends to an $\ell$-adic character of $\Gal(\bFq/\Fq)$, 
  denoted by the same symbol, below.
  \[
  \begin{tikzcd}
  1 \rar & \ar[equal]{d} \pi_1(\bG, \bg) \rar & \W(G,\bg) \rar \dar & \Weil{\Fq} \arrow[bend left]{rr}{\rho_g} \rar \dar & 1 & \EEx\\
  1 \rar &  \pi_1(\bG, \bg) \rar & \pi_1(G,\bg) \rar & \Gal(\bFq/\Fq) \arrow[dotted]{rru} \rar & 1 &
  \end{tikzcd}
  \]

  We may now lift the $\ell$-adic character $\rho_g : \Gal(\bFq/\Fq) \to \EEx$
  to an $\ell$-adic character $\pi_1(G,\bg) \to \EEx$ using the canonical topological group homomorphism
  $\pi_1(G,\bg) \to \Gal(\bFq/\Fq)$ determined by the structure map for $G$. But $\bg$ also
  determines an equivalence between the category of $\ell$-adic
  representations of $\pi_1(G,\bg)$ and $\ell$-adic local systems on $G$. Let
  $\cs{L}_0$ be a local system on $G$ in the isomorphism class
  determined by this $\ell$-adic character of $\pi_1(G,\bg)$.
  Then $b_G^*\cs{L}_0 \iso \gcs{L}$.
  Since $b_G^*$ is full and faithful (again, see \cite{SGA7.2}*{Expos\'e XIII} or even \cite{BBD}*{Prop. 5.2.1}),
  $
  b_{G\times G}^* : \Hom(m^*\cs{L}_0,\cs{L}_0\boxtimes\cs{L}_0) \to \Hom({\bar m}^*\gcs{L},\gcs{L}\boxtimes\gcs{L})
  $ 
  is a bijection 
  (hom taken in the categories on constructible $\ell$-adic sheaves on 
  $G\times G$ and ${\bar G}\times {\bar G}$ respectively, 
  in which $\ell$-adic local systems sit as full subcategories). 
  Let $\mu_0 : m^*\cs{L}_0 \to \cs{L}_0\boxtimes\cs{L}_0$ be the isomorphism matching 
  $\mu : {\bar m}^*\gcs{L} \to \gcs{L}\boxtimes\gcs{L}$, 
  the latter appearing in the definition of $\cs{L}$. 
  Then, as in Section~\ref{sec:bounded}, $(\cs{L}_0,\mu_0)$ is an object in $\GCb(G)$ 
  and $\cs{L} = (\gcs{L},\mu,\phi)$ is isomorphic to $(b_G^*\cs{L}_0,b_{G\times G}^*\mu_0)$ in $\GC(G)$.
  Thus, the full and faithful functor $B_G^* : \GCb(G) \to \GC(G)$ from Section~\ref{sec:bounded}
  is also essentially surjective, hence an equivalence.
  %(when $G$ is a connected, commutative algebraic group over $\Fq$).
  
  In Section~\ref{sec:finite} we saw that $\GCf(G)$ is a full subcategory of $\GCb(G)$;
  more precisely, we exhibited a full and faithful functor $L_G : \GCf(G) \to \GCb(G)$.
  We now show that this functor is essentially surjective 
  when $G$ is a connected, commutative algebraic group over $\Fq$.
  
  Let $(\cs{L}_0,\mu_0)$ be a bounded geometrized character of $G$. 
  Then $\cs{L}\ceq B_G^*(\cs{L}_0,\mu_0)$ is a geometrized character of $G$.
  Recall the definition of the character $\trFrob{\cs{L}} : G(\Fq) \to \EEx$ from Section~\ref{sec:Frob}. 
  Let $f : G\to G$ be the Lang isogeny.
  Recall that $\ker f = G(\Fq) = G^\Frob{\Fq}$; 
  in particular, the action of $\Gal(\bFq/\Fq)$ on $\ker f$ is trivial.
  Let $V = \EE$ and let $\psi : \ker f \to \Aut(V)$ be the representation given by 
  $\psi(g)(v) = \trFrob{\cs{L}}(g) v$ for $v\in V$. 
  Then $(f,\psi)$ is a finite geometrized character. 
  
  To show that $L_G(f,\psi) \iso (\cs{L}_0,\mu_0)$ we simply apply the functions--sheaves dictionary
  as follows ({\it cf} \cite{Laumon}*{1.1.3} or, ultimately, \cite{SGA4.5}*{Sommes trigonométriques}).
  First, recall that $L_G(f,\psi) = (L(f,\psi), \mu(f,\psi))$. 
  By  \cite{Laumon}*{1.1.3.3}, $\trFrob{(G_{k'}\hookrightarrow G)^*L(f,\psi)} = \trFrob{\cs{L}} \circ N_{k'/k}$, for each finite extension $k'/k$.
  On the other hand, $\trFrob{\cs{L}} \circ N_{k'/k} = \trFrob{(G_{k'}\hookrightarrow G)^*\cs{L}}$,  by Proposition~\ref{prop:basechange}.
  %Using notation from \cite{Laumon}*{1.1}, this means $t_{\bullet L(f,\psi)} = t_{\bullet \cs{L}_0}$.
  Using \cite{Laumon}*{Th\'eor\`eme~1.1.2}, it follows that  $L(f,\psi) \iso \cs{L}_0$ in $\Loc(G)$.
  It is now clear that $(L(f,\psi),\mu(f,\psi)) \iso (\cs{L}_0,\mu_0)$ in $\GCb(G)$.
  This completes the proof that $L_G : \GCf(G) \to \GC(G)$ is essentially surjective.
  Since we have already seen (in Section~\ref{sec:finite}) that $L_G$ is full and faithful, 
  it follows that $L_G$ is an equivalence.
  
  To finish the proof of Proposition~\ref{prop:connected}, it suffices to observe that the group homomorphism
  $
  \trFrob{G} : \GCiso{G} \to G(\Fq)^*
  $
  is surjective because each character $\chi \in G(\Fq)^*$ determines a finite geometrized character $(\Lang,\chi)$ such that the trace of Frobenius of the geometrized character $B_G^* (L_G(\Lang,\chi^{-1}))$ is $\chi$.
\end{proof}

\section{Geometrized characters of commutative \'etale group schemes}

%\input{etale-1}
%In this section we establish a fundamental property of character
% sheaves on commutative etale group schemes over $\Fq$ that are
% geometrically finitely generated.

\'Etale group schemes form a counterpoint to connected groups, since the component group
is always \'etale.  The functor $G \mapsto G(\bFq)$ defines an equivalence of categories
between the category of \'etale group schemes over $\Fq$ and the category of groups equipped
with an action of $\Gal(\bFq/\Fq)$, continuous for the discrete topology on the group.

For such a $\Gal(\bFq/\Fq)$-group $G(\bFq)$, we define a category of geometrized characters $\GC(G(\bFq))$.
An object in $\GC(G(\bFq))$ is given by the data of

\begin{enumerate}
 \labitem{(cs.0)}{cs.0} an indexed set of one-dimensional
  $\EE$-vector spaces $\gcs{L}_x$, as $x$ runs over
  $G(\bFq)$;

 \labitem{(cs.1)}{cs.1} an indexed set of isomorphisms
  $\mu_{x,y} : \gcs{L}_{x+y} \mathop{\longrightarrow}\limits^{\iso} \gcs{L}_{x} \otimes \gcs{L}_{y}$,
  for all $x,y \in G(\bFq)$, such that
  \[
   \begin{tikzcd}[row sep=40]
    \gcs{L}_{x+y+z} \arrow{rr}{\mu_{x+y,z}} \arrow[swap]{d}{\mu_{x,y+z}}
    && \gcs{L}_{x+y}\otimes \gcs{L}_{z} \dar{\mu_{x,y} \tight{0.5}{\otimes}{1} \id} \\
    \gcs{L}_{x} \otimes \gcs{L}_{y+z} \arrow{rr}{\id \otimes \mu_{y,z}}
    && \gcs{L}_{x} \otimes\gcs{L}_{y} \otimes \gcs{L}_{z}
   \end{tikzcd}
  \]
  commutes, for all $x,y,z\in G(\bFq)$; and

 \labitem{(cs.2)}{cs.2} an indexed set of isomorphisms $\phi_{x} : \gcs{L}_{\Frob{\Fq}(x)} \to \gcs{L}_x$
  such that
  \[
   \begin{tikzcd}[row sep=40]
    \gcs{L}_{\Frob{\Fq}(x)+\Frob{\Fq}(y)} \arrow[swap]{d}{\phi_{x+y}} \arrow{rr}{\mu_{\Frob{\Fq}(x),\Frob{\Fq}(y)}}
    && \gcs{L}_{\Frob{\Fq}(x)}\otimes \gcs{L}_{\Frob{\Fq}(y)} \dar{\phi_x \tight{0}{\otimes}{0} \phi_y} \\
    \gcs{L}_{x+y} \arrow{rr}{\mu_{x,y}}
    && \gcs{L}_x \otimes\gcs{L}_y
   \end{tikzcd}
  \]
  commutes, for all $x,y\in G(\bFq)$.
\end{enumerate}

A morphism $\alpha : \cs{L} \to \cs{L'}$ is given by 
\begin{enumerate}
 \labitem{(cs.3)}{cs.3} an indexed set $\alpha_x : \gcs{L}_x \to \gcs{L'}_x$
  of linear transformations (of one-dimensional $\EE$-vector spaces),
  as $x$ runs over $G(\bFq)$, such that
  \[
   \begin{tikzcd}[column sep=40]
    \arrow[swap]{d}{\phi_x} \gcs{L}_{\Frob{\Fq}(x)} \rar{\alpha_{\Frob{\Fq}(x)}} & \gcs{L'}_{\Frob{\Fq}(x)} \dar{\phi_x'}
    &\arrow[draw=none]{d}[pos=.4,description]{\text{\normalsize{and}}}& \arrow[swap]{d}{\mu} \gcs{L}_{x+y} \rar{\alpha_{x+y}} & \gcs{L'}_{x+y} \dar{\mu'_{x+y}} \\
    \gcs{L}_x \rar{\alpha_x} & \gcs{L'}_x
    & {} & \gcs{L}_x\otimes\gcs{L}_y \rar{\alpha_x\otimes \alpha_y} & \gcs{L'}_x \otimes \gcs{L'}_y
   \end{tikzcd}
  \]
  both commute.
\end{enumerate}

The functor $\GC(G) \to \GC(G(\bFq))$ defined by
$(\gcs{L}, \mu, \phi) \mapsto (\gcs{L}_x = x^*\gcs{L}, \mu_{x,y} = (x \times y)^* \mu, \phi_x = x^*\phi)$
is easily seen to be an equivalence.  

We may now define a \cdef{global section}
of a geometrized character $\cs{L}$ on an \'etale group scheme $G$ as a choice $s(x) \in \gcs{L}_x$ for every
$x \in G(\bFq)$, satisfying
 \begin{equation}\label{section}
  \forall x,y \in G(\bFq), \qquad \mu_{x,y}(s(x+y)) = s(x)\otimes s(y).
 \end{equation}
\Clifton{I've been putting lemmata after the propositions that use them, 
to keep the flow of the sections clear. 
Would you mind if I do the same in this section?}

\begin{lemma}\label{lemma:section}
 If $\cs{L}$ is a geometrized character on a commutative, \'etale group scheme $G$
 with $G(\bFq)$ finitely generated then nontrivial global sections of $\cs{L}$ exist.
\end{lemma}

\begin{proof}
  Since $G(\bFq)$ is a finitely-generated abelian group, it admits a decomposition
  \[
  G(\bFq) \iso \ZZ^r \oplus \bigoplus_{j=1}^t \ZZ / m_j \ZZ;
  \]
  let $x_1, \ldots, x_r, y_1, \ldots, y_t$ be a corresponding set of generators of $G(\bFq)$.
  We will define a section $s$ by choosing values on these generators and extending to all
  of $G(\bFq)$ through \eqref{section}.
  
  There is a unique isomorphism $\gcs{L}_0 \cong \EE$ under which $\mu_{0,0}$ corresponds
  to the multiplication map $\EE \otimes \EE \to \EE$.
  The condition $\mu_{0,0}(s(0)) = s(0) \otimes s(0)$ together with the non-triviality of $s$
  then forces $s(0) = 1$.
  
  The $\mu_{x,y}$ yield an isomorphism $\alpha_j : \gcs{L}_{y_j}^{\otimes m_j} \to \gcs{L}_0$.
  An initial nonzero choice of $s(y_j)$ need only be scaled by $\alpha_j(s(y_j))^{-1/m_j}$ in order to map to
  $1$ under this isomorphism.  Since compatibility under the $\alpha_j$ are the only constraints on the
  $s(x_j)$ and $s(y_j)$, global sections exist.
\end{proof}

These global sections will allow us to construct the isomorphism in the following proposition.

\begin{proposition}\label{prop:etale}
  If $G$ is a commutative \'etale group scheme over $\Fq$ and
  $G(\bFq)$ is finitely generated then there is a canonical
  isomorphism
  \[
  \GCiso{G} \longrightarrow \Hh^1(\Weil{\Fq}, G(\bFq)^*),
  \qquad \text{given by}\qquad
  [\cs{L}] \mapsto [\tau_\cs{L}],
  \]
  where $\tau_\cs{L}: \Weil{\Fq}\to G(\bFq)^*$ is a cocycle such that
  \[
  \forall x\in G(\Fq), \qquad \tau_\cs{L}(\Frob{\Fq})(x) = \trFrob{\cs{L}}(x).
  \]
\end{proposition}

\begin{proof}
  Suppose $\cs{L}$ is a geometrized character on $G$.  Using Lemma~\ref{lemma:section}, we may choose a global section $s_{\cs{L}}$
  of $\cs{L}$.  We will construct a group isomorphism between $\GCiso{G(\bFq)}$ and
  $\Hh^1(\Weil{\Fq}, G(\bFq)^*)$ using $s_{\cs{L}}$, then prove independence from the choice of section.

  Starting from $\cs{L}$, we define a cocyle $\tau_{\cs{L}} \in Z^1(\Weil{\Fq},G(\bFq)^*)$ as follows.
  For $x \in G(\bFq)$, $\cs{L}$ determines an isomorphism $\phi_x : \gcs{L}_{\Frob{\Fq}(x)} \to \gcs{L}_x$
  of one-dimensional $\EE$-vector spaces; define $\tau_\cs{L}$ by
  \begin{equation}\label{t}
   \phi_{x}(s(\Frob{\Fq}(x))) = \tau_\cs{L}(\Frob{\Fq})(x) s(x).
  \end{equation}
  Note that if $x$ is fixed by $\Frob{k}$ then $\tau_\cs{L}(\Frob{\Fq})(x)$ is just $t_\cs{L}(x)$, so the restriction of
  $\tau_\cs{L}(\Frob{k})$ to $G(k)$ is just $t_\cs{L}$.
  In general, conditions \ref{cs.0} and \ref{cs.2}, together with \eqref{section}, guarantee that
  the scalar $\tau_\cs{L}(\Frob{k})(x)$ is non-zero.  Moreover, condition~\ref{cs.1} forces
  $\tau_\cs{L}(\Frob{\Fq})(x+y) = \tau_\cs{L}(\Frob{\Fq})(x) \ \tau_\cs{L}(\Frob{\Fq})(y)$
  for all $x,y \in G(\bFq)$.  Now define $\tau_\cs{L} : \Weil{\Fq} \to G(\bFq)^*$ recursively by
  \[
   \tau_\cs{L}(\Frob{\Fq}^n) \ceq \tau_\cs{L}(\Frob{\Fq})\cdot \,^\Frob{\Fq} \tau_\cs{L}(\Frob{\Fq}^{n-1}),
  \]
  where $\Frob{\Fq}$ acts on $G(\bFq)^*$ through pre-composition and $\cdot$ refers
  to pointwise multiplication of functions.

  Although we used a global section $s_\cs{L}$ in the definition of
  $\tau_\cs{L}$, the class of $\tau_\cs{L}$ does not depend on this
  choice. To see why, let $s_1$ and $s_2$ be two global sections of
  $\cs{L}$ and let $\tau_1$ and $\tau_2$ be the cocycles defined by $s_1$ and $s_2$.
  For each $x \in G(\bFq)$ there is a unique scalar
  $a(x) \in \EEx$ such that $s_2(x) = a(x) s_1(x)$. Then \eqref{section} and
  condition~\ref{cs.1} together imply $a(x+y) = a(x)a(y)$, so
  $a\in G(\bFq)^*$.  The coboundary $\tau_0 : \Weil{\Fq} \to G(\bFq)^*$
  defined by $\tau_0(\Frob{\Fq}) = \,^\Frob{\Fq} a \cdot a^{-1}$ satisfies $\tau_2 = \tau_0 \tau_1$,
  so $\tau_2$ and $\tau_1$ are cohomologous. Thus
  \begin{equation}\label{cohomologous}
    \obj \GC(G(\bFq)) \longrightarrow \Hh^1(\Weil{\Fq},G(\bFq)^*),
    \qquad \text{defined by} \qquad \cs{L} \mapsto [\tau_\cs{L}],
  \end{equation}
  is independent of the choice of global sections made above.

  We now show that $[\tau_\cs{L}]$ depends only on the isomorphism class of $\cs{L}$.
  Let $\varphi : \cs{L} \to \cs{L'}$ be an isomorphism and
  let $\tau$ and $\tau'$ be any cocycles representing the classes in the
  image of $\cs{L}$ and $\cs{L'}$ under \eqref{cohomologous}; by construction,
  $\tau$ and $\tau'$ are defined by sections $s$ and $s'$. Now, $\varphi_x(s(x))$ is a
  non-zero scalar multiple of $s'(x)$; define $\delta: G(\bFq) \to \EEx$
  by $\varphi_x(s(x)) = \delta(x) s'(x)$.
  By the second part of condition~\ref{cs.3},
  $\delta(x+y) = \delta(x)\delta(y)$, so $\delta \in G(\bFq)^*$. By the first part of
  condition~\ref{cs.3}, $\tau'(\Frob{\Fq}) = \tau(\Frob{\Fq}) \cdot (\,^{\Frob{\Fq}^{-1}}\delta \cdot \delta^{-1})$,
  so $\tau$ and $\tau'$ are cohomologous. This concludes the definition of
  \begin{equation}\label{pich1}
    \GCiso{G(\bFq} \longrightarrow \Hh^1(\Weil{\Fq},G(\bFq)^*).
  \end{equation}

  It only remains to show that \eqref{pich1} is a group
  isomorphism.  Suppose that $\cs{L}$ and $\cs{L}'$ are two geometrized characters.
  If $s$ is a global section for $\cs{L}$ and $s'$ for $\cs{L}'$ then $s \otimes s'$ is a global section for
  $\cs{L} \otimes \cs{L}'$.  The three versions of \eqref{t} for $\cs{L}, \cs{L'}$ and $\cs{L} \otimes \cs{L}'$ imply that
  $\tau_{\cs{L} \otimes \cs{L}'}(\Frob{k}) = \tau_\cs{L}(\Frob{k}) \tau_{\cs{L}'}(\Frob{k})$.
\end{proof}


\section{On the cohomology of the dual of an etale group scheme}
%\input{etale-2}
%Define $\rho \colon \Hh^1(\Weil{\Fq}, \Hom(G(\bFq), \EEx))
% \rightarrow \Hom(G(\Fq), \EEx)$ by $\rho(\phi)(g) =
% \phi(\Frob)(g)$.

Although this section does not mention geometrized characters, 
we will need Proposition~\ref{prop:X} to prove our main result on geometrized characters, 
Theorem~\ref{thm:snake}.

\begin{proposition}\label{prop:X}
  Let $X$ be a finitely generated abelian group equipped with an
  action of $\Gal(\bFq/\Fq)$, continuous for the discrete topology on
  $X$.  Then
  \begin{align*}
%    \Hh^1(\Fq, \Hom(X, \EEx)) &\xrightarrow{\rho} \Hom(\Hh^0(\Fq, X), \EEx) \\
    \Hh^1(\Fq, X^*) &\xrightarrow{\rho} \Hh^0(\Fq, X)^* \\
    \rho([z])(x) &= z(\Frob{\Fq})(x)
  \end{align*}
  is an isomorphism of groups.
\end{proposition}
\begin{proof}
  We first prove that $\rho$ is surjective.  Suppose that
  $f \in \Hom(X^\Frob{\Fq}, \EEx).$ Since $\EEx$ is divisible
  as an abelian group it is injective as a $\ZZ$-module and thus
  $\Ext^1_{\ZZ}(X/X^\Frob{\Fq}, \EEx) = 0$.  Applying the functor
  $\Hom(\mbox{---}, \EEx)$ to
  \[
  \begin{tikzcd}
  0 \rar & X^\Frob{\Fq} \rar & X \rar & X/X^\Frob{\Fq} \rar & 0
  \end{tikzcd}
  \]
  and considering the associated long exact sequence gives the
  existence of an $\tilde{f} \in \Hom(X, \EEx)$ restricting to
  $f$.  Define a $1$-cocycle $z \in \Hh^1(\Fq, \Hom(X,\EEx))$ by
  mapping $\Frob{\Fq}$ to $\tilde{f}$.  Then $\rho([z]) = f$.

  Now suppose that $[z] \in \Hh^1(\Fq,\Hom(X,\EEx))$ with
  $\rho([z]) = 1$; write $\tilde{f}$ for $z(\Frob{\Fq})$.  The injectivity
  of $\rho$ is equivalent to the existence of a homomorphism $\psi
  \colon X \rightarrow \EEx$ with
  $$\tilde{f}(x) = \frac{\psi(\Frob{\Fq}(x))}{\psi(x)}$$
  for $x \in X$.  In fact, we may replace the construction of $\psi$
  for all $\ZZ[\Gal(\bFq/\Fq)]$-modules $X$ with the construction of
  analogous $\psi$s for a different class of modules.

  Since the action of $\Gal(\bFq/\Fq)$ is continuous, there is an $m$
  so that $\Frob{\Fq}^m$ acts trivially on $X$; write $\Fqm$ for the degree
  $m$ extension of $\Fq$ and $\Gamma_m$ for $\Gal(\Fqm/\Fq)$.  Since
  $T^m-1$ factors as a squarefree product of cyclotomic polynomials,
  the Chinese remainder theorem expresses $\ZZ[\Gamma_m]$ as a product
  of $\ZZ[\zeta_d]$ for $d$ dividing $m$.  Each $\ZZ[\zeta_d]$ is the
  maximal order in a number field and thus $\ZZ[\Gamma_m]$ is a
  product of Dedekind domains.  Therefore $X$ decomposes into a direct
  sum of cyclic $\ZZ[\Gamma_m]$-modules \cite[?]{Brandal}, each of the
  form $\ZZ[\Gamma_m] / I$ for some ideal $I \subset \ZZ[\Gamma_m]$.
  The ideal $I$ corresponds to a direct product of ideals $I_d$ in the
  $\ZZ[\zeta_d]$, and within each $\ZZ[\zeta_d]$ the Chinese remainder
  theorem allows a further decomposition of $\ZZ[\zeta_d] / I_d$ as a
  direct sum of $\ZZ[\zeta_d]$-modules of the form $\ZZ[\zeta_d]/P^s$.
  So if we can construct, for every cyclotomic ring $\ZZ[\zeta_d]$,
  prime ideal $P \subset \ZZ[\zeta_d]$ and positive integer $s$, a
  $\psi \colon \ZZ[\zeta_d]/P^s \rightarrow \EEx$ with
  \begin{equation} \label{eq:psi-condition}
    \tilde{f}(x) = \frac{\psi(\zeta_d \cdot x)}{\psi(x)},
  \end{equation}
  then the existence of the original $\psi$ follows because $X$ is a
  direct sum of such $\ZZ[\zeta_d]/P^s$.

  We now fix a $d$, $P$ and $s$, write $\zeta$ for $\zeta_d$ and
  choose a polynomial
  $$h(T) = a_rT^r + a_{r-1}T^{r-1} + \cdots + a_0$$
  so that $P^s = (p^s, h(\zeta_d))$.
  % Setting $\psi = 1$ will satisfy equation \ref{eq:psi-condition}
  % when $d = 1$.
  An an abelian group, the quotient $\ZZ[\zeta] / P^s$ is generated by
  $\zeta^i$ for $0 \le i < \phi(d)$; we define
  \begin{equation} \label{eq:psi-def}
    \psi(\zeta^i) = \alpha \prod_{j=0}^{i-1} \tilde{f}(\zeta^j)
  \end{equation}
  for an $\alpha \in \EEx$ to be chosen later.  Since there are
  relations among the $\zeta^i$ we first need to check that $\psi$ is
  well-defined.

  The relations among the generators $\zeta^i$ are additively
  generated by $\zeta^ch(\zeta)$ as $c$ ranges from $0$ to
  $\phi(d)-r-1$.  If we set
  $$A_c = \sum_{i=0}^r a_i \sum_{j=0}^{i+c-1} \zeta^j$$
  then
  $$\psi(\zeta^ch(\zeta)) = \alpha^{h(1)} \tilde{f}(A_c).$$
  Now consider $(\zeta - 1)A_c$: the sums telescope and we get that
  $(\zeta-1)A_c = \zeta^ch(\zeta) - h(1).$ There are now two
  possibilities:
  \begin{enumerate}
  \item $d$ is a power of $p$; write $s = \phi(d)m + n$.  We may take
    $h(T)$ to be $p^m(T-1)^n$, in which case $\zeta^ch(\zeta) - h(1) \in P^s$,
    so $A_c$ is fixed under multiplication by $\zeta$ in
    $\ZZ[\zeta]/P^s$ and thus $\tilde{f}(A_c) = 1$.  In this case
    $\alpha^{h(1)} = 1$ regardless of $\alpha$.
  \item $d$ is not a power of $p$.  If two distinct primes divide $d$
    then $\zeta - 1$ is a unit; otherwise $\zeta - 1$ is a unit modulo
    $P^s$.  Let $\omega \in \ZZ[\zeta]$ satisfy
    $\omega(\zeta - 1) \equiv 1 \pmod{P^s}$ and set
    \begin{equation} \label{alpha-def}
      \alpha = \tilde{f}(\omega).
    \end{equation}
    Then $A_c + h(1)\omega$ is fixed under multiplication by $\zeta$
    and thus $\tilde{f}(A_c) = \tilde{f}(-h(1)\omega)$.
  \end{enumerate}
  In either case, $\psi(\zeta^ch(\zeta)) = 1$ for all $c$.  The only
  other relations imposed on the $\zeta^i$ are that they are all
  killed under multiplication by $p^s$.  Since $\tilde{f}$ is also a
  homomorphism $\ZZ[\zeta]/P^s \rightarrow \EEx$ the values of
  $\tilde{f}$ and thus of $\psi$ will be $p^s$-roots of unity.
  Therefore $\psi$ is well defined.

  We now check equation \ref{eq:psi-condition} for
  $x = \zeta^{\phi(d)-1}$.  Write
  $\Phi_d(T) = T^{\phi(d)} - b_{\phi(d)-1}T^{\phi(d)-1} - \cdots - b_0$
  and set
  $$B = \sum_{i=0}^{\phi(d)-1} -\zeta^i + b_i \sum_{j=0}^{i-1} \zeta^j.$$
  We have

  \begin{align*}
    \frac{\psi(\zeta^{\phi(d)})}{\psi(\zeta^{\phi(d)-1})\tilde{f}(\zeta^{\phi(d)-1})}
    &= \frac{\psi(b_{\phi(d)-1}\zeta^{\phi(d)-1} + \cdots + b_0)}{\psi(\zeta^{\phi(d)-1})\tilde{f}(\zeta^{\phi(d)-1})} \\
    &= \alpha^{-\Phi_d(1)} \tilde{f}(B)
  \end{align*}
  As before we see that $(\zeta - 1)B = \Phi_d(1) - \Phi_d(\zeta) = \Phi_d(1)$.
  We consider the same cases as before:

  \begin{enumerate}
  \item $d$ is a power of $p$, in which case $\Phi_d(1) = p$.  Thus
    $(\zeta-1)B = p = u(\zeta-1)^{\phi(d)}$ for a unit $u \in \ZZ[\zeta]$
    and $B - u(\zeta-1)^{\phi(d)-1}$ is fixed by $\zeta$,
    so that $\tilde{f}(B) = \tilde{f}(u(\zeta - 1)^{\phi(d)-1})$.  The
    multiplicative order of $\tilde{f}(u(\zeta-1)^{\phi(d)-1})$ is at most
    $\lceil \frac{s - 1 - (\phi(d)-1)}{\phi(d)}\rceil = \lceil \frac{s}{\phi(d)} \rceil - 1$
    while the additive order of $1 \in \ZZ[\zeta]/P^s$ is $\lceil \frac{s}{\phi(d)} \rceil$.
    Thus we may choose $\alpha = \psi(1)$ with $\alpha^p = \tilde{f}(B)$.
  \item $d$ is not a power of $p$ and $\omega$ is the inverse of
    $\zeta-1$ modulo $P^s$.  Then $\tilde{f}(B) = \tilde{f}(\omega\Phi_d(1))$.
  \end{enumerate}
  In either case, $\alpha^{-\Phi_d(1)}\tilde{f}(B) = 1$ and thus
  $\psi$ satisfies equation \ref{eq:psi-condition} for
  $x = \zeta^{\phi(d)-1}$.  The definition of $\psi$ in \ref{eq:psi-def}
  immediately implies that $\psi$ satisfies equation
  \ref{eq:psi-condition} for lesser powers of $\zeta$, and thus for
  all $x$ by linearity.  The existence of $\psi$ shows that $\rho$ is injective.
\end{proof}

\section{Restriction to the identity component}

%\input{restriction}
% !TEX encoding = UTF-8 Unicode
%\subsection*{Restriction to the identity component is surjective}

Let $G^0$ be the connected component of $G$ containing the identity.
By Proposition~\ref{prop:pullback}, pull-back along
$G^0\hookrightarrow G$ determines a monoidal functor
$\cs{L}\mapsto \cs{L}\vert_{G^0}$ from $\GC(G)$ to $\GC(G^0)$.  In
this section we show that this functor is essentially surjective. 

\begin{proposition}\label{prop:restriction}
  The restriction functor $\GC(G)\to \GC(G^0)$ is essentially surjective.
\end{proposition}

\begin{proof}
  Because $G$ is smooth over $\Fq$, the identity component, 
  $G^0$, is a connected algebraic group over $\Fq$, 
  clopen in $G$ \cite{vdG&M}*{3.17}. 
  By Proposition~\ref{prop:connected}, every
  geometrized character on $G^0$ is isomorphic to a 
  finite geometrized character on $G^0$, 
  so to prove the proposition it suffices to show that every 
  finite geochar on $G^0$ extends to a geochar on $G$.
  
 Let $(\pi,\psi)$ be a finite geochar on $G^0$.
 By Lemma~\ref{lemma:ext}, there is an extension of the 
 descrete isogeny $\pi : B \to G^0$ 
 (see Section~\ref{sec:finite} for the definition of a discrete isogeny) 
 to a discrete isogeny $f : H \to G^0$ 
 such that $\pi_0(f) : \pi_0(H)\to \pi_0(G)$ is an isomorphism.
 Then $(f,\psi)$ is a finite geochar on $G$.
 Then $(f,\psi)\vert_{G^0} \iso (\pi,\psi)$,
 completing the proof that $\GC(G)\to \GC(G^0)$ is essentially surjective.
\end{proof}

\begin{lemma}\label{lemma:ext}
Every discrete isogeny onto $G^0$ extends to a discrete isogeny onto $G$ such that the component group of the covering space is isomorphic to the component group of $G$.
\end{lemma}

\begin{proof}
Let $\pi: B \to G^0$ be a discrete isogeny; set $A = \ker \pi$.
  We will find a discrete isogeny $f: H\to G$
  such that that $H^0 = B$, $f^0 =\pi$ and
  $\pi_0(f) : \pi_0(H)\to \pi_0(G)$ is an isomorphism of component
  groups.
  \begin{equation}\label{extension-diagram}
  \begin{tikzcd}
  A \arrow[equal]{r} \dar & A \dar \\
  B \rar \dar[swap]{\pi} & H \rar \dar[swap]{f} & \pi_0(H) \arrow{d}[below,rotate=90]{\sim}[swap]{\pi_0(f)} \\
  G^0 \rar & G \rar & \pi_0(G)
  \end{tikzcd}
  \end{equation}
  where all rows and columns are exact and all maps are defined over
  $\Fq$.  We will do so by passing back and forth between group
  schemes over $\Fq$ and their $\bFq$-points.  
  
  Extensions of
  $G^0(\bFq)$ by $A(\bFq)$, such as $A(\bFq) \to H^0(\bFq) \to G^0(\bFq)$,
  correspond to classes in $\Ext^1_{\ZZ[\Gamma]}(G^0(\bFq), A(\bFq))$.
  Similarly, extensions of $G(\bFq)$ by $A(\bFq)$ correspond to
  classes in $\Ext^1_{\ZZ[\Gamma]}(G(\bFq), A(\bFq))$.  The map
  $G^0(\bFq) \to G(\bFq)$ induces the map
  $\Ext^1_{\ZZ[\Gamma]}(G(\bFq), A(\bFq)) \to \Ext^1_{\ZZ[\Gamma]}(G^0(\bFq), A(\bFq))$,
  fitting into the long exact sequence derived from applying
  $\Hom(\mbox{---}, A(\bFq))$ to $G^0(\bFq) \to G(\bFq) \to \pi_0(G)(\bFq)$:
  $$\Ext^1_{\ZZ[\Gamma]}(G(\bFq), A(\bFq)) \to \Ext^1_{\ZZ[\Gamma]}(G^0(\bFq), A(\bFq)) \to \Ext^2_{\ZZ[\Gamma]}(\pi_0(G)(\bFq), A(\bFq)).$$
  We now show that $\Ext^2_{\ZZ[\Gamma]}(\pi_0(G)(\bFq), A(\bFq)) = 0$.

  It suffices to show that $\pi_0(G)(\bFq)$ has a two-term resolution
  by injective $\ZZ[\Gamma]$-modules.  Since the action of $\Gamma$ on
  $\pi_0(G)(\bFq)$ is continuous, it factor through a finite quotient
  $\Gamma_m = \Gamma / H_m$.  Any product of Dedekind domains has
  cohomological dimension $1$ \cite[?]{?}, so $\pi_0(G)(\bFq)$ has a
  two term resolution by injective $\ZZ[\Gamma_m]$-modules.  Let $I$
  be one of these modules: we need to show that $I$ is injective as a
  $\ZZ[\Gamma]$-module.  Consider the universal diagram for injectivity:
  
  \[
  \begin{tikzcd}
  A \rar{a} \arrow[hook]{d} & I \\
  B
  \end{tikzcd}
  \]
  where $A$ and $B$ are arbitrary $\ZZ[\Gamma]$-modules.  Since $H_m$ acts trivially on $I$,
  $I_{H_m}A := \langle (\gamma-1)a : \gamma \in H_m, a \in A \rangle \subseteq \ker(a).$
  Since $B / I_{H_m}B \cong B \otimes_A A / I_{H_m}A$, we get
  \[
  \begin{tikzcd}
  A \arrow[two heads]{r} \arrow[hook]{d} & A/I_{H_m}A \rar \arrow[hook]{d} & I \\
  B \arrow[two heads]{r} & B/I_{H_m}B \arrow[dashed]{ur} & {}
  \end{tikzcd}
  \]
  The dotted arrow exists since $I$ is injective as a
  $\ZZ[\Gamma_m]$-module, and the outer diagram shows that $I$ is
  injective as a $\ZZ[\Gamma]$-module.

  We therefore have the existence of diagram \eqref{extension-diagram}
  at the level of $\bFq$-points.  This expresses $H(\bFq)$ as a
  disjoint union of translates of $B(\bFq)$; by transport of structure
  we may take $H$ to be a group scheme over $\bFq$.  Similarly, the
  restriction of $f$ to each component of $H$ is a morphism of
  schemes, and thus $f$ is as well.  Finally, the whole diagram
  descends to a diagram of $\Fq$-schemes since the $\bFq$-points of
  the objects come equipped with continuous $\Gamma$-actions, and the
  morphisms are $\Gamma$-equivariant.
\end{proof}

\section{Main result regarding geometrized characters}

%\input{snake}
\begin{theorem}\label{thm:snake}
  If $G$ is a smooth abelian group scheme, locally of finite type over
  $\Fq$, and the abelian group $\pi_0(G)(\bFq)$ (the geometric
  component group) is finitely generated, then the trace of Frobenius
  homomorphism
  \[
  \trFrob{G} : \GCiso{G} \to G(\Fq)^*
  \]
  from the Picard group of the category of geometrized characters of $G$ to
  the group of characters of $G(\Fq)$, is an isomorphism.
\end{theorem}

\begin{proof}
  Consider the short exact sequence in the category of smooth group
  schemes, locally of finite type over $\Fq$, defining the component
  group scheme for $G$:
  \begin{equation}\label{eq:pi0}
  \begin{tikzcd}
    1 \rar & G^0 \rar & G \rar & \pi_0(G) \rar & 0.
  \end{tikzcd}
  \end{equation}
  Let
  \[
  \begin{tikzcd}[row sep=30]
    {}& \ker t_{\pi_0(G)} \dar & \arrow[dashed]{d} \ker \trFrob{G} & \ker t_{G^0} \dar & \\
    0 \rar & \GCiso{\pi_0(G)} \rar \dar{t_{\pi_0(G)}}
    & \GCiso{G} \rar \dar{\trFrob{G}} & \GCiso{G^0} \rar \dar{t_{G^0}} & 0\\
    0 \rar & \pi_0(G)(\Fq)^* \rar \dar
    & \arrow[dashed]{d} G(\Fq)^* \rar & G^0(\Fq)^* \rar \dar & 0\\
    & \coker t_{\pi_0(G)} & \coker \trFrob{G} &  \coker t_{G^0} &
  \end{tikzcd}
  \]
  be the commutative diagram of abelian groups obtained by applying
  Proposition~\ref{prop:pullback} to \eqref{eq:pi0}.  By
  Proposition~\ref{prop:connected}, $\ker t_{G^0} =0$ and $\coker t_{G^0}=0$.
  By Propositions~\ref{prop:etale} and \ref{prop:X}, $\ker t_{\pi_0(G)}=0$
  and $\coker t_{\pi_0(G)}=0$.

  The sequence of character groups is left-exact: by
  Proposition~\ref{prop:pullback}, it is dual to the exact sequence of
  abelian groups
  \begin{equation}\label{eq:pi1}
  \begin{tikzcd}
    1 \rar & G^0(\Fq) \rar & G(\Fq) \rar & \pi_0(G)(\Fq) \rar & 0;
  \end{tikzcd}
  \end{equation}
  since $\Hom(\ - \ ,\EEx)$ is left-exact, the sequence of
  character groups is left exact.

  The sequence of Picard groups is right-exact: it is exact at
  $\GCiso{G^0}$ by Proposition~\ref{prop:restriction}; and
  it is exact at $\GCiso{G}$ because the left-square
  commutes (by Proposition~\ref{prop:pullback}), the bottom sequence
  is exact at $G(\Fq)^*$ and $\coker t_{\pi_0(G)} =0$
  (by Propositions~\ref{prop:etale} and \ref{prop:X}) and
  \[
  \image(\GCiso{\pi_0(G)} \to \GCiso{G}) \subseteq \ker(\GCiso{G} \to \GCiso{G^0}),
  \]
  by the last part of Proposition~\ref{prop:pullback}. Specifically,
  suppose $\cs{L}$ is a geometrized character of $G$ that is trivial on
  $G^0$. Then $\trFrob{\cs{L}}\vert_{G^0(\Fq)} = \trFrob{\cs{L}^0} =0$,
  by Proposition~\ref{prop:pullback} again. Since the sequence of
  character groups is exact at $G(\Fq)^*$, there is
  some $\chi \in \pi_0(G)(\Fq)^*$ such that the
  pull-back of $\chi$ along $G(\Fq)\to \pi_0(G)(\Fq)$ is
  $\trFrob{\cs{L}}$. By Propositions~\ref{prop:etale} and \ref{prop:X},
  there is a a geometrized character $\cs{L}_\chi$ on $\pi_0(G)$, unique up
  to isomorphism, such that $\trFrob{\cs{L}_\chi} = \chi$. By
  Proposition~\ref{prop:pullback} again, $\cs{L}$ is isomorphic to the
  image of $\cs{L}_\chi$ under the monoidal functor $\GC(\pi_0(G)) \to \GC(G)$.

  It now follows immediately from the snake lemma that $\trFrob{G}$ is an
  isomorphism of groups.
\end{proof}

\Clifton{Return to finite and bounded character sheaves, explaining why our definition is the right one. Also explain why we don't think of local systems as representations of a fundamental group.}


\section{Application to characters of algebraic tori over local fields}

Let $K$ be a local field with residue field $\Fq$.
%(Note that we place no restriction on the characteristic of $K$.)
Let $T$ be an algebraic torus over $K$.

%In this section we introduce a group scheme $\GN{T}$ over $\Fq$ obtained by applying the Greenberg functor to the N\'eron lft-model for $T$ and establish some basic facts about $\GN{T}$

%\subsection{The N\'eron locally finite type model for $T$}

The lft-N\'eron model for $T$, denoted here by $\TT$, 
is a separated, smooth, commutative group scheme locally of finite type over $\OK$ 
(the ring of integers of $K$)
with generic fibre $T$, that enjoys the N\'eron mapping property: if
$S$ is a smooth scheme over $\OK$ then every morphism $S_\eta \to T$
over $K$ extends uniquely to a morphism $S \to \TT$. Equivalently, the
N\'eron mapping property states that the function
$\Hom_{\OK} (S,\TT) \to \Hom_K(S_\eta,T)$, given by restriction to
generic fibres, is a bijection; 
in particular, taking $S = \Spec{\OK}$, this implies $\TT(\OK) = T(K)$.

For each positive integer $d$, let $\TT_{d}$ be the group scheme obtained from $\TT$ by base change along $\OK \to \OK/\pK^d$, where $\pK$ is the maximal ideal in $\OK$. 
Observe that $\OK/\pK^d$ is an Artin ring and $\TT_{d}$ is smooth and locally of finite type over $\OK/\pK^d$.
%
Let \cdef{$\GN{T}_{d} = \Gr(\TT_d)$} be the group scheme over $\Fq$ produced by applying
the Greenberg functor to $\TT_{d}$; this is the \cdef{Greenberg transform of $\TT_d$}.
See \cite{Greenberg:2} and \cite[Ch. 9, \S 6]{BLR} and the first few sections of \cite{Stasinski} for background on the Greenberg functor. The fundamental properties of $\GN{T}_d$ that we need are:
 \begin{enumerate}
   \labitem{(GN.0)}{dFq} $\GN{T}_d(\Fq) = \TT(\OK/\pK^d)$, canonically.
  \labitem{(GN.1)}{GNd} $\GN{T}_d$ is a smooth, commutative group scheme, locally of finite type over $\Fq$, and the component group of $\GN{T}_d$ is geometrically finitely generated.
  \end{enumerate}
In fact, $\pi_0(\GN{T}_d) = \pi_0(\TT) \times_{\Spec{\OK}} \Spec{\Fq}$, and the latter is finitely generated by \cite{Xarles}. 

%\input{application}
\begin{theorem}\label{thm:application}
  Let $T$ be an algebraic torus over a non-Archimedean local field $K$.
  Let $\GN{T}_d$ be as above.  For each positive integer $d$, the
  Picard group of the category of geometrized characters of $\GN{T}_d$ is
  canonically isomorphic to the group of characters of $T(K)$ of depth
  less than $d$:
  \[
  \GCiso{\GN{T}_d} \iso \Hom_{< d}(T(K),\EEx).
  \]
\end{theorem}

\begin{proof}
  By \ref{GNd}, we may apply Theorem~\ref{thm:snake} to
  $\GN{T}_d$ which provides a canonical isomorphism
  $\GCiso{\GN{T}_d} \iso \GN{T}_d(\Fq)^*$.
  By \ref{dFq}, $\GN{T}_d(\Fq) \iso \TT(\OK/\pK^d)$ canonically.
  To finish the proof we recall that the filtration of $T(K)$ used to
  define depth has the property that $\TT(\OK/\pK^d) \cong T(K) / T(K)_d$
  \cite[Prop 5.2]{Yu}, so characters of $\GN{T}_d(\Fq)$ 
  are in bijection with characters of $T(K)$ vanishing on $T(K)_d$. 
  %Note that $d$ is a positive integer.  
\end{proof}

%\section{Application to admissible characters}

%\input{pro}
We may also assemble the group $\Fq$-schemes $\TT_{d}$ into one
glorious group pro-scheme over $\Fq$:
\begin{equation}\label{projlim}
  \cdef{\GN{T}} \ceq \varprojlim_{d\in \ZZ_{>0}} \GN{T}_{d}.
\end{equation}
This is the \cdef{Greenberg transform of the N\'eron model of $T$}.
 Some fundamental properties of $\GN{T}$ are:
 \begin{enumerate}
   \labitem{(GN.2)}{T(K)} $\GN{T}(\Fq) = T(K)$, canonically;
  \labitem{(GN.3)}{scheme} $\GN{T}$ is a commutative group scheme over $\Fq$.
  \end{enumerate}
This gives us a natural way to geometrize all admissible characters of $T(K)$
without reference to depth.
Let \cdef{$\GC(\GN{T})$} be the ind-category $\varinjlim_{d\in \ZZ_{>0}} \GC(\GN{T}_d)$;
we refer to objects of $\GC(\GN{T})$ as \cdef{geometrized characters of $T$}.

\begin{corollary}
Let $T$ be an algebraic torus over a non-Archimedean local field $K$.
The Picard group of the category $\GC(\GN{T})$ of geometrized characters of $T$ is canonically isomorphic to the group of admissible characters of $T(K)$:
  \[
 \GCiso{\GN{T}} \iso \Hom_\text{ad}(T(K),\EEx).
  \]
\end{corollary}

\section{Functoriality}

We have already seen that the trace of Frobenius defines a canonical homomorphism $\GCiso{\GN{T}} \to \Hom_\text{ad}(T(K),\EEx)$. 
In this section we show that this homomorphism is functorial, in the following sense.

\begin{proposition}
Trace of Frobenius $\GCiso{\GN{T}} \to \Hom_\text{ad}(T(K),\EEx)$ 
is a natural transformation between the following two additive functors from the additive category of algebraic tori over $K$ to the category of abelian groups: 
\begin{enumerate}
\item[$F_1$:] $T \mapsto \GCiso{\GN{T}}$;
\item[$F_2$:] $T \mapsto \Hom_\text{ad}(T(K),\EEx)$.
\end{enumerate}
\end{proposition}


\begin{proof}
When combined with the definition of $\GC(\GN{T})$ and Property~\ref{T(K)}, the first part of Proposition~\ref{prop:pullback} shows that $F_1$ is a functor, while the second part shows that Trace of Frobenius is a natural transformation $t: F_1 \to F_2$. When further combined with Proposition~\ref{prop:product}, we see that $F_1$ is an additive functor and $t: F_1 \to F_2$ is a natural transformation between additive functors.
\end{proof}

\section{Geometrization of restriction of scalars of local fields}

Let $L/K$ be a finite Galois extension and let $K'/K$ be the maximal unramified subextension, with residue field $k'$.  If $T$ is a torus over $K$, write $\TL$ for the N\'eron model of the base change $T_L$.  Then there is a canonical isomorphism
\[
\Res_{k'/k} \Gr(\TL) \cong \Gr(\underline{\Res_{L/K}(T_L)}).
\]
The natural inclusion $T \hookrightarrow \Res_{L/K} T_L$ induces a map of $k$-schemes
\[
\GN{T} \hookrightarrow \Res_{k'/k} \Gr(\TL)
\]
and thus a functor on character sheaves through pullback.

\begin{proposition}
The following diagram commutes:
\[
\begin{tikzcd}
\GCiso{\Res_{k'/k} \Gr(\TL)} \arrow[two heads]{r} \dar & \GCiso{\GN{T}} \dar\\
\Hom(T(L), \EEx) \arrow[two heads]{r} & \Hom(T(K), \EEx)
\end{tikzcd}
\]
\end{proposition}

\section{The transfer principle}

\David{We should add a discussion of why we care about the transfer principle.}

The techniques in this paper apply to all non-Archimdean local fields $K$ with residue field $k$, and to all algebraic tori $T$ over $K$, without placing any restrictions on the characteristic of $K$ or on the ramification of $T$. Because of this, it is natural to ask if we can compare geometrized characters of $T$ 


We recall the notion of $N$-congruent tori from \cite[\S 2]{CY}.  Suppose $T$ and $T'$
are tori over non-Archimedian local fields $K$ and $K'$, splitting over $L$ and $L'$ respectively.

\begin{definition}
 We say that $T$ and $T'$ are \emph{$N$-congruent} if there are isomorphisms
 \begin{align*}
  \alpha : \OL/\pi_K^N \OL &\to \OO{L'}/\pi_{K'}^N \OO{L'} \\
  \beta : \Gal(L/K) &\to \Gal(L'/K') \\
  \phi : X^*(T) &\to X^*(T')
 \end{align*}
 satisfying the following conditions:
 \begin{enumerate}
  \item $\alpha$ induces an isomorphism $\OK/\pi_K^N \OK \to \OO{K'}/\pi_{K'}^N \OO{K'}$,
  \item $\alpha$ is $\Gal(L/K)$-equivariant relative to $\beta$: $\alpha(\gamma x) = \beta(\gamma) \alpha(x)$
  for $\gamma \in \Gal(L/K)$ and $x \in \OL/\pi_K^N \OL$,
  \item $\phi$ is $\Gal(L/K)$-equivariant relative to $\beta$.
 \end{enumerate}
\end{definition}

One of the main results of \cite{CY} gives an isomorphism of group schemes between
$\TT_d$ and $\TT'_d$ assuming that $T$ and $T'$ are sufficiently congruent.
They define a quantity $h$ as the smallest integer so that $\pi^h$ lies in the
Jacobian ideal associated to a natural embedding of $T$ into an induced torus \cite[\S 8.1]{CY}.
They then prove the following theorem:

\begin{theorem}[{\cite[Thm. 8.5]{CY}}]
 Suppose that $T$ and $T'$ are $N$-congruent for $N > 3h$.  Then there is a canonical isomorphism
 \[
  \TT_{N-3h} \to \TT'_{N-3h}
 \]
 determined by $\alpha, \beta$ and $\phi$.
\end{theorem}

As an immediate consequence of this theorem and Theorem \ref{thm:application} we have the following corollary:

\begin{corollary}
 Suppose that $T$ and $T'$ are $N$-congruent for $N > 3h$.  Then there is a canonical equivalence of categories
 \[
  \GC(\GN{T}_{N-3h}) \to \GC(\GN{T}'_{N-3h})
 \]
 determined by $\alpha, \beta$ and $\phi$ inducing the isomorphism
 \[
  \Hom(T(K) / T(K)_{N-3h}, \EEx) \to \Hom(T'(K') / T'(K')_{N-3h}, \EEx)
 \]
\end{corollary}

%\printindex

\begin{bibdiv}
\begin{biblist}

\bib{BBD}{article}{
   author={Be{\u\i}linson, A. A.},
   author={Bernstein, J.},
   author={Deligne, P.},
   title={Faisceaux pervers},
%   language={French},
   conference={
      title={Analyse et topologie sur les espaces singuliers (I)},
      address={Luminy},
      date={1981},
   },
   book={
      series={Ast\'erisque},
      volume={100},
      publisher={Soc. Math. France},
      place={Paris},
   },
   date={1982},
%   pages={5--171},
%   review={\MR{751966 (86g:32015)}},
}

\bib{BLR}{book}{
   author={Bosch, Siegfried},
   author={L{\"u}tkebohmert, Werner},
   author={Raynaud, Michel},
   title={N\'eron models},
   series={Ergebnisse der Mathematik und ihrer Grenzgebiete (3) [Results in
   Mathematics and Related Areas (3)]},
   volume={21},
   publisher={Springer-Verlag},
   place={Berlin},
   date={1990},
%   pages={x+325},
%   isbn={3-540-50587-3},
%   review={\MR{1045822 (91i:14034)}},
}

\bib{Brandal}{book}{
 author={Brandal, Willy},
 title={Commutative Rings whose Finitely Generated Modules Decompose},
 publisher={Springer-Verlag},
 date={1979},
 series={Lecture Notes in Mathematics}
 number={723}
}

\bib{Chai}{article}{
   author={Chai, C.L.},
   title={N\'eron models for semiabelian varieties: congruence and change of base field.},
   journal={Asian J. Math.},
   volume={4},
   number={4},
   date={2000},
   pages={715--736}}
   
\bib{CY}{article}{
   author={Chai, C.L.},
   author={Yu, J.-K.},
   title={Congruences of N\'eron models for tori and the Artin conductor},
   journal={Ann. of Math.},
   volume={154},
   number={2},
   date={2001},
   pages={347-382}}

\bib{Deligne:tensorielles}{article}{
   author={Deligne, P.},
   title={Cat\'egories tensorielles},
%   language={French, with English summary},
%   note={à Yu. I. Manin, en témoignage d'admiration},
   journal={Mosc. Math. J.},
   volume={2},
   date={2002},
   number={2},
   pages={227--248},
%   issn={1609-3321},
%   review={\MR{1944506 (2003k:18010)}},
}

\bib{Deligne:Weil2}{article}{
   author={Deligne, Pierre},
   title={La conjecture de Weil. II},
%   language={French},
   journal={Inst. Hautes \'Etudes Sci. Publ. Math.},
   number={52},
   date={1980},
   pages={137--252},
%   issn={0073-8301},
%   review={\MR{601520 (83c:14017)}},
}

\bib{Greenberg:2}{article}{
   author={Greenberg, Marvin J.},
   title={Schemata over local rings. II},
   journal={Ann. of Math. (2)},
   volume={78},
   date={1963},
   pages={256--266},
%   issn={0003-486X},
%   review={\MR{0156855 (28 \#98)}},
}

\bib{SGA1a}{book}{
   author={Grothendieck, Alexander},
   title={Rev\^etements \'etales et groupe fondamental. Fasc. I: Expos\'es 1
   \`a 5},
   series={S\'eminaire de G\'eom\'etrie Alg\'ebrique},
   volume={1960/61},
   publisher={Institut des Hautes \'Etudes Scientifiques},
   place={Paris},
   date={1963},
%   pages={iv+143 pp. (not consecutively paged) (loose errata)},
%   review={\MR{0217087 (36 \#179a)}},
}

\bib{Kamgarpour}{article}{
   author={Kamgarpour, Masoud},
   title={Stacky abelianization of algebraic groups},
   journal={Transform. Groups},
   volume={14},
   date={2009},
   number={4},
   pages={825--846},
%   issn={1083-4362},
%   review={\MR{2577200 (2011b:20136)}},
%   doi={10.1007/s00031-009-9067-8},
}

\bib{Laumon}{article}{
   author={Laumon, G.},
   title={Transformation de Fourier, constantes d'\'equations fonctionnelles
   et conjecture de Weil},
%   language={French},
   journal={Inst. Hautes \'Etudes Sci. Publ. Math.},
   number={65},
   date={1987},
   pages={131--210},
%   issn={0073-8301},
%   review={\MR{908218 (88g:14019)}},
}

\bib{SGA4.5}{book}{
   author={Deligne, P.},
   title={Cohomologie \'etale},
   series={Lecture Notes in Mathematics, Vol. 569},
   note={S\'eminaire de G\'eom\'etrie Alg\'ebrique du Bois-Marie 1963-64 SGA
   4$\frac{1}{2}$; 
   Avec la collaboration de J. F. Boutot, A. Grothendieck, L. Illusie et J.
   L. Verdier},
   publisher={Springer-Verlag},
   place={Berlin},
%date={4h},
   date={1977},
%   pages={iv+312pp},
%   review={\MR{0463174 (57 \#3132)}},
}

\bib{Deligne:Weil2}{article}{
   author={Deligne, Pierre},
   title={La conjecture de Weil. II},
%   language={French},
   journal={Inst. Hautes \'Etudes Sci. Publ. Math.},
   number={52},
   date={1980},
   pages={137--252},
%   issn={0073-8301},
%   review={\MR{601520 (83c:14017)}},
}

\bib{SGA7.2}{book}{
   title={Groupes de monodromie en g\'eom\'etrie alg\'ebrique. II},
%   language={French},
 author={Deligne, P.},
 author={Katz, N.},
   series={Lecture Notes in Mathematics, Vol. 340},
   note={S\'eminaire de G\'eom\'etrie Alg\'ebrique du Bois-Marie 1967--1969
   (SGA 7 II);
   Dirig\'e par P. Deligne et N. Katz},
   publisher={Springer-Verlag},
   place={Berlin},
   date={1973},
%   pages={x+438},
%   review={\MR{0354657 (50 \#7135)}},
}

\bib{Stasinski}{article}{
   author={Stasinski, Alexander},
   title={Reductive group schemes, the Greenberg functor, and associated
   algebraic groups},
   journal={J. Pure Appl. Algebra},
   volume={216},
   date={2012},
   number={5},
   pages={1092--1101},
%   issn={0022-4049},
%   review={\MR{2875329}},
%   doi={10.1016/j.jpaa.2011.10.027},
}

\bib{Tate:thesis}{article}{
   author={Tate, J. T.},
   title={Fourier analysis in number fields, and Hecke's zeta-functions},
   conference={
      title={Algebraic Number Theory (Proc. Instructional Conf., Brighton,
      1965)},
   },
   book={
      publisher={Thompson, Washington, D.C.},
   },
   date={1967},
   pages={305--347},
   review={\MR{0217026 (36 \#121)}},
}

\bib{vdG&M}{book}{
author={van der Geer},
author={Moonen},
title={Abelian Varieties},
note={http://staff.science.uva.nl/$\sim$bmoonen/boek/BookAV.html}
}


\bib{Xarles}{article}{
   author={Xarles, Xavier},
   title={The scheme of connected components of the N\'eron model of an algebraic torus},
   journal={J. Reine Angew. Math.},
   volume={437},
   date={1993},
   pages={167--179},
%   issn={0075-4102},
%   review={\MR{1212256 (94d:14044)}},
%   doi={10.1515/crll.1993.437.167},
}


\bib{Yu}{article}{
   author={Yu, Jiu-Kang},
   title={Smooth models associated to concave functions in Bruhat-Tits theory}
}

\end{biblist}
\end{bibdiv}

\end{document}