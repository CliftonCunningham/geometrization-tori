\documentclass[10pt]{amsart}

\title[Commutative Character Sheaves]{Commutative Character Sheaves, with an application to generic types for supercuspidal representations}
\author{Clifton Cunningham}
\address{Department of Mathematics and Statistics, University of Calgary, 2500 University Drive Northwest, Calgary, AB, Canada, {T2N~1N4}.}
\email{cunning@math.ucalgary.ca}
\author{David Roe}
\address{Department of Mathematics, University of Pittsburgh, 301 Thackeray Hall, Pittsburgh, PA , United States, 15260.}
\email{roed.math@gmail.com}

\subjclass[2010]{14F05 (primary), 14L15 (secondary), 22E50 (tertiary)}
\keywords{character sheaves}

\usepackage{amssymb}
\usepackage{amsrefs}
% Fonts
\usepackage{mathrsfs}
% Enumitem
\usepackage{enumitem}
% Hyperrefs
\usepackage{hyperref}

\usepackage{tikz}
\usetikzlibrary{shapes,arrows,calc,matrix}
\usepackage{tikz-cd}

%%%%%%%%%%%%%%% THEOREM STYLES %%%%%%%%%%%%%%%
\theoremstyle{plain}
      \newtheorem{theorem}{Theorem}[section]
      \newtheorem*{theorem*}{Theorem}
      \newtheorem{proposition}[theorem]{Proposition}
      \newtheorem{lemma}[theorem]{Lemma}
      \newtheorem{corollary}[theorem]{Corollary}

      \theoremstyle{definition}
      \newtheorem{definition}[theorem]{Definition}

      %\theoremstyle{remark}
      \newtheorem{remark}[theorem]{Remark}
      \newtheorem{example}[theorem]{Example}
      
%%%%%%%%%%%%%%% RINGS AND GROUPS %%%%%%%%%%%%%%%
\newcommand{\FF}{{\mathbb{F}}}
\newcommand{\ZZ}{{\mathbb{Z}}}
\newcommand{\NN}{{\mathbb{N}}}
\newcommand{\CC}{{\mathbb{C}}}
\newcommand{\QQ}{{\mathbb{Q}}}
\newcommand{\RR}{{\mathbb{R}}}
\newcommand{\EE}{\mathbb{\bar Q}_\ell}
\newcommand{\OK}{\mathcal{O}_K}
\newcommand{\OL}{\mathcal{O}_L}
\newcommand{\OO}[1]{\mathcal{O}_{#1}}
\newcommand{\bFq}{\bar{k}}
\newcommand{\Fq}{k}
\newcommand{\Fqm}{k_m}
\newcommand{\EEx}{\EE^\times}
\newcommand{\ZEx}{\mathbb{\bar Z}_\ell^\times}
\newcommand{\Weil}[1]{\mathcal{W}_{#1}}
\newcommand{\m}{{\mathfrak{m}}}
%%%%%%%%%%%%%%% ALGEBRAIC GROUPS %%%%%%%%%%%%%%%
\newcommand{\Gm}[1]{\mathbb{G}_{\hskip-1pt\textbf{m},#1}}
\DeclareMathOperator{\GL}{GL}
\newcommand{\comp}{\Pi} % Component group
\newcommand{\G}{\textbf{G}}
%%%%%%%%%%%%%%% NAMED OPERATORS %%%%%%%%%%%%%%%
\DeclareMathOperator{\Gal}{Gal}
\newcommand{\Frob}[1]{\operatorname{Fr}_{#1}}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\ord}{ord}
\DeclareMathOperator{\coker}{coker}
\DeclareMathOperator{\Gr}{Gr}
\DeclareMathOperator{\Irrep}{Irrep}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\Ext}{Ext}
\DeclareMathOperator{\Hh}{H}
\DeclareMathOperator{\Res}{Res}
\DeclareMathOperator{\Nm}{Nm}
\DeclareMathOperator{\trace}{Tr}
\DeclareMathOperator{\obj}{obj}
\DeclareMathOperator{\mor}{mor}
\DeclareMathOperator{\Lang}{Lang}
\DeclareMathOperator{\image}{im}
\DeclareMathOperator{\Loc}{Loc}
\DeclareMathOperator{\Tot}{Tot}
\DeclareMathOperator{\Tor}{Tor}
\DeclareMathOperator{\SL}{SL}
\DeclareMathOperator{\PGL}{PGL}
\newcommand{\gal}[1]{{\operatorname{Gal}\hskip-1pt\left( {\bar #1}/#1 \right)}}
\newcommand{\Spec}[1]{{\operatorname{Spec}(#1)}}
\newcommand{\op}{_{\operatorname{op}}}
\newcommand{\der}{_{\operatorname{der}}}
\newcommand{\ab}{_{\operatorname{ab}}}

%%%%%%%%%%%% MISCELLANEOUS OPERATORS %%%%%%%%%%%%
\newcommand{\sheafHom}{{\mathscr{H}\hskip-4pt{\it o}\hskip-2pt{\it m}}}
\newcommand{\abs}[1]{{\vert #1 \vert}}
\newcommand{\ceq}{{\, :=\, }}
\newcommand{\tq}{{\ \vert\ }}
\newcommand{\iso}{{\ \cong\ }}
\newcommand{\trFrob}[1]{t_{#1}}
\newcommand{\TrFrob}[1]{\operatorname{Tr}_{#1}}
%% Limits
\newcommand{\invlim}[1]{\lim\limits_{\overleftarrow{#1}}}
\newcommand{\dirlim}[1]{\lim\limits_{\overrightarrow{#1}}}
\newcommand{\limit}[1]{\mathop{\textsc{lim}}\limits_{#1}}
\newcommand{\colimit}[1]{\mathop{\textsc{colim}}\limits_{#1}}
%% Fonts for quasicharacter sheaves
\newcommand{\cs}[1]{{\mathcal{#1}}}
\newcommand{\gcs}[1]{{\mathcal{\bar #1}}}
\newcommand{\dualgcs}[1]{\gcs{#1}^\dagger}
\newcommand{\dualcs}[1]{\cs{#1}^\dagger}
%% Categories
\newcommand{\CS}{{\mathcal{C\hskip-0.8pt S}}}
\newcommand{\CCS}{{\mathcal{C\hskip-.8pt C\hskip-0.8pt S}}}
\newcommand{\bCS}{{\CS_0}}
\newcommand{\catname}[1]{\normalfont{\textsf{#1}}}
\newcommand{\Sch}[1]{{\catname{Sch}_{/#1}}}
\newcommand{\QCS}{{\mathcal{QC\hskip-0.8pt S}}}
\newcommand{\CSiso}[1]{\CS(#1)_{/\text{iso}}}
\newcommand{\bCSiso}[1]{\bCS(#1)_{/\text{iso}}}
\newcommand{\QCSiso}[1]{\QCS(#1)_{/\text{iso}}}
\newcommand{\CCSiso}[1]{\CCS(#1)_{/\text{iso}}}
%% Labeled items
\makeatletter
\newcommand{\labitem}[2]{
\def\@itemlabel{\textbf{#1}}
\item
\def\@currentlabel{#1}\label{#2}}
\makeatother
%% Shorthand for bars
\renewcommand{\bf}{\bar{f}}
\newcommand{\bg}{{\bar{g}}}
\newcommand{\bm}{\bar{m}}
\newcommand{\bG}{\bar{G}}
\newcommand{\bH}{\bar{H}}
\newcommand{\brho}{{\bar\rho}}
\newcommand{\bx}{{\bar{x}}}
%% Spacing control
\newcommand{\tight}[3]{\hspace{-#1pt}{#2}\hspace{-#3pt}}
\newcommand{\GxG}{\text{$G \tight{1}{\times}{1} G$}}
\newcommand{\bGxG}{\text{$\bar{G} \tight{1}{\times}{1} \bar{G}$}}
\newcommand{\bfxf}{\text{$\bar{f} \tight{1}{\times}{1} \bar{f}$}}
\newcommand{\GxxG}{\text{$G \tight{1}{\times}{1} G$}}
\newcommand{\LxL}{\text{$\gcs{L} \tight{0}{\boxtimes}{0} \gcs{L}$}}

%% Hyphenation override
\hyphenation{quasi-character}

%%%%%%%%%%%% BEGIN DOCUMENT %%%%%%%%%%%
\usepackage{todonotes}

\begin{document}

\begin{abstract}
We introduce and establish the basic properties of  the category of \emph{commutative character sheaves} on smooth group schemes $G$ over finite fields $\Fq$. 
We use this category to geometrize all generic types for supercuspidal representations of $p$-adic groups. 
\end{abstract}

\maketitle

\section*{Introduction}
We introduce and establish the basic properties of  the category of \emph{commutative character sheaves} on smooth group schemes $G$ over finite fields $\Fq$. 
Expanding on work by the same authors, we show that all character sheaves on $G\ab$ are commutative, when $G\ab$ is connected and of finite type.
We give three applications.
First, we use commutative character sheaves to produce a functorial geometrization of characters of $G(\Fq)$ in all cases, thus repairing a defect in the function-sheaf dictionary for algebraic groups $G$ which appears when the component group of $G$ is $\Hh^2(\pi_0(\bG),\EEx)^{\Frob{}}$ is non-trivial. 
Second, we revisit the motivations for the stacky abelianization construction, and show that, after replacing the character sheaves on $G$ with commutative character sheaves on $G$, the schematic abelianization $G \to G\ab$ is the correct quotient.
This is an immediate consequence of the fact that the category of commutative character sheaves on $G$ is equivalent to the category of commutative character sheaves on $G\ab$. 
Finally, we provide a geometrization of generic types for supercuspidal representations of connected reductive linear algebraic groups over local fields.
This last application puts all the ingredients needed to parametrize supercuspidal representations of arbitrary depth in the same category: perverse sheaves on group schemes over finite fields.




Fragments: 
The additional condition distinguishing which character sheaves on $G$ are commutative, has several benefits, as we will see in this note.
\begin{enumerate}
\labitem{(1)}{b1}
A character sheaf $\cs{L}$ on $G$ is invisible if and only if $\cs{L}$ is not commutative.
Recall from \cite{cunningham-roe:13a}*{Def. 2.8} that a character sheaf $\cs{L}$ in $G$ is {\it invisible} if $\cs{L}  \ncong \EE$ yet $\trFrob{\cs{L}} =1$.
These are exactly the non-trivial character sheaves in the kernel of the surjective group homomorphism 
\[
\TrFrob{G} : \CSiso{G} \to G(\Fq)^*
\]
 given by the trace of Frobenius.
\labitem{(2)}{b2}
This note shows that $\TrFrob{G} : \CSiso{G} \to G(\Fq)^*$ admits a canonical section, and thus a splitting of the short exact sequence 
\[
\begin{tikzcd}
0 \arrow{r} & \Hh^2(\pi_0(\bG),\EEx)^{\Weil{}} \arrow{r} & \CSiso{G} \arrow{r}{\TrFrob{G}} & G(\Fq)^* \arrow{r} & 0
\end{tikzcd}
\]
found in \cite{cunningham-roe:13a}*{Thm. 3.6}.
\labitem{(3)}{b3}
Like the category $\CS(G)$ of character sheaves on $G$, which described completely in \cite{cunningham-roe:13a}, $\CCS(G)$ is a rigid monoidal category.
Since $\CCS(G)$ is a full subcategory of $\CS(G)$, and since Item \ref{b2} above shows $\CCSiso{G} \iso G(\Fq)^*$, canonically, the category $\CCS(G)$ is now completely described by the following consequence of \cite{cunningham-roe:13a}*{Thm. 3.9}: in $\CCS(G)$, every morphism $\cs{L} \to \cs{L}'$ is either trivial (zero on stalks) or and isomorphism, and
\[
\Aut(\cs{L}) \iso  \Hh^1(\pi_0(\bG), \EEx)^{\Weil{}}.
\]
Consequently, we have a complete description of category $\CCS(G)$.
\end{enumerate}




\section{Definitions and Recollections}

Let $G$ be a smooth group scheme over a finite field $\Fq$; that is, let $G$ be a group scheme over $\Fq$
for which the structure morphism $G \to \Spec{\Fq}$ is smooth in the sense of [include reference for this definition].
This implies $G \to \Spec{\Fq}$ is locally of finite type, but not that it is of finite type.
We remark that the identity component $G^0$ of $G$ is of finite type over $\Fq$, while the component group scheme
$\pi_0(G)$ of $G$ is an \'etale group scheme over $\Fq$, and both are smooth over $\Fq$.

Write $m : G \times G \to G$ for the multiplication morphism.
Let $\theta : G\times G \to G\times G$ be given by $\theta(g,h) = (h,g)$
and define $m\op : G \times G \to G$ by $m\op = m \circ \theta$.
For any local system $\gcs{L}$ on $\bG \ceq G \times_{\Spec{\Fq}} \Spec{\bFq}$ there is an isomorphism
$\vartheta : \LxL \to {\bar \theta}^*(\LxL)$ given on stalks by the canonical map
$\gcs{L}_{g} \otimes \gcs{L}_{h} \to \gcs{L}_{h} \otimes \gcs{L}_{g}$.

Recall \cite{cunningham-roe:13a}*{Def. 1.1} that a character sheaf on $G$ is a triple $\cs{L} \ceq (\gcs{L}, \mu, \phi)$,
where $\gcs{L}$ is a rank-one $\ell$-adic local system on $\bG$, $\mu : \bm^* \gcs{L} \to \LxL$ is an isomorphism
of sheaves on $\bG \times \bG$, and $\phi : \Frob{G}^* \gcs{L} \to \gcs{L}$ is an isomorphism of sheaves on $\bG$.
In \emph{loc. cit.}, $G$ was assumed to be commutative, but the same definition makes sense for non-commutative $G$.
We will denote the category of character sheaves on $G$ by $\CS(G)$.
\todo{I think we should hold the term `character sheaves for G', when $G$ is not commutative, in reserve, and not use it here for non-commutative $G$. So I might advocate going back to the full definition here. Or, we might introduce the term `rank-$1$ character sheaf, similar to what Masoud did  . . . \\ -CC}

\begin{definition}\label{def:CCS}
A character sheaf on $G$ is \emph{commutative} if there is an isomorphism ${\bar m}^* \gcs{L} \to {\bar m}\op^* \gcs{L}$
such that the following diagram commutes,
  \[
  \begin{tikzcd}[row sep=30]
   \bm^*\gcs{L} \arrow{d} \arrow{r}{\mu} & \LxL \arrow{d}{\vartheta}\\
   \bm\op^*\gcs{L} \arrow{r}{{\bar \theta}^*\mu} &  {\bar \theta}^*(\LxL)
  \end{tikzcd}
  \]
 Write $\CCS(G)$ for the full subcategory of $\CS(G)$ consisting of commutative character sheaves.
 \end{definition}
 

\begin{lemma}
If the isomorphism ${\bar m}^* \gcs{L} \to {\bar m}\op^* \gcs{L}$ exists, then it is unique.
\end{lemma}
\begin{proof}
\end{proof}

\begin{proposition}
Every commutative character sheaf on $G$ is equivariant for the conjugation action of $G$ on $G$. Conversely, if a [rank-$1$] character sheaf on $G$ is equivariant for conjugation, then $G$ is commutative. 
\end{proposition}

\begin{proof}
Let $a : G \times G \to G$ be the conjugation action of $G$ on $G$. Then $a = m \circ (m \times (\iota \circ p_1))$ while $m\op \circ (m \times (\iota \circ p_1)) = p_2$. Thus, if $m^*\cs{L} \iso m\op^*\cs{L}$ then
\begin{align*}
a^* \cs{L} 
&= (m \circ (m \times (\iota \circ p_1)))^* \cs{L}\\
&= (m \times (\iota \circ p_1))^* m^* \cs{L}\\
&\iso (m \times (\iota \circ p_1))^* m\op^* \cs{L}\\
&= (m\op \circ (m \times (\iota \circ p_1)))^* \cs{L}\\
&= p_2^*\cs{L}.
\end{align*}
Since the isomorphism $a^*\cs{L} \iso p_2^*\cs{L}$ is unique, $(\cs{L}, a^*\cs{L} \iso p_2^*\cs{L})$ is an equivariant commutative character sheaf.

Conversely, let $(\cs{L}, a^*\cs{L} \iso p_2^*\cs{L})$ be an equivariant [rank-$1$] character sheaf.
Observe that $m = a \circ (p_1\times m\op)$ while $p_2 \circ (p_1\times m\op) = m\op$. Thus, 
\begin{align*}
m^* \cs{L} 
&= (a \circ (p_1 \times m\op))^* \cs{L}\\
&= (p_1 \times m\op)^* a^* \cs{L}\\
&\iso (p_1 \times m\op)^* p_2^* \cs{L}\\
&= (p_2\circ (p_1 \times m\op))^* \cs{L}\\
&= m\op^* \cs{L}.
\end{align*}
Thus, $\cs{L}$ is a commutative character sheaf.
\end{proof}


\section{Eliminating Invisible Character Sheaves}\label{sec:defect}

If $M$ is a $\bG$-module, then we say a cohomology class in $\Hh^2(\bG, M)$ is \emph{symmetric} if it is represented
by a symmetric $2$-cocycle.  Since every coboundary is symmetric, either all cocycles in a given class will be symmetric
or none will.

\begin{lemma} \label{lem:symtriv}
Let $\bG$ be a commutative group.  Then the only symmetric class in $\Hh^2(\bG, \EEx)$ is the trivial class.
\end{lemma}

\begin{proof}
By the universal coefficient theorem,
\[
0 \to \Ext^1_\ZZ(\Hh_{n-1}(\bG, \ZZ), \EEx) \to \Hh^n(\bG, \EEx) \to \Hom(\Hh_n(\bG, \ZZ), \EEx) \to 0
\]
for all $n > 0$.  When $n = 2$, using the fact that $\bG$ is commutative, we have that $\Hh_1(\bG, \ZZ) \cong \bG$
and that $\Hh_2(\bG, \ZZ) \cong \wedge^2 \bG$. We get
\[
0 \to \Ext^1_\ZZ(\bG, \EEx) \to \Hh^2(\bG, \EEx) \to \Hom(\wedge^2 \bG, \EEx) \to 0.
\]
The map $\Hh^2(\bG, \EEx) \to \Hom(\wedge^2 \bG, \EEx)$ maps a $2$-cocycle $f$ to the alternating function
\[
(x,y) \mapsto \frac{f(x,y)}{f(y,x)}.
\]
Thus the cohomology classes represented by symmetric cocycles are precisely those in the image of $\Ext^1_\ZZ(\bG, \EEx)$.
But $\Ext^1_\ZZ(-, \EEx)$ vanishes because $\EEx$ is divisible.
\end{proof}

For a character sheaf $\cs{L}$ on $G$, recall from \cite{cunningham-roe:13a}*{\S 2.3} that $S_G : \CSiso{G} \to \Hh^2(E_G^\bullet)$ maps
$[\cs{L}]$ to $[\alpha \oplus \beta]$, where $E_G^\bullet$ is the total space of the zeroth page
of the Hochschild-Serre spectral sequence, $\alpha \in C^0(\Weil{}, C^2(\bG, \EEx))$ is obtained from $\mu$ and
$\beta \in C^1(\Weil{}, C^1(\bG, \EEx))$ is obtained from $\phi$.

\begin{lemma} \label{lem:conncomm}
If $G$ is a connected commutative algebraic group over $\Fq$ then every character sheaf on $G$ is commutative.
\end{lemma}

\begin{proof}
We can use \'etale descent to see that pullback by the Lang isogeny defines an equivalence
of categories between local systems on $G$ and $G(\Fq)$-equivariant local systems on $G$.  Thus every character
sheaf on $G$ arises through the Lang isogeny; since the covering group is $G$ itself, which is commutative,
every character sheaf on $G$ is commutative.
\end{proof}

\begin{theorem} \label{thm:trfrobiso}
If $G$ is a smooth commutative group scheme over $\Fq$ then $\TrFrob{G} : \CCSiso{G} \to G(\Fq)^*$ is an isomorphism.
\end{theorem}

\begin{proof}
Suppose first that $G$ is \'etale.  Consider the isomorphism of short exact sequences
\[
\begin{tikzcd}
 0 \arrow{r} & \ker \TrFrob{G} \arrow{d} \arrow{r} & \CSiso{G}\arrow{d}{S_G} \arrow{r}{\TrFrob{G}} \arrow{r} & G(\Fq)^* \arrow{d} \arrow{r} & 0\\
  0 \arrow{r} & \Hh^0(\Weil{},\Hh^2(\bG,\EEx)) \arrow{r} & \Hh^2(E^\bullet_G) \arrow{r} & \Hh^1(\Weil{},\Hh^1(\bG,\EEx)) \arrow{r} & 0
 \end{tikzcd}
 \]
from \cite{cunningham-roe:13a}*{Prop. 2.7}.

Suppose that $\cs{L}$ is a commutative character sheaf
with $\trFrob{\cs{L}} = 1$.  Then $S_G([\cs{L}])$ is in the image of $\Hh^2(\bG, \EEx)^\Weil{}$, so is cohomologous to
$[\alpha', 0]$.  Since $\alpha$ is symmetric and coboundaries are symmetric, $\alpha'$ is symmetric as well.
So by Lemma \ref{lem:symtriv}, $\alpha'$ is cohomologically trivial, and thus $[\cs{L}]$ is trivial as well.

To see that $\TrFrob{G}$ is still surjective on $\CCSiso{G}$, note that the character sheaf constructed in the proof of
\cite{cunningham-roe:13a}*{Prop. 2.6} has trivial $\alpha$, and is thus commutative.

For general smooth commutative group schemes, we use Lemma \ref{lem:conncomm} and the snake lemma.
\end{proof}

\begin{remark}
Since $\Hh^0(\Weil{},\Hh^2(\bG,\EEx))$ is not necessarily trivial \cite{cunningham-roe:13a}*{Ex. 2.10}, the functor
$\CCS(G) \to \CS(G)$ is not an equivalence of categories in general.
\end{remark}

\section{Descent to the abelianization}
  
Let $G$ be a smooth group scheme.
Let $j: G\der \hookrightarrow G$ denote the closed subgroup generated by the commutator morphism $c: G\times G \to G$ given by $c(x,y) = xyx^{-1}y^{-1}$; see \cite{SGA3}*{{VI}$_B$, 7.2}.
Let $n : G\der \times G \to G$ be the restriction of $m: G\times G \to G$.

\begin{lemma}\label{lem:Lder}
For every $\cs{L}$ on $G$, $\cs{L}\vert_{G\der} \iso (\EE)_{G\der}$.
\end{lemma}

\begin{proof}
By construction, $c : G \times G \to G$ is schematically dense (dominant morphism) for $j : G\der \hookrightarrow G$. 
Note that $j\circ c = m\circ (m \times (\iota\circ m\op)) : G \times G \to G$ is $(g,h) \mapsto gh g^{-1}h^{-1}$ while $m\op\circ (m \times (\iota\circ m\op))= e : G \times G \to G$ is $(g,h) \mapsto 1_G$. Thus,
\begin{align*}
c^* (\cs{L}\vert_{G\der})
&=  (j\circ c)^*\cs{L} \\
&= (m\circ (m \times (\iota\circ m\op)))^* \cs{L} \\
&= (m \times (\iota\circ m\op))^* m^* \cs{L} \\
&\iso (m \times (\iota\circ m\op))^* m\op^* \cs{L} \\
&= (m\op\circ (m \times (\iota\circ m\op)))^* \cs{L} \\
&= e^* \cs{L}\\
&= (\EE)_{G\times G}.
\end{align*}
Since $c : G \times G \to G\der$ is schematically dense, the group homomorphism $\pi_1(G\times G, {\bar y}) \to \pi_1(G\der, {\bar x})$ is surjective, for all geometric points with $c({\bar y}) = {\bar x}$. It follows that $c^* (\cs{L}\vert_{G\der}) \iso (\EE)_{G\times G}$ implies $\cs{L}\vert_{G\der} \iso (\EE)_{G\der}$. 
\end{proof}

\begin{lemma}\label{lem:smooth_coeq}
The quotient $q : G \to G\ab\ceq G/G\der$ is a smooth $G\der$-torsor and is the coequalizer of $n : G\der \times G \to G$ with projection $p: G\der \times G \to G$. 
\[
\begin{tikzcd}
G\der\times G
 \arrow{r}[shift left]{n}
  \arrow{r}[shift right,swap]{p}
&
G 
\arrow{r}{q}
& 
G\ab
\end{tikzcd}
\]
\end{lemma}

\begin{proposition}\label{prop:Gder-equivariance}
$\CCS_{G\der}(G) \to \CCS(G)$ is an equivalence.
\end{proposition}

\begin{proof}
It follows from Lemma~\ref{lem:Lder} that the forgetful functor $\CCS_{G\der}(G) \to \CCS(G)$ is an equivalence. To see this, we observe that
every commutative character sheaf $\cs{L}$ on $G$ is equivariant for the left translation action of $C$ on $G$, as follows.
Let $j : C \hookrightarrow G$ be the kernel of $q : G \to G\ab$ and let $m : G\times G \to G$ be multiplication for $G$. 
Then $n = m \circ (j \times \id)$, so
\begin{align*}
n^* \cs{L} 
&= (m \circ (j \times \id))^* \cs{L}\\
&= (j \times \id))^* m^*\cs{L}\\
&\iso (j \times \id))^* (\cs{L} \boxtimes \cs{L})\\
&= (j^*\cs{L}) \boxtimes \cs{L}\\
&= (\cs{L}\vert_C) \boxtimes \cs{L}\\
&= (\EE)_C \boxtimes \cs{L}\\
&= p^* \cs{L}.
\end{align*}
Thus, $\cs{L}$ is $G\der$-equivariant.
\end{proof}

\begin{theorem}\label{thm:descent}
 Let $G$ be a smooth group scheme over $\Fq$ 
 and let $q : G \to G\ab$ be its abelianization. 
 Then  
\[
q^*:  \CCS(G\ab) \longrightarrow \CCS(G)
\]
is an equivalence of rigid monoidal categories.
\end{theorem}

\begin{proof}
It follows from Lemma~\ref{lem:smooth_coeq} that $q$ is an 
effective descent morphism for the fibred category of commutative character sheaves on smooth group schemes; in other words, the canonical functor $\CCS(G) \to \CCS_{G\der}(G)$ is an equivalence. 
\todo{$\CCS \to \Sch{\Fq}$ is a fibred category. Is it also a stack?}
See appendix for details.
%
Combining this with Proposition~\ref{prop:Gder-equivariant}, it follows that $q^* : \CCS(G\ab)\to \CCS(G)$ is an equivalence.
\end{proof}

\begin{remark}
A great tragedy of nomenclature: an equivariant sheaf is not a sheaf that is equivariant. \todo{I will explain this.\\ -CC} 
\end{remark}


 \begin{corollary}
 Trace of Frobenius induces an isomorphism
 \[
 \CCSiso{G} \to G(\Fq)^*.
 \]
 \end{corollary}
 
 \begin{proof}
 By descent along $G \to G/C$, pullback induces an equivalence of categories between $C$-equivariant local systems on $G$ local systems on  $G/C$. \todo{I need to explain what's going on here. See appendix.\\ -CC}
  The result now follows from Theorem \ref{thm:trfrobiso} and the fact that all characters of $G(\Fq)$ factor through
 $G(\Fq)/C(\Fq)$, which equals $(G/C)(\Fq)$ since $C$ is simply connected.
 \end{proof}
 
\subsection{Stacky abelianization, revisited}
 
 Talk about relationship with \cite{kamgarpour:09a}.  In particular, explain why the character sheaf corresponding
 to the cover
 \[
 1 \to \mu_n \to \SL_n \to \PGL_n \to 1
 \]
 is not commutative.  Explain how our character sheaves are not just representations of a fundamental group
 (or are they?), but instead have extra data like $\mu$ and $\phi$.
\todo{I got this wrong. I think our sheaves are not extra information in the commutative case. Masound's definition is designed to match the definition coming from central extensions, while we have one that matches Ext1 in Ab, in the connected case. So, I think the modification is easy: add mop to diagram 2.4 in Masoud's paper. \\ -CC}

\section{Geometrization of generic types for supercuspidal representations}


Let $K$ be a local field with residue field $\Fq$.
Let $\underline{G}$ be a smooth group scheme over $K$.
Set $G_n = \Gr^R_n(\underline{G})$; this is a smooth group scheme over $\Fq$.
Set $G = \Gr^R_n(\underline{G})$; this is a group scheme over $\Fq$ equipped with $G = \varprojlim_{n\in \NN} G_n$.
Let $\QCS(\underline{G})$ be the category of commutative character sheaves on $G$. . . .  as in \cite{cunningham-roe:13a}.

\begin{corollary}\label{cor:QCS}
$\Hom(\underline{G}(\OK),\EEx) \iso \QCSiso{\underline{G}}$.
\end{corollary}

 


As proved in \cite{kim:07a}, many (complex) supercuspidal representations of $p$-adic groups can be built from the generic data of \cite{yu:01a}*{\S 15} and, moreover, the type (in the sense of \cite{bushnell-kutzko:98a}) of the resulting supercuspidal representations can be constructed directly from the generic data. 
Let us refer to the types arising in this manner as {\it generic types}.
In this section we show that, after fixing an isomorphism $\CC \approx \EE$, every generic type is geometrizable, in the sense that every part of generic type admits a description as a perverse sheaf, from which the type can be recovered.

Let $K$ be a $p$-adic field. Let $\G$ be a connected reductive linear algebraic group over $K$. 
A generic datum is a triple $(\vec{\G}, \pi_0, \vec{\phi})$ where: $\vec{\G}$ is a tower of $p$-adic groups $\G^0(K) \subset \G^1(K) \subset \cdots  \subset \G^d(K) = \G(K)$ (proper containment); $\pi_0$ is a depth-zero representation of $\G^0(K)$, and $\vec{\phi} = (\phi_0, \ldots , \phi_{d-1})$ where each $\phi_i : \G^i(K) \to \EEx$ is a quasicharacter (continuous group homomorphism).  

%The generic datum $(\vec{\G}, \pi_0, \vec{\phi})$ determines a type (in the sense of \cite{bushnell-kutzko:98a}) $(C, \rho)$ for $\G$, as explained in \cite{yu:construction}*{\S 15}, where $C \subset \G(K)$ is compact mod centre subgroup and $\rho$ is a representation of $C$. In \cite{yu:smooth} it is shown that the $C$ admits a smooth integral model, in the sense that there is a smooth group scheme $\underline{C}$ over $\OK$ such that $\underline{C}(\OK) = C$.

In \cite{yu:03a} it is shown that, for $0 \leq i < d$, the $p$-adic group $\G^i(K)$ admits a smooth integral model, in the sense that there is a smooth group scheme $\underline{G}^i$ over $\OK$ such that $\underline{G}^i(\OK) = \G^i(K)$.
Set $G^i_n \ceq \Gr^R_n(\underline{G}^i)$ and $G^i \ceq \Gr_R(\underline{G}^i)$; 
then \[G^i(\Fq) = \G^i(K)\] (canonical isomorphism of groups).
In this way, $\vec{\G}$ determines a tower $\vec{G}$ of group schemes $G^0 \subset G^1 \subset \cdots  \subset G^{d-1}$ (proper containment) over $\Fq$, from which the tower of $p$-adic groups
$\G^0(K) \subset \G^1(K) \subset \cdots  \subset \G^{d-1}(K)$ can be recovered.

Using Corollary~\ref{cor:QCS} we see that each quasicharacter $\phi_i : G^i(\Fq) \to \EEx$ determines a quasicharacter sheaf $\cs{L}^i$, unique up to isomorphism, from which the quasicharacter $\phi_i$ can be recovered using the trace of Frobenius. 
In fact, more is true. Let $n_{\phi_i}$ be the smallest non-negative integer $n$ such that $\phi_i : G^i(\Fq) \to \EEx$ factors through $G^i(\Fq) \to G^i_n(\Fq)$.
Then $\phi_i$ determines a commutative character sheaf $\cs{L}_{n_{\phi_i}}^i$, unique up to isomorphism, from which the quasicharacter $\phi_i$ can be recovered.
Then $\cs{A}_i\ceq \cs{L}_{n_{\phi_i}}^i[\dim G_{n_{\phi_i}}^i]$ is a perverse sheaf on $G_{n_{\phi_i}}^i$ from which the quasicharacter $\phi_i$ can be recovered.
In this way,  $\vec{\phi} = (\phi_0, \ldots , \phi_{d-1})$ determines perverse sheaves $\vec{\cs{A}} = (\cs{A}_0, \ldots , \cs{A}_{d-1})$ from which $\vec{\phi}$ can be recovered. 

Finally, consider the depth-zero supercuspidal representation $\pi_0$ of $\G^0(K)$.
Then $\pi_0$ is produced by compact induction from representation $\sigma$ of a compact mod centre subgroup $\underline{C}_0(\OK) \subset \G^0(K)$. Moreover, $C_0$ admits a smooth integral model $\underline{C}$ \todo{Under construction. \\ -CC}

\appendix

\section{Descent along smooth fibrations}

Let $G$ be a group scheme acting on $X$ by $m : G \times X \to X$.

A principal $G$-bundle $f : X\to Y$ is a coequalizer of $m$ and projection $G\times X \to X$  
which is locally trivial in the following sense.
First, there is an open covering $\{ V_n\}$ of $Y$ such that, for each $V$ in this covering, the lower coequalizer diagram is a base change of the one above
\[
\begin{tikzcd}
G\times X
 \arrow{rr}[shift left]{m}
  \arrow{rr}[shift right,swap]{\text{proj'n}}
&& X \arrow{r}{f} &  Y\\
G\times  (G\times V) \arrow{u}
 \arrow{rr}[shift left]{\text{mult'n in $G$}}
  \arrow{rr}[shift right,swap]{\text{proj'n}}
&& G\times V \arrow{u}  \arrow{r} &  \arrow{u} V;
\end{tikzcd}
\]

and the following diagram commutes
\[
\begin{tikzcd}
G\times  f^{-1}(V)
 \arrow{r}[shift left]{m}
  \arrow{dr} 
& f^{-1}(V) \arrow{r} \arrow{d}{t_V} &  V \\
& G\times V \arrow{ur} & 
\end{tikzcd}
\]


and isomorphisms ${t}_n : f^{-1}{V}_n \to {G}\times {V}_n$ such that  ${f}$ is given locally by ${f}_n = p \circ {t}_n$ (so ${f}_n : {f}^{-1}{Y}_n \to {Y}_n$) and the action ${m}_{X}$ of ${G}$ on ${X}$ is given locally by ${t}_n \circ {m}_n =  ({m} \times \id) \circ (\id\times{t}_n)$ (so ${m}_n : {G}\times{f}^{-1}{Y}_n \to {f}^{-1}{Y}_n$). 

Let $\Loc^1(X)$ be the category of rank-$1$ local systems on $X$ and let $\Loc_G^1(X)$ be the category of $G$-equivariant rank-$1$ local systems on $X$.

\begin{proposition}
Let $G$, $X$ and $Y$ be smooth.
Let $f : X \to Y$ be a $G$-torsor.
Then the comparison functor, pictured below,
\[
\begin{tikzcd}
%\Loc^1(G \times X)
%& \arrow{l}[shift left,swap]{m^*}
%  \arrow{l}[shift right]{p^*}
\Loc^1(X) 
&&\arrow{ll}[swap]{f^*} 
\Loc^1(Y) \arrow{dl}{\text{comparison}}\\
& \arrow{ul}{\text{forget}} \Loc^1_G(X) & 
\end{tikzcd}
\]
is an equivalence.
\end{proposition}

\begin{proof}
This is well-known. We include a proof only for completeness.

To simplify notation slightly, set ${X}_n \ceq {f}^{-1}{Y}_n$; also, let ${j}_n : {Y}_n \to {Y}$ and ${i}_n : {X}_n \to {X}$ denote inclusions.

Then $f : X \to Y$ is a smooth, regular epimorphism with kernel pair $m, p: G\times X\to X$, and t

Consider the following commuting diagram:
\[
\begin{tikzcd}
H\times X \arrow{d}{\id\times f} \arrow{r}{m_X}&\to X\arrow{d}{f}\\
H\times Y \arrow{r}{m_Y} &\to Y\\
H\times X \arrow{r}{p_2} \arrow{u}{\id\times f} &\to X \arrow{u}{f}
\end{tikzcd}
\]
Thus,
\[
\begin{aligned}
m_X^*[\dim H] f^*[d] A
&\iso (f\circ m_X)^* [d+\dim H]A  &\\
&\iso (m_Y\circ (\id\times f))^*[d+\dim H]A & \text{$f$ is equivariant}\\
&\iso (\id\times f)^*[d] m_Y^*[\dim H] A &\\
&\iso  (\id\times f)^*[d] p_2^*[\dim H] A &\text{$A$ is $H$-equivariant}\\
&\iso  (p_2\circ (\id\times f))^*[d+\dim H] A &\\
&\iso (f\circ p_2)^*[d+\dim H]A & \\
&\iso p_2^*[\dim H] f^*[d]A. &
\end{aligned}
\]
This completes the proof that $f^*[d]A$ is an $H$-equivariant perverse sheaf on $X$.

Let $\mathcal{F} = {f}^*[\dim{P}] \mathcal{G}$. 

To show that $\mathcal{F}$ is equivariant we must find an isomorphism $\mu : {m}^* \mathcal{F} \to p^* \mathcal{F}$ in $D^b_c({P}\times{X}, \EE)$ such that ${e}^*\mu = \id_{\mathcal{F}}$, where ${e} : {X} \to {P}\times{X}$ is the section defined by $x \mapsto (1,x)$. To see this, consider the restriction of ${m}^* \mathcal{F}$ to ${P}\times{X}_n$:
\begin{eqnarray*}
({m}^* \mathcal{F})\vert_{{P}\times {X}_n}
	&=& (\id\times {i}_n)^* {m}^* {f}^* \mathcal{G} [\dim{P}]\\
	&\iso& ({f}\circ {m} \circ \id\times {i}_n)^* \mathcal{G} [\dim{P}]\\
	&=& ({f} \circ {i}_n \circ {m}_n)^* \mathcal{G} [\dim{P}].
\end{eqnarray*}
On the other hand, the restriction of $p^* \mathcal{F}$ to ${P}\times{X}_n$ is 
\begin{eqnarray*}
(p^* \mathcal{F})\vert_{{P}\times {X}_n}
	&=& (\id\times {i}_n)^* p^* {f}^* \mathcal{G} [\dim{P}]\\
	&\iso& ({f}\circ p \circ \id\times {i}_n)^* \mathcal{G} [\dim{P}]\\
	&=& ({f} \circ {i}_n \circ p)^* \mathcal{G} [\dim{P}].
\end{eqnarray*}
Since ${f} \circ {i}_n \circ {m}_n = {f} \circ {i}_n \circ p$, we have $({m}^* {\mathcal{F}})\vert_{{P}\times {X}_n} \iso (p^* \mathcal{F})\vert_{{P}\times {X}_n}$. Since $\cup_n {P}\times{X}_n$ is an open cover for ${P}\times{X}$, this gives the isomorphism we seek.

Next, suppose $\mathcal{F} \in \obj{\mathcal M}{X}$ is equivariant; thus, $\mathcal{F} \in \obj{\mathcal M}_{P}{X}$. Let $\mathcal{F}_n$ denote the restriction of $\mathcal{F}$ to ${X}_n$. 

Recall that ${m}: {P}\times{X} \to {X}$ is given locally by ${m}_n : {P}\times {X}_n \to {X}_n$, as above. Restricting the isomorphism $\mu_{\mathcal{F}} : {m}^* \mathcal{F} \to p^* \mathcal{F}$ to ${P}\times{X}_n$ yields the isomorphism $\mu_{\mathcal{F}_n} : {m}_n^* \mathcal{F}_n \to p^* \mathcal{F}_n$. Thus, $\mathcal{F}_n$ is an equivariant perverse sheaf. Now, let ${e}_n : {Y}_n \to {X}_n$ be the section of ${f}_n : {X}_n \to {Y}_n$ corresponding to $1\in {P}(\Fq)$ (so ${e}_n$ is the unique morphism of varieties such that $({t}_n \circ {e}_n) (y) = (1,y)$). Define
\begin{equation}\label{equation: torsor 5}
	\mathcal{F}'_n \ceq {e}_n^* \mathcal{F}_n [-\dim{P}].
\end{equation}
Then $\mathcal{F}'_n \in \obj D^b_c({Y}_n, \EE)$. By standard glueing arguments, the collection of $\mathcal{F}'_n \in\obj D^b_c({Y}_n, \EE)$, as ${Y}_n$ ranges over the open cover of ${Y}$ fixed above, uniquely determines an object $\mathcal{G}$ of $D^b_c({Y}, \EE)$.

It remains to be shown that $\mathcal{G}$ is a perverse sheaf. Again, we work locally. For each such $n$,
\begin{eqnarray*}
{f}_n^*[\dim{P}] \mathcal{F}'_n 
	&=& {f}_n^*[\dim{P}] {e}_n^* \mathcal{F}_n [-\dim{P}]\\
	&\iso& ({e}_n\circ {f}_n)^* \mathcal{F}_n.
\end{eqnarray*}
Let ${u}_n : {X}_n \to {P}\times{X}_n$ be the section of ${m}_n : {P}\times{X}_n \to {X}_n$ corresponding to $1$ (so ${u}_n$ is the unique morphism of varieties such that $(\id\times{t}_n)\circ {u}_n \circ {t}_n^{-1} (h,y) = (h,1,y)$). The domain of ${u}_n^*\mu_{\mathcal{F}_n}$ is ${u}_n^*{m}_n^* \mathcal{F}_n \iso ({m}_n \circ {u}_n)^* \mathcal{F}_n = \mathcal{F}_n$, since ${u}_n$ is a section of ${m}_n$; the codomain of ${u}_n^* \mu_{\mathcal{F}_n}$ is ${u}_n^* p^* \mathcal{F}_n \iso (p\circ {u}_n)^*\mathcal{F}_n$. Since $p\circ {u}_n = {e}_n \circ {f}_n$, it follows that 
\[
{u}_n^* \mu_{\mathcal{F}_n} : \mathcal{F}_n \to {f}_n^*[\dim{P}] \mathcal{F}'_n
\]
is an isomorphism in $D^b_c({X}_n, \EE)$. By \cite[Prop~4.2.5]{BBD} and the fact that ${\mathcal M}{X}_n$ is stable in $D^b_c({X}_n, \EE)$ under isomorphisms, it follows that $\mathcal{F}'_n \in \obj {\mathcal M}{Y}_n$. By standard glueing arguments, the collection of isomorphisms ${u}_n^* \mu_{\mathcal{F}_n} \in \mor{\mathcal M}{X}_n$, as ${X}_n$ ranges over the open cover of ${X}$ fixed above, uniquely determines an isomorphism in \[
\Hom_{D^b_c({X}, \EE)}(\mathcal{F},{f}^*[\dim{P}] \mathcal{G}).
\]  
From \cite[Prop~4.2.5]{BBD}  it follows that $\mathcal{G}\in \obj{\mathcal M}{Y}$. This completes the proof of Proposition~\ref{proposition: torsor}.
\end{proof}

\begin{proposition}\label{proposition: more torsor}
Let ${f} : {X} \to {Y}$ be a principal fibration with group ${P}$ and suppose ${P}$ is connected. Then ${f}^*[\dim{P}] : {\mathcal M}{Y} \to {\mathcal M}_{P}{X}$ is an equivalence of categories and ${\mathcal M}_{P}{X}$ is a thick subcategory of ${\mathcal M}{X}$.
\end{proposition}

\begin{proof}
By \cite[Prop~4.2.5]{BBD} we know that ${f}^*[\dim{P}] : {\mathcal M}{Y} \to {\mathcal M}{X}$ is full and faithful. Let $\mathcal{G}$ be a perverse sheaf on ${Y}$. From the proof of Proposition~\ref{proposition: torsor} we have seen that $\mathcal{F} \ceq {f}^*[\dim{P}] \mathcal{G}$ is an equivariant perverse sheaf on ${X}$ and that ${f}^*[\dim{P}] \phi$ is an equivariant morphism in ${\mathcal M}{X}$ for each morphism $\phi$ in ${\mathcal M}{Y}$. Thus, ${f}^*[\dim{P}]$ is a functor from ${\mathcal M}{Y}$ to ${\mathcal M}_{P}{X}$. Thus, ${f}^*[\dim{P}] : {\mathcal M}{Y} \to {\mathcal M}_{P}{X}$ is full and faithful. Proposition~\ref{proposition: torsor} tells us that this functor is essentially surjective. Thus, ${f}^*[\dim{P}]$ is an equivalence. The last clause of Proposition~\ref{proposition: more torsor} follows from \cite[4.2.6]{BBD}.
\end{proof}

\begin{definition}\label{definition: descent}
Let ${f} : {X} \to {Y}$ be a principal fibration with group ${P}$ and suppose ${P}$ is connected. Let ${f}_\# : {\mathcal M}_{P}{X} \to {\mathcal M}{Y}$ denote the adjoint of the equivalence ${f}^*[\dim{P}] : {\mathcal M}{Y} \to {\mathcal M}_{P}{X}$ (see Proposition~\ref{proposition: more torsor}). In particular, ${f}_\# : {\mathcal M}_{P}{X} \to {\mathcal M}{Y}$ is an equivalence of categories.
\end{definition}

\begin{corollary}
Suppose $H$ is a connected group acting smoothly on $X$.
If $A\in {\mathcal M} X$ is $H$-equivariant and $B\in {\mathcal M} X$ is a subquotient of $A$, then $B$ is also $H$-equivariant.
\end{corollary}

\begin{proof}
(Following \cite[(1.9.1)]{CS}.)
Let the action of $H$ on $Y$ is given by $m : H\times X \to X$. This is a smooth morphism with connected fibres, by hypothesis. Thus, $m^*[\dim H]$ is an equivalence of categories, by Proposition~\ref{proposition: more torsor}.  Since equivalences take epimorphisms to epimorphisms and monomorphisms to monomorphisms, it follows that $m^*[\dim H]B$ is a subquotient of $m^*[\dim H]A$. Since $A$ is an $H$-equivarient perverse sheaf on $X$, we have $m^*[\dim H]A \iso p_2^*[\dim H]A$. On the other hand, $p_2 : H\times X \to X$ is also a smooth morphism with connected fibres of dimension $H$, so by Proposition~\ref{proposition: more torsor}, $p_2^*[\dim H]$ identifies ${\mathcal M}_H X$ with a thick subcategory of ${\mathcal M} (H\times X)$. Since $m^*[\dim H]B$ is a subquotient of $p_2^*[\dim H]A$, it follows that there is some $C\in {\mathcal M} X$ such that $p_2^*C \iso m^*[\dim H]B$ restricting this isomorphism from $H\times X$ to $\{ e\} \times X$ (on which $m$ and $p_2$ agree), yields $C\iso B$. Thus, $p_2^*B \iso m^*[\dim H]B$, from which is follows that $B$ is $H$-equivariant.
\end{proof}



\bibliography{bibliography/Biblio}

\end{document}